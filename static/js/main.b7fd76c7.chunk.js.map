{"version":3,"sources":["assets/harvest-project-id.png","assets/harvest-client-id.png","assets/spreadsheet-id.png","assets/harvest-access.png","assets/harvest-token-id.png","serviceWorker.js","storage.js","harvestKeys.js","harvestSync.js","googleSync.js","primitives/Wrapper.js","primitives/Button.js","primitives/Input.js","LoginForm.js","primitives/IconButton.js","primitives/Checkbox.js","ImportExport.js","primitives/Code.js","primitives/SheetCard.js","ListSheets.js","ListOutput.js","Output.js","Sheet.js","Home.js","App.js","index.js"],"names":["module","exports","Boolean","window","location","hostname","match","getFromStorage","key","defaultVal","locallyStored","localStorage","getItem","JSON","parse","_","writeToStorage","data","Error","setItem","stringify","getLogin","writeLogin","getSheets","writeSheets","getOutput","writeOutput","harvestKeys","date","name","value","item","spent_date","format","parseISO","hours","rounded_hours","notes","locked","is_locked","locked_reason","closed","is_closed","billed","is_billed","timer_started_at","started_time","ended_time","running","is_running","billable","budgeted","billable_rate","billable_amount","cost_rate","cost_amount","created_at","updated_at","user","client","currency","project","project_code","code","task","harvestLogin","LOGIN","a","fetch","method","headers","Authorization","HARVEST_ACCESS_TOKEN","HARVEST_ACCOUNT_ID","response","json","getProjectName","getClientName","getTimeEntries","fromDate","toDate","apiCall","harvestID","page","time_entries","total_pages","timeEntries","totalPages","parseInt","getSummary","users","dates","forEach","days","bucket","entries","includes","push","headerLine","daysLine","bucketLine","roundedBucketLine","allDaysLine","entriesLines","longestEntries","Object","keys","i","allUsers","length","time","Math","round","col","INDEXES","index","floor","getCol","line","harvestSync","output","errors","isDate","toString","console","error","endOfDay","lastDayOfMonth","csv","map","allData","Promise","all","Array","fill","sort","b","replace","csvLines","entry","join","createTab","spreadsheetID","tabName","gapi","sheets","spreadsheets","batchUpdate","spreadsheetId","resource","requests","addSheet","properties","title","tabColor","red","green","blue","clearSheet","values","clear","range","enterData","append","valueInputOption","insertDataOption","googleLogin","retry","resolve","reject","load","thing","init","apiKey","GOOGLE_API_KEY","clientId","discoveryDocs","scope","auth2","getAuthInstance","isSignedIn","get","signIn","getSheetInfo","googleSync","Wrapper","children","size","css","maxWidth","sm","md","lg","background","margin","padding","boxShadow","Button","loading","look","as","Tag","props","styleMap","default","muted","disabled","filter","rotation","keyframes","to","transform","position","display","border","apperance","fontSize","cursor","lineHeight","borderRadius","textDecoration","content","top","right","bottom","left","transition","zIndex","marginLeft","marginTop","width","height","borderTopColor","animation","opacity","outline","Input","id","label","required","help","visible","marginBottom","gridTemplateColumns","htmlFor","alignSelf","whiteSpace","type","color","borderColor","aria-label","textAlign","LoginForm","handleLogin","inputLines","fontFamily","fontStyle","fontWeight","textShadow","onSubmit","listStyle","setValue","onChange","event","target","justifyItems","IconButton","confirm","onClick","icon","useState","clicked","setClicked","confirmScreen","setConfirmScreen","reset","setReset","pulse1","pulse2","import","borderStyle","export","adjust","boxSizing","logout","sync","add","delete","edit","overflow","clearTimeout","preventDefault","setTimeout","src","alt","Checkbox","checked","root","before","borderBottom","borderLeft","after","ImportExport","includeOutput","setIncludeOutput","overrideSheets","setOverrideSheets","overrideOutput","setOverrideOutput","file","setFile","setError","history","useHistory","alignItems","href","encodeURIComponent","version","download","borderTop","paddingTop","reader","FileReader","onload","result","rest","readAsText","files","Link","Code","kind","kindMap","marginRight","paddingRight","borderRight","SheetCard","hProjectName","hClientName","hourSummaryTabName","gSheetIDName","selected","toggle","deleteSheet","gap","columns","gridColumn","ListSheets","storageSheets","sheet","setSheets","subDays","Date","setDate","setLoading","setSelected","setSort","setFilter","sorting","getOutputByID","ID","sheetID","newSheet","toggleID","newSelected","selectedSheets","hProject","hClient","gSheetID","hourSummary","hID","timeData","justifySelf","pattern","placeholder","toLowerCase","ListOutput","setOutput","outputID","newOutput","deleteOutput","SortableMultiValue","SortableElement","innerProps","onMouseDown","stopPropagation","MultiValue","SortableSelect","SortableContainer","Select","Output","itemID","params","storageOutput","nameDefault","columnsDefault","thisOutput","setName","setColumns","selectableItems","colourStyles","container","styles","control","inputId","axis","onSortEnd","array","from","oldIndex","newIndex","newValue","slice","splice","distance","getHelperDimensions","node","getBoundingClientRect","isMulti","options","selectedOptions","components","closeMenuOnSelect","Sheet","outputOptions","hProjectDefault","hProjectNameDefault","hClientDefault","hClientNameDefault","gSheetIDDefault","gSheetIDNameDefault","outputDefault","hourSummaryDefault","tabDefault","thisSheet","loadingHP","setLoadingHP","loadingHC","setLoadingHC","loadingG","setLoadingG","setHProject","setHProjectName","setHClient","setHClientName","setGSheetID","setGSheetIDName","setHourSummary","tab","setTab","getHProjectName","getHClientName","getSheetName","possibleTabs","paddingLeft","indexOf","thisTab","hProjectIDImg","onBlur","readOnly","hClientIDImg","gSheetIDImg","Home","handleLogout","colors","setColors","setIndex","avatar_url","html","exact","path","component","colorSets","App","login","setLogin","hToken","setHToken","setHID","gAPIKey","setGAPIKey","hasLogin","HTokenHelp","harvestAccess","harvestAccessTokenID","textRendering","fontKerning","MozOsxFontSmoothing","ReactDOM","render","StrictMode","body","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","message"],"mappings":"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","file":"static/js/main.b7fd76c7.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/harvest-project-id.966e79e5.png\";","module.exports = __webpack_public_path__ + \"static/media/harvest-client-id.a2219d3e.png\";","module.exports = __webpack_public_path__ + \"static/media/spreadsheet-id.0f499f40.png\";","module.exports = __webpack_public_path__ + \"static/media/harvest-access.07c26b4d.png\";","module.exports = __webpack_public_path__ + \"static/media/harvest-token-id.946649fd.png\";","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === 'localhost' ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === '[::1]' ||\n\t\t// 127.0.0.0/8 are considered localhost for IPv4.\n\t\twindow.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('load', () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\n\t\t\t\t\t\t\t'worker. To learn more, visit https://bit.ly/CRA-PWA'\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl, config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then((registration) => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === 'installed') {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\n\t\t\t\t\t\t\t\t\t'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.error('Error during service worker registration:', error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl, {\n\t\theaders: { 'Service-Worker': 'script' },\n\t})\n\t\t.then((response) => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get('content-type');\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\t(contentType != null && contentType.indexOf('javascript') === -1)\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then((registration) => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log('No internet connection found. App is running in offline mode.');\n\t\t});\n}\n\nexport function unregister() {\n\tif ('serviceWorker' in navigator) {\n\t\tnavigator.serviceWorker.ready\n\t\t\t.then((registration) => {\n\t\t\t\tregistration.unregister();\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error.message);\n\t\t\t});\n\t}\n}\n","const OUTPUT_KEY = 'harvest2sheetOutputs';\nconst SHEETS_KEY = 'harvest2sheetSheets';\nconst LOGIN_KEY = 'harvest2sheetLogin';\n\n/**\n * Retrieve data from localStorage\n *\n * @param  {string} key        - The key of the data entry\n * @param  {string} defaultVal - The default value fallback\n *\n * @return {any}               - The data\n */\nfunction getFromStorage(key, defaultVal) {\n\tconst locallyStored = localStorage.getItem(key) || defaultVal;\n\ttry {\n\t\treturn JSON.parse(locallyStored);\n\t} catch (_) {\n\t\treturn {};\n\t}\n}\n\n/**\n * Write to localStorage\n *\n * @param  {string} key  - The key of the data entry\n * @param  {any}    data - The data to be stored\n */\nfunction writeToStorage(key, data) {\n\tif (typeof data !== 'object') {\n\t\tthrow new Error(`Data to be written to storage is not an object but \"${typeof data}\"`);\n\t}\n\tlocalStorage.setItem(key, JSON.stringify(data));\n}\n\nexport function getLogin() {\n\treturn getFromStorage(LOGIN_KEY, '{}');\n}\n\nexport function writeLogin(data) {\n\twriteToStorage(LOGIN_KEY, data);\n}\n\nexport function getSheets() {\n\treturn getFromStorage(SHEETS_KEY, '[]');\n}\n\nexport function writeSheets(data) {\n\twriteToStorage(SHEETS_KEY, data);\n}\n\nexport function getOutput() {\n\treturn getFromStorage(OUTPUT_KEY, '[]');\n}\n\nexport function writeOutput(data) {\n\twriteToStorage(OUTPUT_KEY, data);\n}\n","import parseISO from 'date-fns/parseISO';\nimport format from 'date-fns/format';\n\n/**\n * All the keys the Harvest API returns\n *\n * @type {Object}\n */\nexport const harvestKeys = {\n\tdate: {\n\t\tname: 'Date',\n\t\tvalue: (item) => (item.spent_date ? format(parseISO(item.spent_date), 'dd MMM yy') : ''),\n\t},\n\thours: {\n\t\tname: 'Hours',\n\t\tvalue: (item) => item.hours,\n\t},\n\trounded_hours: {\n\t\tname: 'Rounded Hours',\n\t\tvalue: (item) => item.rounded_hours,\n\t},\n\tnotes: {\n\t\tname: 'Notes',\n\t\tvalue: (item) => item.notes,\n\t},\n\tlocked: {\n\t\tname: 'Locked',\n\t\tvalue: (item) => (item.is_locked ? 'Yes' : 'No'),\n\t},\n\tlocked_reason: {\n\t\tname: 'Locked Reason',\n\t\tvalue: (item) => item.locked_reason,\n\t},\n\tclosed: {\n\t\tname: 'Closed',\n\t\tvalue: (item) => (item.is_closed ? 'Yes' : 'No'),\n\t},\n\tbilled: {\n\t\tname: 'Billed',\n\t\tvalue: (item) => (item.is_billed ? 'Yes' : 'No'),\n\t},\n\ttimer_started_at: {\n\t\tname: 'Timer Started At',\n\t\tvalue: (item) => item.timer_started_at,\n\t},\n\tstarted_time: {\n\t\tname: 'Started Timer',\n\t\tvalue: (item) => item.started_time,\n\t},\n\tended_time: {\n\t\tname: 'Ended Timer',\n\t\tvalue: (item) => item.ended_time,\n\t},\n\trunning: {\n\t\tname: 'Running',\n\t\tvalue: (item) => (item.is_running ? 'Yes' : 'No'),\n\t},\n\tbillable: {\n\t\tname: 'Billable',\n\t\tvalue: (item) => item.billable,\n\t},\n\tbudgeted: {\n\t\tname: 'Budgeted',\n\t\tvalue: (item) => item.budgeted,\n\t},\n\tbillable_rate: {\n\t\tname: 'Billable Rate',\n\t\tvalue: (item) => item.billable_rate,\n\t},\n\tbillable_amount: {\n\t\tname: 'Billable Amount',\n\t\tvalue: (item) => item.rounded_hours * item.billable_rate,\n\t},\n\tcost_rate: {\n\t\tname: 'Cost Rate',\n\t\tvalue: (item) => item.cost_rate,\n\t},\n\tcost_amount: {\n\t\tname: 'Cost Amount',\n\t\tvalue: (item) => item.rounded_hours * item.cost_rate,\n\t},\n\tcreated_at: {\n\t\tname: 'Created At',\n\t\tvalue: (item) =>\n\t\t\titem.created_at ? format(parseISO(item.created_at), 'dd MMM yy h:m:s a') : '',\n\t},\n\tupdated_at: {\n\t\tname: 'Updated At',\n\t\tvalue: (item) =>\n\t\t\titem.updated_at ? format(parseISO(item.updated_at), 'dd MMM yy h:m:s a') : '',\n\t},\n\tuser: {\n\t\tname: 'User',\n\t\tvalue: (item) => item.user.name,\n\t},\n\tclient: {\n\t\tname: 'Client',\n\t\tvalue: (item) => item.client.name,\n\t},\n\tcurrency: {\n\t\tname: 'Currency',\n\t\tvalue: (item) => item.client.currency,\n\t},\n\tproject: {\n\t\tname: 'Project',\n\t\tvalue: (item) => item.project.name,\n\t},\n\tproject_code: {\n\t\tname: 'Project Code',\n\t\tvalue: (item) => item.project.code,\n\t},\n\ttask: {\n\t\tname: 'Task',\n\t\tvalue: (item) => item.task.name,\n\t},\n};\n","import lastDayOfMonth from 'date-fns/lastDayOfMonth';\nimport parseISO from 'date-fns/parseISO';\nimport endOfDay from 'date-fns/endOfDay';\nimport isDate from 'date-fns/isDate';\nimport format from 'date-fns/format';\n\nimport { harvestKeys } from './harvestKeys';\n\n/**\n * Check the login credentials with the Harvest API\n *\n * @param  {object} LOGIN - The login object\n *\n * @return {object}       - The API object which contains data about my profile\n */\nexport async function harvestLogin(LOGIN) {\n\ttry {\n\t\tconst response = await fetch(`https://api.harvestapp.com/v2/users/me`, {\n\t\t\tmethod: 'GET',\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${LOGIN.HARVEST_ACCESS_TOKEN}`,\n\t\t\t\t'Harvest-Account-Id': LOGIN.HARVEST_ACCOUNT_ID,\n\t\t\t\t'User-Agent': 'Harvest2Sheet',\n\t\t\t},\n\t\t});\n\t\tconst data = await response.json();\n\t\treturn data;\n\t} catch (error) {\n\t\tthrow new Error('Harvest login failed. Please check your credentials.');\n\t}\n}\n\n/**\n * Get the name of a project in Harvest\n *\n * @param  {object} LOGIN   - The login object\n * @param  {number} project - The Harvest client ID\n *\n * @return {object}         - The return object of the Harvest API\n */\nexport async function getProjectName(LOGIN, project) {\n\ttry {\n\t\tconst response = await fetch(`https://api.harvestapp.com/v2/projects/${project}`, {\n\t\t\tmethod: 'GET',\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${LOGIN.HARVEST_ACCESS_TOKEN}`,\n\t\t\t\t'Harvest-Account-Id': LOGIN.HARVEST_ACCOUNT_ID,\n\t\t\t\t'User-Agent': 'Harvest2Sheet',\n\t\t\t},\n\t\t});\n\t\tconst data = await response.json();\n\t\treturn data;\n\t} catch (error) {\n\t\tthrow new Error('Harvest sync failed. Please check your credentials.');\n\t}\n}\n\n/**\n * Get the name of a client in Harvest\n *\n * @param  {object} LOGIN  - The login object\n * @param  {number} client - The Harvest client ID\n *\n * @return {object}        - The return object of the Harvest API\n */\nexport async function getClientName(LOGIN, client) {\n\ttry {\n\t\tconst response = await fetch(`https://api.harvestapp.com/v2/clients/${client}`, {\n\t\t\tmethod: 'GET',\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${LOGIN.HARVEST_ACCESS_TOKEN}`,\n\t\t\t\t'Harvest-Account-Id': LOGIN.HARVEST_ACCOUNT_ID,\n\t\t\t\t'User-Agent': 'Harvest2Sheet',\n\t\t\t},\n\t\t});\n\t\tconst data = await response.json();\n\t\treturn data;\n\t} catch (error) {\n\t\tthrow new Error('Harvest sync failed. Please check your credentials.');\n\t}\n}\n\n/**\n * Retrieve time entries from Harvest API\n *\n * @param  {object} LOGIN     - The login object\n * @param  {string} fromDate  - The date from which the entries should start\n * @param  {string} toDate    - The date to which the entries should end\n * @param  {string} apiCall   - The API call\n * @param  {number} harvestID - The Harvest ID for that API call\n * @param  {number} page      - The current page\n *\n * @return {object}           - The entries\n */\nasync function getTimeEntries(LOGIN, fromDate, toDate, apiCall, harvestID, page = 1) {\n\ttry {\n\t\tconst response = await fetch(\n\t\t\t`https://api.harvestapp.com/v2/time_entries?from=${fromDate}&to=${toDate}&${apiCall}=${harvestID}&page=${page}`,\n\t\t\t{\n\t\t\t\tmethod: 'GET',\n\t\t\t\theaders: {\n\t\t\t\t\tAuthorization: `Bearer ${LOGIN.HARVEST_ACCESS_TOKEN}`,\n\t\t\t\t\t'Harvest-Account-Id': LOGIN.HARVEST_ACCOUNT_ID,\n\t\t\t\t\t'User-Agent': 'Harvest2Sheet',\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t\tconst { time_entries, total_pages } = await response.json();\n\n\t\treturn {\n\t\t\ttimeEntries: time_entries,\n\t\t\ttotalPages: parseInt(total_pages),\n\t\t};\n\t} catch (error) {\n\t\treturn error;\n\t}\n}\n\n/**\n * Get the column alphabetical identifier from a number\n *\n * @param  {integer} col - Number of column\n *\n * @return {string}      - The column ID\n */\nfunction getCol(col) {\n\tconst INDEXES = [\n\t\t'A',\n\t\t'B',\n\t\t'C',\n\t\t'D',\n\t\t'E',\n\t\t'F',\n\t\t'G',\n\t\t'H',\n\t\t'I',\n\t\t'J',\n\t\t'K',\n\t\t'L',\n\t\t'M',\n\t\t'N',\n\t\t'O',\n\t\t'P',\n\t\t'Q',\n\t\t'R',\n\t\t'S',\n\t\t'T',\n\t\t'U',\n\t\t'V',\n\t\t'W',\n\t\t'X',\n\t\t'Y',\n\t\t'Z',\n\t];\n\tconst index = Math.floor(col / INDEXES.length);\n\n\t// making sure we can handle more than 26 cells by adding a postfix to each cell\n\t// (now supports 701 which is not infinite but at least aligns with what spreadsheet apps do)\n\treturn `${index > 0 ? INDEXES[index - 1] : ''}${INDEXES[col - INDEXES.length * index]}`;\n}\n\n/**\n * Get summary data from time entries\n *\n * @param  {array} data - The harvest data unprocessed\n *\n * @return {array}      - The array of arrays for entry into google sheets\n */\nexport function getSummary(data) {\n\tconst users = {};\n\tconst dates = [];\n\n\tdata.forEach((item) => {\n\t\tconst user = harvestKeys.user.value(item);\n\t\tconst date = harvestKeys.date.value(item);\n\n\t\tif (!users[user]) {\n\t\t\tusers[user] = {\n\t\t\t\tdays: 0,\n\t\t\t\tbucket: 0,\n\t\t\t\tentries: {},\n\t\t\t};\n\t\t}\n\n\t\tconst hours = harvestKeys.rounded_hours.value(item);\n\t\tif (!users[user].entries[date]) {\n\t\t\tusers[user].entries[date] = hours;\n\t\t} else {\n\t\t\tusers[user].entries[date] += hours;\n\t\t}\n\n\t\tif (!dates.includes(date)) {\n\t\t\tdates.push(date);\n\t\t}\n\t});\n\n\tconst headerLine = [''];\n\tconst daysLine = ['Total full days'];\n\tconst bucketLine = ['Total remaining bucket hours'];\n\tconst roundedBucketLine = ['Rounded bucket days'];\n\tconst allDaysLine = ['All days'];\n\tconst entriesLines = [];\n\tlet longestEntries = 0;\n\n\tObject.keys(users).forEach((user, i) => {\n\t\theaderLine.push(user);\n\n\t\tconst allUsers = Object.entries(users[user].entries);\n\t\tif (allUsers.length > longestEntries) {\n\t\t\tlongestEntries = allUsers.length;\n\t\t}\n\n\t\tallUsers.forEach(([_, time]) => {\n\t\t\tif (Math.round(time) >= 6) {\n\t\t\t\tusers[user].days++;\n\t\t\t} else {\n\t\t\t\tusers[user].bucket += time;\n\t\t\t}\n\t\t});\n\n\t\tdaysLine.push(users[user].days);\n\t\tbucketLine.push(users[user].bucket);\n\t\tconst col = getCol(i + 1);\n\t\troundedBucketLine.push(`=ROUNDUP(${col}3/8)`);\n\t\tallDaysLine.push(`=SUM(${col}2,${col}4)`);\n\t});\n\n\tdates.forEach((date) => {\n\t\tconst line = [date];\n\t\tObject.keys(users).forEach((user) => {\n\t\t\tconst value = users[user].entries[date];\n\t\t\tline.push(value ? value : '');\n\t\t});\n\n\t\tentriesLines.push(line);\n\t});\n\n\treturn [\n\t\theaderLine,\n\t\tdaysLine,\n\t\tbucketLine,\n\t\troundedBucketLine,\n\t\tallDaysLine,\n\t\t[],\n\t\t['Timesheet by dates'],\n\t\t...entriesLines,\n\t];\n}\n\n/**\n * Get time entries out of harvest between two points in time\n *\n * @param  {object} LOGIN     - The login object\n * @param  {number} harvestID - The harvest ID for either the project or the client\n * @param  {string} date      - The date in YYYY-MM format\n * @param  {number} output    - The ID of the output to be used\n * @param  {string} apiCall   - The API call to be used with the harvestID\n *\n * @return {object}           - An object with csv and errors key\n */\nexport async function harvestSync(LOGIN, harvestID, date, output, apiCall = 'project_id') {\n\tconst errors = [];\n\tconst fromDate = parseISO(`${date}-01T00:00:00.000Z`);\n\tif (!isDate(fromDate) || fromDate.toString() === 'Invalid Date') {\n\t\tconsole.error('The date passed in is not valid');\n\t\treturn;\n\t}\n\tconst toDate = endOfDay(lastDayOfMonth(fromDate));\n\n\tlet csv = [output.map((item) => (harvestKeys[item] ? harvestKeys[item].name : 'unknown'))];\n\tlet allData;\n\n\ttry {\n\t\tconst { timeEntries, totalPages } = await getTimeEntries(\n\t\t\tLOGIN,\n\t\t\tformat(fromDate, 'yyyyMMdd'),\n\t\t\tformat(toDate, 'yyyyMMdd'),\n\t\t\tapiCall,\n\t\t\tharvestID\n\t\t);\n\n\t\tallData = [...timeEntries];\n\n\t\tif (totalPages > 1) {\n\t\t\tawait Promise.all(\n\t\t\t\tArray(totalPages - 1)\n\t\t\t\t\t.fill()\n\t\t\t\t\t.map(async (_, page) => {\n\t\t\t\t\t\tconst { timeEntries } = await getTimeEntries(\n\t\t\t\t\t\t\tLOGIN,\n\t\t\t\t\t\t\tformat(fromDate, 'yyyyMMdd'),\n\t\t\t\t\t\t\tformat(toDate, 'yyyyMMdd'),\n\t\t\t\t\t\t\tapiCall,\n\t\t\t\t\t\t\tharvestID,\n\t\t\t\t\t\t\tpage + 2\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tallData = [...allData, ...timeEntries];\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tallData = allData.sort(\n\t\t\t(a, b) => parseInt(a.spent_date.replace(/-/g, '')) - parseInt(b.spent_date.replace(/-/g, ''))\n\t\t);\n\n\t\tconst csvLines = allData.map((entry) =>\n\t\t\toutput.map((item) => (harvestKeys[item] ? harvestKeys[item].value(entry) : ''))\n\t\t);\n\n\t\tcsv = [...csv, ...csvLines];\n\t} catch (error) {\n\t\terrors.push(error);\n\t}\n\n\treturn {\n\t\tcsv,\n\t\tallData,\n\t\terrors: errors.length ? errors.join('\\n') : null,\n\t};\n}\n","/**\n * Create tab\n *\n * @param  {string} spreadsheetID - The spreadsheet ID to be updated\n * @param  {string} tabName       - The name of the tab inside the spreadsheet\n */\nasync function createTab(spreadsheetID, tabName) {\n\ttry {\n\t\tawait window.gapi.client.sheets.spreadsheets.batchUpdate({\n\t\t\tspreadsheetId: spreadsheetID,\n\t\t\tresource: {\n\t\t\t\trequests: [\n\t\t\t\t\t{\n\t\t\t\t\t\taddSheet: {\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\ttitle: tabName,\n\t\t\t\t\t\t\t\ttabColor: {\n\t\t\t\t\t\t\t\t\tred: 155,\n\t\t\t\t\t\t\t\t\tgreen: 155,\n\t\t\t\t\t\t\t\t\tblue: 155,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\t} catch (error) {}\n}\n\n/**\n * Merge cells\n *\n * @param  {string} spreadsheetID - The spreadsheet ID to be updated\n * @param  {array}  sheetID       - The ID of the tab inside the spreadsheet\n */\n// async function mergeCells(spreadsheetID, sheetID) {\n// \ttry {\n// \t\tawait window.gapi.client.sheets.spreadsheets.batchUpdate({\n// \t\t\tspreadsheetId: spreadsheetID,\n// \t\t\tresource: {\n// \t\t\t\trequests: [\n// \t\t\t\t\t{\n// \t\t\t\t\t\tmergeCells: {\n// \t\t\t\t\t\t\tmergeType: 'MERGE_COLUMNS',\n// \t\t\t\t\t\t\trange: {\n// \t\t\t\t\t\t\t\tsheetId: sheetID,\n// \t\t\t\t\t\t\t\tstartRowIndex: 0,\n// \t\t\t\t\t\t\t\tendRowIndex: 0,\n// \t\t\t\t\t\t\t\tstartColumnIndex: 1,\n// \t\t\t\t\t\t\t\tendColumnIndex: 2,\n// \t\t\t\t\t\t\t}\n// \t\t\t\t\t\t},\n// \t\t\t\t\t},\n// \t\t\t\t],\n// \t\t\t},\n// \t\t});\n// \t} catch (error) {}\n// }\n\n/**\n * Clear a spreadsheet tab\n *\n * @param  {string} spreadsheetID - The spreadsheet ID to be updated\n * @param  {string} tabName       - The name of the tab inside the spreadsheet\n */\nasync function clearSheet(spreadsheetID, tabName) {\n\tawait window.gapi.client.sheets.spreadsheets.values.clear({\n\t\tspreadsheetId: spreadsheetID,\n\t\trange: `${tabName}!A1:ZZZ9999`,\n\t});\n}\n\n/**\n * Enter data into a sheet tab\n *\n * @param  {string} spreadsheetID - The spreadsheet ID to be updated\n * @param  {string} tabName       - The name of the tab inside the spreadsheet\n * @param  {array}  data          - The data to be entered in a nested array\n */\nasync function enterData(spreadsheetID, tabName, data) {\n\treturn await window.gapi.client.sheets.spreadsheets.values.append({\n\t\tspreadsheetId: spreadsheetID,\n\t\trange: tabName,\n\t\tvalueInputOption: 'USER_ENTERED',\n\t\tinsertDataOption: 'OVERWRITE',\n\t\tresource: {\n\t\t\tvalues: data,\n\t\t},\n\t});\n}\n\n/**\n * Login with Google API\n *\n * @param  {object} LOGIN - The login object\n * @param  {number} retry - To prevent recursion issues we keep track of the instance chain\n */\nexport function googleLogin(LOGIN, retry = 1) {\n\tif (window.gapi.client) {\n\t\t// we have to re init google only once per session\n\t\treturn Promise.resolve();\n\t} else {\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\tif (retry > 2) {\n\t\t\t\treject('Google login failed. Check you credentials.');\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tawait window.gapi.load('client:auth2', async (thing) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait window.gapi.client.init({\n\t\t\t\t\t\t\tapiKey: LOGIN.GOOGLE_API_KEY,\n\t\t\t\t\t\t\tclientId: '75225162198-vsj9mtn0o9tf0ru487t4he9a90mrd2mp.apps.googleusercontent.com',\n\t\t\t\t\t\t\tdiscoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],\n\t\t\t\t\t\t\tscope: 'https://www.googleapis.com/auth/spreadsheets',\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\treject('Google login failed. Check you credentials.');\n\t\t\t\t\t}\n\t\t\t\t\tconst signedIn = window.gapi.auth2.getAuthInstance().isSignedIn.get();\n\t\t\t\t\tif (signedIn) {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait window.gapi.auth2.getAuthInstance().signIn();\n\t\t\t\t\t\t\tawait googleLogin(LOGIN, retry + 1);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n}\n\n/**\n * Get infos about this spreadsheet\n *\n * @param  {object} LOGIN         - The login object\n * @param  {[type]} spreadsheetID - The spreadsheet ID\n *\n * @return {object}               - The data returned from the Google API\n */\nexport async function getSheetInfo(LOGIN, spreadsheetID) {\n\tawait googleLogin(LOGIN);\n\n\treturn await window.gapi.client.sheets.spreadsheets.get({\n\t\tspreadsheetId: spreadsheetID,\n\t});\n}\n\n/**\n * Updating a google sheet with data\n *\n * @param  {object} LOGIN         - The login object\n * @param  {string} spreadsheetID - The spreadsheet ID to be updated\n * @param  {string} date          - A date within the range to extract year and month from\n * @param  {array}  data          - The data to be entered in a nested array\n * @param  {string} tabName       - The name of the tab inside the spreadsheet\n */\nexport async function googleSync(LOGIN, spreadsheetID, date, data, tabName) {\n\tawait googleLogin(LOGIN);\n\tawait createTab(spreadsheetID, tabName);\n\tawait clearSheet(spreadsheetID, tabName);\n\tawait enterData(spreadsheetID, tabName, data);\n}\n","/** @jsx jsx */\n\nimport { jsx } from '@emotion/core';\n\nexport function Wrapper({ children, size = 'md' }) {\n\tconst sizeMap = {\n\t\tsm: '50rem',\n\t\tmd: '60rem',\n\t\tlg: '93.75rem',\n\t};\n\n\treturn (\n\t\t<div\n\t\t\tcss={{\n\t\t\t\tmaxWidth: sizeMap[size],\n\t\t\t\tbackground: '#fff',\n\t\t\t\tmargin: '1rem auto',\n\t\t\t\tpadding: '1rem',\n\t\t\t\tboxShadow: '0 0 1rem 0.25rem rgba(0, 0, 0, 0.4)',\n\t\t\t\t'@media (min-width: 37.5rem)': {\n\t\t\t\t\tpadding: '2rem',\n\t\t\t\t},\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</div>\n\t);\n}\n","/** @jsx jsx */\n\nimport { jsx, keyframes } from '@emotion/core';\n\nexport function Button({ children, loading, look = 'default', as: Tag = 'button', ...props }) {\n\tconst styleMap = {\n\t\tdefault: {\n\t\t\t'--gradient': 'linear-gradient(to right, var(--bg-color1) 0%, var(--bg-color2) 100%)',\n\t\t},\n\t\tmuted: {\n\t\t\t'--gradient': 'linear-gradient(to right, #ccc 0%, #555 50%, #ccc 100%)',\n\t\t\t':hover:before, :focus:before': props.disabled\n\t\t\t\t? {}\n\t\t\t\t: {\n\t\t\t\t\t\tfilter: 'invert(1)',\n\t\t\t\t  },\n\t\t},\n\t};\n\n\tconst rotation = keyframes({\n\t\tto: {\n\t\t\ttransform: 'rotate( 360deg )',\n\t\t},\n\t});\n\n\treturn (\n\t\t<Tag\n\t\t\tdisabled={loading}\n\t\t\tcss={{\n\t\t\t\tposition: 'relative',\n\t\t\t\tdisplay: 'inline-block',\n\t\t\t\tborder: 'none',\n\t\t\t\tbackground: '#fff',\n\t\t\t\tapperance: 'none',\n\t\t\t\tfontSize: '1rem',\n\t\t\t\tcursor: 'pointer',\n\t\t\t\tlineHeight: 1,\n\t\t\t\tpadding: '3px',\n\t\t\t\tborderRadius: '6px',\n\t\t\t\tmargin: '1rem 0 0 0',\n\t\t\t\ttextDecoration: 'none',\n\t\t\t\t':before': {\n\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tright: 0,\n\t\t\t\t\tbottom: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tbackground: 'var(--gradient)',\n\t\t\t\t\tborderRadius: '8px',\n\t\t\t\t\ttransition: 'filter 0.3s ease',\n\t\t\t\t\tzIndex: 1,\n\t\t\t\t},\n\t\t\t\t':after': {\n\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\tdisplay: loading ? 'block' : 'none',\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\ttop: '50%',\n\t\t\t\t\tleft: '50%',\n\t\t\t\t\tmarginLeft: '-0.75rem',\n\t\t\t\t\tmarginTop: '-0.75rem',\n\t\t\t\t\twidth: '1.5rem',\n\t\t\t\t\theight: '1.5rem',\n\t\t\t\t\tborder: '3px solid #ccc',\n\t\t\t\t\tborderTopColor: 'var(--text)',\n\t\t\t\t\tborderRadius: '100%',\n\t\t\t\t\tanimation: `${rotation} 0.6s linear infinite`,\n\t\t\t\t\tzIndex: 2,\n\t\t\t\t},\n\t\t\t\t':disabled': {\n\t\t\t\t\topacity: 0.4,\n\t\t\t\t},\n\t\t\t\t':hover:before': props.disabled\n\t\t\t\t\t? {}\n\t\t\t\t\t: {\n\t\t\t\t\t\t\tfilter: 'hue-rotate(180deg)',\n\t\t\t\t\t  },\n\t\t\t\t':focus': {\n\t\t\t\t\toutline: 'none',\n\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t},\n\t\t\t\t...(styleMap[look] ? styleMap[look] : {}),\n\t\t\t}}\n\t\t\t{...props}\n\t\t>\n\t\t\t<span\n\t\t\t\tcss={{\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\tpadding: '0.5rem 2.5rem',\n\t\t\t\t\tborderRadius: '6px',\n\t\t\t\t\tzIndex: 2,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</span>\n\t\t</Tag>\n\t);\n}\n","/** @jsx jsx */\n\nimport { jsx, keyframes } from '@emotion/core';\n\nexport function Input({\n\tid,\n\tlabel,\n\trequired,\n\tmaxWidth = '17rem',\n\tloading = false,\n\thelp = '',\n\tvisible = true,\n\t...props\n}) {\n\tconst rotation = keyframes({\n\t\tto: {\n\t\t\ttransform: 'rotate( 360deg )',\n\t\t},\n\t});\n\n\treturn (\n\t\t<li\n\t\t\tcss={{\n\t\t\t\tdisplay: visible ? 'block' : 'none',\n\t\t\t\tmarginBottom: '0.5rem',\n\t\t\t\t'@media (min-width: 37.5rem)': {\n\t\t\t\t\tdisplay: visible ? 'grid' : 'none',\n\t\t\t\t\tgridTemplateColumns: `${maxWidth} auto`,\n\t\t\t\t},\n\t\t\t}}\n\t\t>\n\t\t\t<label\n\t\t\t\thtmlFor={id}\n\t\t\t\tcss={{\n\t\t\t\t\tdisplay: 'inline-block',\n\t\t\t\t\tmargin: '1rem 0.5rem 0.5rem 0',\n\t\t\t\t\tfontSize: '1.5rem',\n\t\t\t\t\talignSelf: 'center',\n\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\t'@media (min-width: 37.5rem)': {\n\t\t\t\t\t\tmargin: '0 0.5rem 0 0',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{label}\n\t\t\t</label>\n\t\t\t<div\n\t\t\t\tcss={{\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\t':after': {\n\t\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\t\tdisplay: loading ? 'block' : 'none',\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: '10px',\n\t\t\t\t\t\tleft: '50%',\n\t\t\t\t\t\tmarginLeft: '-0.75rem',\n\t\t\t\t\t\twidth: '1.5rem',\n\t\t\t\t\t\theight: '1.5rem',\n\t\t\t\t\t\tborder: '3px solid #ccc',\n\t\t\t\t\t\tborderTopColor: 'var(--text)',\n\t\t\t\t\t\tborderRadius: '100%',\n\t\t\t\t\t\tanimation: `${rotation} 0.6s linear infinite`,\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<input\n\t\t\t\t\tid={id}\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tfontSize: '1.5rem',\n\t\t\t\t\t\tpadding: help ? '0.5rem 1.5rem 0.5rem 0.5rem' : '0.5rem',\n\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t\tborder: '1px solid #767676',\n\t\t\t\t\t\tborderRadius: '0.2rem',\n\t\t\t\t\t\tapperance: 'none',\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\tcolor: 'var(--text)',\n\t\t\t\t\t\t':focus': {\n\t\t\t\t\t\t\tboxShadow: '0 0 0 3px #006cff',\n\t\t\t\t\t\t\tborderColor: '#006cff',\n\t\t\t\t\t\t\toutline: 'none',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t':disabled': {\n\t\t\t\t\t\t\tbackground: 'var(--alt-bg)',\n\t\t\t\t\t\t},\n\t\t\t\t\t}}\n\t\t\t\t\trequired={visible ? required : false}\n\t\t\t\t\t{...props}\n\t\t\t\t/>\n\t\t\t\t{help && (\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\taria-label=\"Help\"\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\ttop: '5px',\n\t\t\t\t\t\t\tright: '5px',\n\t\t\t\t\t\t\tdisplay: 'inline-block',\n\t\t\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\t\t\tapperance: 'none',\n\t\t\t\t\t\t\tfontSize: '1rem',\n\t\t\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t\t\t\tlineHeight: 1,\n\t\t\t\t\t\t\tborder: '1px solid var(--text)',\n\t\t\t\t\t\t\tborderRadius: '100%',\n\t\t\t\t\t\t\twidth: '1rem',\n\t\t\t\t\t\t\theight: '1rem',\n\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t\t\t':before': {\n\t\t\t\t\t\t\t\tcontent: '\"?\"',\n\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\ttop: '50%',\n\t\t\t\t\t\t\t\tleft: '0',\n\t\t\t\t\t\t\t\tmargin: '-0.5em 0 0 0',\n\t\t\t\t\t\t\t\tfontSize: '0.75rem',\n\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t':focus, :hover': {\n\t\t\t\t\t\t\t\toutline: 'none',\n\t\t\t\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\twidth: 'max-content',\n\t\t\t\t\t\t\t\tmaxWidth: '93vw',\n\t\t\t\t\t\t\t\tright: '-0.4rem',\n\t\t\t\t\t\t\t\ttop: '2.6rem',\n\t\t\t\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\t\t\t\tborder: '3px solid var(--info)',\n\t\t\t\t\t\t\t\tpadding: '0.5rem',\n\t\t\t\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\t\t\t\ttextAlign: 'right',\n\t\t\t\t\t\t\t\tzIndex: 4,\n\t\t\t\t\t\t\t\t':before': {\n\t\t\t\t\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\ttop: '-1.7rem',\n\t\t\t\t\t\t\t\t\tright: '0.6rem',\n\t\t\t\t\t\t\t\t\twidth: '3px',\n\t\t\t\t\t\t\t\t\theight: '1.7rem',\n\t\t\t\t\t\t\t\t\tbackground: 'var(--info)',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'button:focus > &, button:active > &, button:hover > &': {\n\t\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'& img': {\n\t\t\t\t\t\t\t\t\tmaxWidth: '100%',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'@media (min-width: 63.75rem)': {\n\t\t\t\t\t\t\t\t\tmaxWidth: '59.375rem',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{help}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</button>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</li>\n\t);\n}\n","/** @jsx jsx */\n\nimport { jsx, keyframes } from '@emotion/core';\nimport { Fragment } from 'react';\n\nimport { Wrapper } from './primitives/Wrapper';\nimport { Button } from './primitives/Button';\nimport { Input } from './primitives/Input';\n\nexport function LoginForm({ handleLogin, inputLines, loading, error }) {\n\tconst rotation = keyframes({\n\t\tto: {\n\t\t\ttransform: 'rotate( 360deg )',\n\t\t},\n\t});\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<h1\n\t\t\t\tcss={{\n\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t'\"Playfair Display\", \"PT Serif\", Cambria, \"Hoefler Text\", Utopia, \"Liberation Serif\", \"Nimbus Roman No9 L Regular\", Times, \"Times New Roman\", serif',\n\t\t\t\t\tfontStyle: 'italic',\n\t\t\t\t\tfontSize: '20vw',\n\t\t\t\t\tmargin: '0 0 5vw 0',\n\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\tfontWeight: 700,\n\t\t\t\t\ttextShadow: '0 1.8vw 1.8vw #333',\n\t\t\t\t\tcolor: '#fff',\n\t\t\t\t\t'@media (min-width: 125rem)': {\n\t\t\t\t\t\tfontSize: '25rem',\n\t\t\t\t\t\tmarginBottom: '6.25rem',\n\t\t\t\t\t\ttextShadow: '0 2.25rem 2.25rem #333',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tLogin\n\t\t\t</h1>\n\t\t\t<Wrapper>\n\t\t\t\t<form\n\t\t\t\t\tonSubmit={handleLogin}\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tposition: 'relative',\n\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t':after': {\n\t\t\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\t\t\tdisplay: loading ? 'block' : 'none',\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\ttop: '50%',\n\t\t\t\t\t\t\tleft: '50%',\n\t\t\t\t\t\t\tmarginLeft: '-2.5rem',\n\t\t\t\t\t\t\tmarginTop: '-2.5rem',\n\t\t\t\t\t\t\twidth: '5rem',\n\t\t\t\t\t\t\theight: '5rem',\n\t\t\t\t\t\t\tborder: '0.75rem solid #aaa',\n\t\t\t\t\t\t\tborderTopColor: 'var(--text)',\n\t\t\t\t\t\t\tborderRadius: '100%',\n\t\t\t\t\t\t\tanimation: `${rotation} 0.5s linear infinite`,\n\t\t\t\t\t\t},\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<ul\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tlistStyle: 'none',\n\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t\t\topacity: loading ? 0.4 : 1,\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{inputLines.map(({ id, label, value, setValue, help }) => (\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\t\tlabel={label}\n\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\thelp={help}\n\t\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t\t\tonChange={(event) => setValue(event.target.value)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ul>\n\t\t\t\t\t<div\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\t\tgridTemplateColumns: '1fr',\n\t\t\t\t\t\t\tjustifyItems: 'end',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Button type=\"submit\" disabled={loading}>\n\t\t\t\t\t\t\tSave login\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t\t{error && (\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\tdisplay: 'inline-block',\n\t\t\t\t\t\t\t\tmarginTop: '1rem',\n\t\t\t\t\t\t\t\tcolor: 'var(--danger)',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{error}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</form>\n\t\t\t</Wrapper>\n\t\t</Fragment>\n\t);\n}\n","/** @jsx jsx */\n\nimport { jsx, keyframes } from '@emotion/core';\nimport { useState } from 'react';\n\nexport function IconButton({\n\tchildren,\n\tconfirm,\n\tonClick,\n\ticon,\n\tlook = 'add',\n\tas: Tag = 'button',\n\t...props\n}) {\n\tconst [clicked, setClicked] = useState(false);\n\tconst [confirmScreen, setConfirmScreen] = useState(false);\n\tconst [reset, setReset] = useState([]);\n\n\tconst pulse1 = keyframes({\n\t\t'0%': {\n\t\t\ttransform: 'scale(0.6)',\n\t\t\topacity: 0,\n\t\t},\n\t\t'33%': {\n\t\t\ttransform: 'scale(1)',\n\t\t\topacity: 1,\n\t\t},\n\t\t'100%': {\n\t\t\ttransform: 'scale(1.4)',\n\t\t\topacity: 0,\n\t\t},\n\t});\n\n\tconst pulse2 = keyframes({\n\t\t'0%': {\n\t\t\tboxShadow: '0 0 0 3px rgba(255, 255, 255, 0.2)',\n\t\t\topacity: 0,\n\t\t},\n\t\t'33%': {\n\t\t\tboxShadow: '0 0 0 10px rgba(255, 255, 255, 0.2)',\n\t\t\topacity: 1,\n\t\t},\n\t\t'100%': {\n\t\t\tboxShadow: '0 0 0 16px rgba(255, 255, 255, 0.2)',\n\t\t\topacity: 0,\n\t\t},\n\t});\n\n\tconst styleMap = {\n\t\t'import-export': {\n\t\t\t':before, :after': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '50%',\n\t\t\t\tleft: '14px',\n\t\t\t\twidth: '10px',\n\t\t\t\theight: '10px',\n\t\t\t\tmarginTop: '-5px',\n\t\t\t\tborder: '3px solid var(--text)',\n\t\t\t\tborderRadius: '100% 0 100% 100%',\n\t\t\t\ttransform: 'rotate(45deg)',\n\t\t\t\ttransition: 'border 0.2s ease',\n\t\t\t},\n\t\t\t':after': {\n\t\t\t\tleft: '25px',\n\t\t\t\tborderRadius: '100% 100% 100% 0',\n\t\t\t},\n\t\t\t':hover': {\n\t\t\t\tbackground: 'var(--info)',\n\t\t\t\tcolor: '#fff',\n\t\t\t},\n\t\t\t':hover:before, :hover:after': {\n\t\t\t\tborderColor: '#fff',\n\t\t\t},\n\t\t},\n\t\timport: {\n\t\t\t':before': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '50%',\n\t\t\t\tleft: '20px',\n\t\t\t\twidth: '3px',\n\t\t\t\theight: '10px',\n\t\t\t\tmarginTop: '-6px',\n\t\t\t\tbackground: 'var(--text)',\n\t\t\t\tborderRadius: '2px',\n\t\t\t\ttransition: 'background 0.2s ease',\n\t\t\t},\n\t\t\t':after': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '50%',\n\t\t\t\tleft: '17px',\n\t\t\t\twidth: '9px',\n\t\t\t\theight: '9px',\n\t\t\t\tmarginTop: '-3px',\n\t\t\t\tborder: '3px solid var(--text)',\n\t\t\t\tborderStyle: 'none solid solid none',\n\t\t\t\ttransform: 'rotate(45deg)',\n\t\t\t\tborderRadius: '2px',\n\t\t\t\ttransition: 'border 0.2s ease',\n\t\t\t},\n\t\t\t':hover': {\n\t\t\t\tbackground: 'var(--info)',\n\t\t\t\tcolor: '#fff',\n\t\t\t},\n\t\t\t':hover:before': {\n\t\t\t\tbackground: '#fff',\n\t\t\t},\n\t\t\t':hover:after': {\n\t\t\t\tborderColor: '#fff',\n\t\t\t},\n\t\t},\n\t\texport: {\n\t\t\t':before': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '50%',\n\t\t\t\tleft: '17px',\n\t\t\t\twidth: '9px',\n\t\t\t\theight: '9px',\n\t\t\t\tmarginTop: '-6px',\n\t\t\t\tborder: '3px solid var(--text)',\n\t\t\t\tborderStyle: 'solid none none solid',\n\t\t\t\ttransform: 'rotate(45deg)',\n\t\t\t\tborderRadius: '2px',\n\t\t\t\ttransition: 'border 0.2s ease',\n\t\t\t},\n\t\t\t':after': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '50%',\n\t\t\t\tleft: '20px',\n\t\t\t\twidth: '3px',\n\t\t\t\theight: '10px',\n\t\t\t\tmarginTop: '-4px',\n\t\t\t\tbackground: 'var(--text)',\n\t\t\t\tborderRadius: '2px',\n\t\t\t\ttransition: 'background 0.2s ease',\n\t\t\t},\n\t\t\t':hover': {\n\t\t\t\tbackground: 'var(--info)',\n\t\t\t\tcolor: '#fff',\n\t\t\t},\n\t\t\t':hover:before': {\n\t\t\t\tborderColor: '#fff',\n\t\t\t},\n\t\t\t':hover:after': {\n\t\t\t\tbackground: '#fff',\n\t\t\t},\n\t\t},\n\t\tadjust: {\n\t\t\t':before': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '50%',\n\t\t\t\tleft: '14px',\n\t\t\t\twidth: '14px',\n\t\t\t\theight: '14px',\n\t\t\t\tmarginTop: '-7px',\n\t\t\t\tborder: '6px solid var(--text)',\n\t\t\t\tborderRadius: '100%',\n\t\t\t\ttransition: 'border 0.2s ease',\n\t\t\t},\n\t\t\t':after': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\tboxSizing: 'content-box',\n\t\t\t\ttop: '50%',\n\t\t\t\tleft: '12px',\n\t\t\t\twidth: '10px',\n\t\t\t\theight: '10px',\n\t\t\t\tmarginTop: '-9px',\n\t\t\t\tborder: '4px dotted var(--text)',\n\t\t\t\tborderRadius: '100%',\n\t\t\t\ttransition: 'border 0.2s ease',\n\t\t\t},\n\t\t\t':hover': {\n\t\t\t\tbackground: 'var(--info)',\n\t\t\t\tcolor: '#fff',\n\t\t\t},\n\t\t\t':hover:before, :hover:after': {\n\t\t\t\tborderColor: '#fff',\n\t\t\t},\n\t\t},\n\t\tlogout: {\n\t\t\tbackground: '#fff',\n\t\t\tpadding: icon ? '0.5rem 1rem 0.5rem 2rem' : '0.5rem 1rem',\n\t\t\t':hover': {\n\t\t\t\tbackground: 'var(--danger)',\n\t\t\t\tcolor: '#fff',\n\t\t\t},\n\t\t},\n\t\tsync: {\n\t\t\tbackground: props.disabled ? 'var(--alt-bg)' : 'var(--confirm)',\n\t\t\tcolor: props.disabled ? 'var(--text)' : '#fff',\n\t\t\tcursor: props.disabled ? 'not-allowed' : 'pointer',\n\t\t\t':before': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '50%',\n\t\t\t\tleft: '0.5rem',\n\t\t\t\twidth: '1.5rem',\n\t\t\t\theight: '1.5rem',\n\t\t\t\tmarginTop: '-0.75rem',\n\t\t\t\tbackground: 'rgba(255,255,255, 0.2)',\n\t\t\t\tborderRadius: '50px',\n\t\t\t\topacity: 0,\n\t\t\t\tanimation: props.disabled ? 'none' : `${pulse1} 3s 2s infinite linear`,\n\t\t\t},\n\t\t\t':after': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '50%',\n\t\t\t\tleft: '1rem',\n\t\t\t\twidth: '4px',\n\t\t\t\theight: '4px',\n\t\t\t\tmarginTop: '-2px',\n\t\t\t\tmarginLeft: '2px',\n\t\t\t\tbackground: props.disabled ? 'var(--text)' : '#fff',\n\t\t\t\tborderRadius: '50%',\n\t\t\t\tboxShadow: '0 0 0 1px rgba(255, 255, 255, 0.2)',\n\t\t\t\tanimation: props.disabled ? 'none' : `${pulse2} 3s infinite linear`,\n\t\t\t},\n\t\t},\n\t\tadd: {\n\t\t\t':before, :after': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\twidth: '1rem',\n\t\t\t\theight: '0.25rem',\n\t\t\t\tbackground: 'var(--text)',\n\t\t\t\tborderRadius: '2px',\n\t\t\t\ttop: '50%',\n\t\t\t\tmarginTop: '-0.125rem',\n\t\t\t\tleft: '1rem',\n\t\t\t\ttransition: 'background 0.2s ease',\n\t\t\t},\n\t\t\t':after': {\n\t\t\t\ttransform: 'rotate(-90deg)',\n\t\t\t},\n\t\t\t':hover': {\n\t\t\t\tbackground: 'var(--info)',\n\t\t\t\tcolor: '#fff',\n\t\t\t},\n\t\t\t':hover:before, :hover:after': {\n\t\t\t\tbackground: '#fff',\n\t\t\t},\n\t\t},\n\t\tdelete: {\n\t\t\t':before, :after': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\twidth: '1rem',\n\t\t\t\theight: '0.25rem',\n\t\t\t\tbackground: 'var(--text)',\n\t\t\t\tborderRadius: '2px',\n\t\t\t\ttransform: 'rotate(45deg)',\n\t\t\t\ttop: '50%',\n\t\t\t\tmarginTop: '-0.125rem',\n\t\t\t\tleft: '1rem',\n\t\t\t\ttransition: 'background 0.2s ease',\n\t\t\t},\n\t\t\t':after': {\n\t\t\t\ttransform: 'rotate(-45deg)',\n\t\t\t},\n\t\t\t':hover': {\n\t\t\t\tbackground: 'var(--danger)',\n\t\t\t\tcolor: '#fff',\n\t\t\t},\n\t\t\t':hover:before, :hover:after': {\n\t\t\t\tbackground: '#fff',\n\t\t\t},\n\t\t},\n\t\tedit: {\n\t\t\t':before': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '50%',\n\t\t\t\tmarginTop: '-0.5rem',\n\t\t\t\tleft: '1rem',\n\t\t\t\twidth: '0.9rem',\n\t\t\t\theight: '1rem',\n\t\t\t\tborder: '2px solid var(--text)',\n\t\t\t\ttransition: 'border 0.2s ease',\n\t\t\t},\n\t\t\t':after': {\n\t\t\t\tcontent: '\"\"',\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: '2px',\n\t\t\t\tleft: '1.65rem',\n\t\t\t\tbackground: 'var(--text)',\n\t\t\t\twidth: '4px',\n\t\t\t\theight: '1rem',\n\t\t\t\ttransform: 'rotate(45deg)',\n\t\t\t\tborderRadius: '1px 1px 50% 50%',\n\t\t\t\tboxShadow: '0 0 0 2px var(--alt-bg)',\n\t\t\t\ttransition: 'background 0.2s ease, box-shadow 0.2s ease',\n\t\t\t},\n\t\t\t':hover': {\n\t\t\t\tbackground: 'var(--confirm)',\n\t\t\t\tcolor: '#fff',\n\t\t\t},\n\t\t\t':hover:before': {\n\t\t\t\tborderColor: '#fff',\n\t\t\t},\n\t\t\t':hover:after': {\n\t\t\t\tbackground: '#fff',\n\t\t\t\tboxShadow: '0 0 0 2px var(--confirm)',\n\t\t\t},\n\t\t},\n\t};\n\n\tconst handleClick = (event) => {\n\t\tclearTimeout(reset);\n\t\tsetReset([]);\n\n\t\tif (confirm && !clicked) {\n\t\t\tevent.preventDefault();\n\t\t\tsetConfirmScreen(true);\n\t\t\tsetReset(\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tsetClicked(false);\n\t\t\t\t\tsetConfirmScreen(false);\n\t\t\t\t\tsetReset([]);\n\t\t\t\t}, 3000)\n\t\t\t);\n\t\t} else {\n\t\t\tif (typeof onClick == 'function') {\n\t\t\t\tonClick();\n\t\t\t}\n\n\t\t\tsetConfirmScreen(false);\n\t\t}\n\n\t\tsetClicked(!clicked);\n\t};\n\n\treturn (\n\t\t<Tag\n\t\t\tcss={{\n\t\t\t\tposition: 'relative',\n\t\t\t\tdisplay: 'inline-block',\n\t\t\t\tapperance: 'none',\n\t\t\t\tbackground: 'var(--alt-bg)',\n\t\t\t\tcolor: 'var(--text)',\n\t\t\t\tborder: 'none',\n\t\t\t\tborderRadius: '6px',\n\t\t\t\tpadding: icon ? '0.5rem 1rem 0.5rem 2rem' : '0.5rem 1rem 0.5rem 2.5rem',\n\t\t\t\tfontSize: '0.75rem',\n\t\t\t\ttextDecoration: 'none',\n\t\t\t\ttextAlign: 'center',\n\t\t\t\tlineHeight: 1,\n\t\t\t\ttransition: 'background 0.2s ease, color 0.2s ease',\n\t\t\t\toverflow: 'hidden',\n\t\t\t\tcursor: 'pointer',\n\t\t\t\t':focus': {\n\t\t\t\t\toutline: 'none',\n\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t},\n\t\t\t\t...(styleMap[look] ? styleMap[look] : {}),\n\t\t\t}}\n\t\t\tonClick={handleClick}\n\t\t\t{...props}\n\t\t>\n\t\t\t{icon && (\n\t\t\t\t<img\n\t\t\t\t\tsrc={icon}\n\t\t\t\t\talt=\"\"\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\tleft: '6px',\n\t\t\t\t\t\ttop: '3px',\n\t\t\t\t\t\theight: '22px',\n\t\t\t\t\t\tborderRadius: '100%',\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{confirmScreen ? 'Sure?' : children}\n\t\t</Tag>\n\t);\n}\n","/** @jsx jsx */\n\nimport { jsx } from '@emotion/core';\n\nexport function Checkbox({ id, checked, onChange, size = 'lg', ...props }) {\n\tconst styleMap = {\n\t\tsm: {\n\t\t\troot: {\n\t\t\t\twidth: '1rem',\n\t\t\t\theight: '1rem',\n\t\t\t\tborder: '3px solid var(--text)',\n\t\t\t},\n\t\t\tbefore: {\n\t\t\t\ttop: '-1px',\n\t\t\t\tright: '-3px',\n\t\t\t\twidth: '0.75rem',\n\t\t\t\theight: '0.4rem',\n\t\t\t\tborderBottom: '2px solid var(--text)',\n\t\t\t\tborderLeft: '2px solid var(--text)',\n\t\t\t},\n\t\t\tafter: {\n\t\t\t\ttop: '-8px',\n\t\t\t\tright: '-8px',\n\t\t\t\twidth: '0.55rem',\n\t\t\t\theight: '0.85rem',\n\t\t\t},\n\t\t},\n\t\tlg: {\n\t\t\troot: {\n\t\t\t\twidth: '2rem',\n\t\t\t\theight: '2rem',\n\t\t\t\tborder: '4px solid var(--text)',\n\t\t\t},\n\t\t\tbefore: {\n\t\t\t\ttop: '-1px',\n\t\t\t\tright: '-5px',\n\t\t\t\twidth: '1.5rem',\n\t\t\t\theight: '0.8rem',\n\t\t\t\tborderBottom: '4px solid var(--text)',\n\t\t\t\tborderLeft: '4px solid var(--text)',\n\t\t\t},\n\t\t\tafter: {\n\t\t\t\ttop: '-10px',\n\t\t\t\tright: '-10px',\n\t\t\t\twidth: '0.8rem',\n\t\t\t\theight: '1.4rem',\n\t\t\t},\n\t\t},\n\t};\n\n\treturn (\n\t\t<div\n\t\t\tcss={{\n\t\t\t\tposition: 'relative',\n\t\t\t\tdisplay: 'inline-block',\n\t\t\t\toverflow: 'hidden',\n\t\t\t}}\n\t\t\t{...props}\n\t\t>\n\t\t\t<input\n\t\t\t\tid={id}\n\t\t\t\ttype=\"checkbox\"\n\t\t\t\tchecked={checked}\n\t\t\t\tonChange={onChange}\n\t\t\t\tcss={{\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\ttop: '-5rem',\n\t\t\t\t\tleft: '-5rem',\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<span\n\t\t\t\tcss={{\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\tborderRadius: '3px',\n\t\t\t\t\tzIndex: 1,\n\t\t\t\t\tmargin: '7px',\n\t\t\t\t\t...styleMap[size].root,\n\t\t\t\t\t':before': {\n\t\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttransform: 'rotate(-45deg)',\n\t\t\t\t\t\tzIndex: 3,\n\t\t\t\t\t\t...styleMap[size].before,\n\t\t\t\t\t},\n\t\t\t\t\t':after': {\n\t\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\t\tzIndex: 2,\n\t\t\t\t\t\t...styleMap[size].after,\n\t\t\t\t\t},\n\t\t\t\t\t'input:checked + &:before,input:checked + &:after': {\n\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t},\n\t\t\t\t\t'input:focus + &': {\n\t\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","/** @jsx jsx */\n\nimport { Link, useHistory } from 'react-router-dom';\nimport { jsx } from '@emotion/core';\nimport { useState } from 'react';\n\nimport { getSheets, writeSheets, getOutput, writeOutput } from './storage';\nimport { IconButton } from './primitives/IconButton';\nimport { Checkbox } from './primitives/Checkbox';\nimport { Wrapper } from './primitives/Wrapper';\nimport { Button } from './primitives/Button';\nimport { version } from '../package.json';\n\nexport function ImportExport() {\n\tconst sheets = getSheets();\n\tconst output = getOutput();\n\tconst [includeOutput, setIncludeOutput] = useState(false);\n\tconst [overrideSheets, setOverrideSheets] = useState(false);\n\tconst [overrideOutput, setOverrideOutput] = useState(false);\n\tconst [file, setFile] = useState('');\n\tconst [error, setError] = useState('');\n\tconst history = useHistory();\n\n\tconst importFile = (event) => {\n\t\tevent.preventDefault();\n\t\tsetError('');\n\n\t\tif (file) {\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = (event) => {\n\t\t\t\tlet data = event.target.result;\n\t\t\t\ttry {\n\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\tif (overrideSheets && data.sheets) {\n\t\t\t\t\t\t// reset relationship\n\t\t\t\t\t\tif (!overrideOutput) {\n\t\t\t\t\t\t\tdata.sheets = data.sheets.map(({ output, ...rest }) => ({ output: 1, ...rest }));\n\t\t\t\t\t\t}\n\t\t\t\t\t\twriteSheets(data.sheets);\n\t\t\t\t\t}\n\t\t\t\t\tif (overrideOutput && data.output) {\n\t\t\t\t\t\t// reset relationship\n\t\t\t\t\t\tif (!overrideSheets) {\n\t\t\t\t\t\t\tconst newSheets = sheets.map(({ output, ...rest }) => ({ output: 1, ...rest }));\n\t\t\t\t\t\t\twriteSheets(newSheets);\n\t\t\t\t\t\t}\n\t\t\t\t\t\twriteOutput(data.output);\n\t\t\t\t\t}\n\t\t\t\t\thistory.push('/');\n\t\t\t\t} catch (error) {\n\t\t\t\t\tsetError(\n\t\t\t\t\t\t`The import file could not be read. Please make sure it's in the right format \"harvest2sheet.export\"`\n\t\t\t\t\t);\n\t\t\t\t\tsetFile('');\n\t\t\t\t}\n\t\t\t};\n\t\t\treader.readAsText(file);\n\t\t}\n\t};\n\n\treturn (\n\t\t<Wrapper>\n\t\t\t<h2>Export</h2>\n\n\t\t\t<label\n\t\t\t\tcss={{\n\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\tgridTemplateColumns: '2rem 1fr',\n\t\t\t\t\talignItems: 'center',\n\t\t\t\t\tmargin: '0 0 0 0.5rem',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Checkbox\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tid=\"includeOutput\"\n\t\t\t\t\tchecked={includeOutput}\n\t\t\t\t\tonChange={(event) => setIncludeOutput(event.target.checked)}\n\t\t\t\t/>\n\t\t\t\tInclude Output\n\t\t\t</label>\n\t\t\t<IconButton\n\t\t\t\tlook=\"export\"\n\t\t\t\tas=\"a\"\n\t\t\t\thref={`data:text/plain;charset=utf-8,${encodeURIComponent(\n\t\t\t\t\tJSON.stringify({ version, sheets, ...(includeOutput ? { output } : {}) }, null, '\\t')\n\t\t\t\t)}`}\n\t\t\t\tdownload=\"harvest2sheet.export\"\n\t\t\t\tcss={{\n\t\t\t\t\tmarginTop: '1rem',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tExport\n\t\t\t</IconButton>\n\n\t\t\t<h2\n\t\t\t\tcss={{\n\t\t\t\t\tborderTop: '2px dashed var(--alt-bg)',\n\t\t\t\t\tpaddingTop: '0.5rem',\n\t\t\t\t\tmarginBottom: '1rem',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tImport\n\t\t\t</h2>\n\n\t\t\t<form onSubmit={importFile}>\n\t\t\t\t<div\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tposition: 'relative',\n\t\t\t\t\t\tmarginLeft: '1rem',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\tid=\"file\"\n\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tonChange={(event) => setFile(event.target.files[0])}\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\twidth: '1px',\n\t\t\t\t\t\t\tleft: '0.5rem',\n\t\t\t\t\t\t\theight: '1.5rem',\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t<label\n\t\t\t\t\t\thtmlFor=\"file\"\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tposition: 'relative',\n\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\twidth: '12.5rem',\n\t\t\t\t\t\t\theight: '1.5rem',\n\t\t\t\t\t\t\tborderRadius: '6px',\n\t\t\t\t\t\t\tborder: '3px solid var(--text)',\n\t\t\t\t\t\t\tmargin: '0.5rem 0',\n\t\t\t\t\t\t\t':before': {\n\t\t\t\t\t\t\t\tcontent: '\"Browse\"',\n\t\t\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\t\tbottom: 0,\n\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\twidth: '3.3rem',\n\t\t\t\t\t\t\t\tbackground: 'var(--text)',\n\t\t\t\t\t\t\t\tcolor: '#fff',\n\t\t\t\t\t\t\t\tpadding: '0 6px',\n\t\t\t\t\t\t\t\tfontSize: '0.75rem',\n\t\t\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t':after': {\n\t\t\t\t\t\t\t\tcontent: file && file.name ? `\"${file.name}\"` : '\"Choose file...\"',\n\t\t\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\tleft: '3.8rem',\n\t\t\t\t\t\t\t\tbottom: 0,\n\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\twidth: '8rem',\n\t\t\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\t\t\t\tfontSize: '0.75rem',\n\t\t\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'input:focus + &': {\n\t\t\t\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t<label\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\t\tgridTemplateColumns: '2rem 1fr',\n\t\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\t\tmarginLeft: '-0.5rem',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tid=\"overrideSheets\"\n\t\t\t\t\t\t\tchecked={overrideSheets}\n\t\t\t\t\t\t\tonChange={(event) => setOverrideSheets(event.target.checked)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\tOverride sheets\n\t\t\t\t\t</label>\n\t\t\t\t\t<label\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\t\tgridTemplateColumns: '2rem 1fr',\n\t\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\t\tmarginLeft: '-0.5rem',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tid=\"overrideOutput\"\n\t\t\t\t\t\t\tchecked={overrideOutput}\n\t\t\t\t\t\t\tonChange={(event) => setOverrideOutput(event.target.checked)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\tOverride output\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t{error && <div css={{ color: 'var(--danger)' }}>{error}</div>}\n\t\t\t\t<IconButton\n\t\t\t\t\tlook=\"import\"\n\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tmarginTop: '1rem',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tImport\n\t\t\t\t</IconButton>\n\t\t\t</form>\n\n\t\t\t<Button\n\t\t\t\tlook=\"muted\"\n\t\t\t\tto=\"/\"\n\t\t\t\tas={Link}\n\t\t\t\tcss={{\n\t\t\t\t\tmarginTop: '1.5rem',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tCancel\n\t\t\t</Button>\n\t\t</Wrapper>\n\t);\n}\n","/** @jsx jsx */\n\nimport { jsx } from '@emotion/core';\n\nexport function Code({ kind, ...props }) {\n\tconst kindMap = {\n\t\tproject: {\n\t\t\tcontent: '\"P\"',\n\t\t\ttitle: 'Project',\n\t\t},\n\t\tclient: {\n\t\t\tcontent: '\"C\"',\n\t\t\ttitle: 'Client',\n\t\t},\n\t};\n\n\treturn (\n\t\t<span\n\t\t\ttitle={kind ? kindMap[kind].title : null}\n\t\t\tcss={{\n\t\t\t\tdisplay: 'inline-block',\n\t\t\t\tbackground: 'var(--alt-bg)',\n\t\t\t\tborder: '1px solid #ccc',\n\t\t\t\tpadding: '0 0.25rem',\n\t\t\t\tborderRadius: '3px',\n\t\t\t\tmargin: '0.125rem',\n\t\t\t\tfontSize: '0.75rem',\n\t\t\t\t...(kind\n\t\t\t\t\t? {\n\t\t\t\t\t\t\t':before': {\n\t\t\t\t\t\t\t\tcontent: kindMap[kind].content,\n\t\t\t\t\t\t\t\tdisplay: 'inline-block',\n\t\t\t\t\t\t\t\tfontWeight: 900,\n\t\t\t\t\t\t\t\tmarginRight: '0.25rem',\n\t\t\t\t\t\t\t\tpaddingRight: '0.25rem',\n\t\t\t\t\t\t\t\tborderRight: '1px solid #ccc',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  }\n\t\t\t\t\t: {}),\n\t\t\t}}\n\t\t\t{...props}\n\t\t/>\n\t);\n}\n","/** @jsx jsx */\n\nimport { Link } from 'react-router-dom';\nimport { jsx } from '@emotion/core';\n\nimport { IconButton } from './IconButton';\nimport { Checkbox } from './Checkbox';\nimport { Code } from './Code';\n\nexport function SheetCard({\n\tid,\n\tname,\n\thProjectName,\n\thClientName,\n\ttabName,\n\thourSummaryTabName,\n\tgSheetIDName,\n\toutput,\n\tselected,\n\ttoggle,\n\tdeleteSheet,\n}) {\n\treturn (\n\t\t<div\n\t\t\tcss={{\n\t\t\t\tdisplay: 'grid',\n\t\t\t\tgridTemplateColumns: '3rem auto',\n\t\t\t\tgap: '0.5rem',\n\t\t\t\talignItems: 'center',\n\t\t\t\t'@media (min-width: 40rem)': {\n\t\t\t\t\tgridTemplateColumns: '3rem auto 12rem',\n\t\t\t\t},\n\t\t\t}}\n\t\t>\n\t\t\t<label\n\t\t\t\tcss={{\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\twidth: '3rem',\n\t\t\t\t\theight: '3rem',\n\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Checkbox\n\t\t\t\t\tid={id}\n\t\t\t\t\tchecked={selected.includes(id)}\n\t\t\t\t\tonChange={() => toggle(id)}\n\t\t\t\t\tcss={{ margin: '2px' }}\n\t\t\t\t/>\n\t\t\t</label>\n\t\t\t<label\n\t\t\t\thtmlFor={id}\n\t\t\t\tcss={{\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<strong\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{name}\n\t\t\t\t</strong>\n\t\t\t\t<div\n\t\t\t\t\tcss={{\n\t\t\t\t\t\t'@media (min-width: 40rem)': {\n\t\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\t\tgridTemplateColumns: 'auto 1fr',\n\t\t\t\t\t\t\tgap: '1.75rem',\n\t\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\t},\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t'@media (min-width: 40rem)': {\n\t\t\t\t\t\t\t\tposition: 'relative',\n\t\t\t\t\t\t\t\t':before': {\n\t\t\t\t\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\ttop: '50%',\n\t\t\t\t\t\t\t\t\tright: '-1.25rem',\n\t\t\t\t\t\t\t\t\theight: '4px',\n\t\t\t\t\t\t\t\t\twidth: '1rem',\n\t\t\t\t\t\t\t\t\tmarginTop: '-2px',\n\t\t\t\t\t\t\t\t\tbackground: 'var(--text)',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t':after': {\n\t\t\t\t\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\ttop: '50%',\n\t\t\t\t\t\t\t\t\tright: '-1.8rem',\n\t\t\t\t\t\t\t\t\tborder: '6px solid var(--text)',\n\t\t\t\t\t\t\t\t\tborderColor: 'transparent transparent transparent var(--text)',\n\t\t\t\t\t\t\t\t\tmarginTop: '-6px',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Code kind={hProjectName ? 'project' : 'client'}>{hProjectName || hClientName}</Code>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Code>{gSheetIDName}</Code>\n\t\t\t\t\t\t<Code>{tabName}</Code>\n\t\t\t\t\t\t{hourSummaryTabName && <Code>{hourSummaryTabName}</Code>}\n\t\t\t\t\t\t<Code>\n\t\t\t\t\t\t\t{output.name} ({output.columns.length} columns)\n\t\t\t\t\t\t</Code>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t\t<div\n\t\t\t\tcss={{\n\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\tgridTemplateColumns: '1fr 1fr',\n\t\t\t\t\tgap: '0.5rem',\n\t\t\t\t\talignItems: 'center',\n\t\t\t\t\tgridColumn: '1 / 3',\n\t\t\t\t\t'@media (min-width: 40rem)': {\n\t\t\t\t\t\tgridTemplateColumns: '1fr 1fr',\n\t\t\t\t\t\tgridColumn: 'unset',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<IconButton look=\"edit\" as={Link} to={`/edit/${id}`}>\n\t\t\t\t\tEdit\n\t\t\t\t</IconButton>\n\t\t\t\t<IconButton confirm type=\"button\" look=\"delete\" onClick={() => deleteSheet(id)}>\n\t\t\t\t\tDelete\n\t\t\t\t</IconButton>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","/** @jsx jsx */\n\nimport { jsx, keyframes } from '@emotion/core';\nimport parseISO from 'date-fns/parseISO';\nimport { Link } from 'react-router-dom';\nimport subDays from 'date-fns/subDays';\nimport format from 'date-fns/format';\nimport { useState } from 'react';\n\nimport { getLogin, getSheets, writeSheets, getOutput, writeOutput } from './storage';\nimport { harvestSync, getSummary } from './harvestSync';\nimport { IconButton } from './primitives/IconButton';\nimport { SheetCard } from './primitives/SheetCard';\nimport { Wrapper } from './primitives/Wrapper';\nimport { googleSync } from './googleSync';\n\nexport function ListSheets() {\n\tconst LOGIN = getLogin();\n\tconst storageSheets = getSheets();\n\tlet output = getOutput();\n\n\tif (output.length === 0) {\n\t\toutput = [\n\t\t\t{\n\t\t\t\tid: 1,\n\t\t\t\tname: 'Default',\n\t\t\t\tcolumns: [\n\t\t\t\t\t'date',\n\t\t\t\t\t'user',\n\t\t\t\t\t'client',\n\t\t\t\t\t'project',\n\t\t\t\t\t'task',\n\t\t\t\t\t'hours',\n\t\t\t\t\t'rounded_hours',\n\t\t\t\t\t'notes',\n\t\t\t\t\t'billable_rate',\n\t\t\t\t\t'billable_amount',\n\t\t\t\t\t'cost_rate',\n\t\t\t\t\t'cost_amount',\n\t\t\t\t\t'currency',\n\t\t\t\t],\n\t\t\t},\n\t\t];\n\n\t\twriteSheets(storageSheets.map((sheet) => ({ output: 1, ...sheet })));\n\t\twriteOutput(output);\n\t}\n\n\tconst [sheets, setSheets] = useState(storageSheets);\n\tconst [date, setDate] = useState(format(subDays(new Date(), 5), 'yyyy-MM'));\n\tconst [loading, setLoading] = useState(false);\n\tconst [selected, setSelected] = useState([]);\n\tconst [sort, setSort] = useState('name');\n\tconst [filter, setFilter] = useState('');\n\n\tconst sorting = (sheets, sort) => {\n\t\tif (sort === 'time') {\n\t\t\treturn sheets.sort((a, b) => (a.name < b.name ? -1 : 1));\n\t\t} else {\n\t\t\treturn sheets.sort((a, b) => a.id - b.id);\n\t\t}\n\t};\n\n\tconst sortSheets = () => {\n\t\tif (sort === 'time') {\n\t\t\tsetSort('name');\n\t\t\tsetSheets(sorting(sheets, 'name'));\n\t\t} else {\n\t\t\tsetSort('time');\n\t\t\tsetSheets(sorting(sheets, 'time'));\n\t\t}\n\t};\n\n\tconst filterSheets = (event) => {\n\t\tsetFilter(event.target.value);\n\t\tconst newSheet = storageSheets.filter(({ name }) =>\n\t\t\tname.toLowerCase().includes(event.target.value.toLowerCase())\n\t\t);\n\t\tsetSheets(sorting(newSheet, sort));\n\t};\n\n\tconst getOutputByID = (ID) => output.filter(({ id }) => id === ID)[0];\n\n\tconst deleteSheet = (sheetID) => {\n\t\tconst newSheet = sheets.filter(({ id }) => id !== sheetID);\n\t\twriteSheets(newSheet);\n\t\tsetSheets(newSheet);\n\t};\n\n\tconst toggle = (toggleID) => {\n\t\tif (selected.includes(toggleID)) {\n\t\t\tconst newSelected = [...selected].filter((id) => id !== toggleID);\n\t\t\tsetSelected(newSelected);\n\t\t} else {\n\t\t\tconst newSelected = [...selected];\n\t\t\tnewSelected.push(toggleID);\n\t\t\tsetSelected(newSelected);\n\t\t}\n\t};\n\n\tconst selectAll = () => {\n\t\tsetSelected(sheets.map((sheet) => sheet.id));\n\t};\n\n\tconst sync = async (event, tabName) => {\n\t\tevent.preventDefault();\n\t\tsetLoading(true);\n\t\tconst selectedSheets = sheets.filter(({ id }) => selected.includes(id));\n\t\tawait Promise.all(\n\t\t\tselectedSheets.map(async ({ hProject, hClient, gSheetID, output, hourSummary }) => {\n\t\t\t\tconst hID = hProject || hClient;\n\t\t\t\tconst apiCall = hProject ? 'project_id' : 'client_id';\n\t\t\t\ttry {\n\t\t\t\t\tconst timeData = await harvestSync(\n\t\t\t\t\t\tLOGIN,\n\t\t\t\t\t\thID,\n\t\t\t\t\t\tdate,\n\t\t\t\t\t\tgetOutputByID(output).columns,\n\t\t\t\t\t\tapiCall\n\t\t\t\t\t);\n\t\t\t\t\tawait googleSync(LOGIN, gSheetID, date, timeData.csv, tabName);\n\t\t\t\t\tif (hourSummary) {\n\t\t\t\t\t\tconst data = getSummary(timeData.allData);\n\t\t\t\t\t\tawait googleSync(LOGIN, gSheetID, date, data, hourSummaryTabName);\n\t\t\t\t\t}\n\t\t\t\t\tsetSelected([]);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tsetLoading(false);\n\t};\n\n\tconst rotation = keyframes({\n\t\tto: {\n\t\t\ttransform: 'rotate( 360deg )',\n\t\t},\n\t});\n\n\tconst fromDate = parseISO(`${date.length === 7 ? date : '2020-01'}-01T00:00:00.000Z`);\n\tconst tabName = `H|${format(fromDate, `LLL`)}'${format(fromDate, `yy`)}`;\n\tconst hourSummaryTabName = `${tabName}|Summary`;\n\n\treturn (\n\t\t<Wrapper size=\"lg\">\n\t\t\t<h2>Sheets</h2>\n\t\t\t<div\n\t\t\t\tcss={{\n\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\tgridTemplateColumns: '1fr',\n\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t'@media (min-width: 35.625rem)': {\n\t\t\t\t\t\tgridTemplateColumns: 'auto 1fr',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tcss={{\n\t\t\t\t\t\t'@media (min-width: 35.625rem)': {\n\t\t\t\t\t\t\tjustifySelf: 'start',\n\t\t\t\t\t\t},\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<IconButton look=\"add\" as={Link} to=\"/add\">\n\t\t\t\t\t\tAdd new\n\t\t\t\t\t</IconButton>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tlook=\"adjust\"\n\t\t\t\t\t\tas={Link}\n\t\t\t\t\t\tto=\"/output\"\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tmarginLeft: '0.5rem',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\tOutput\n\t\t\t\t\t</IconButton>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tlook=\"import-export\"\n\t\t\t\t\t\tas={Link}\n\t\t\t\t\t\tto=\"/import-export\"\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tmarginLeft: '0.5rem',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\tImport/Export\n\t\t\t\t\t</IconButton>\n\t\t\t\t</div>\n\t\t\t\t<form\n\t\t\t\t\tonSubmit={(event) => sync(event, tabName)}\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tmarginTop: '1rem',\n\t\t\t\t\t\t'@media (min-width: 35.625rem)': {\n\t\t\t\t\t\t\tjustifySelf: 'end',\n\t\t\t\t\t\t\tmarginTop: 0,\n\t\t\t\t\t\t},\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tvalue={date}\n\t\t\t\t\t\tonChange={(event) => setDate(event.target.value)}\n\t\t\t\t\t\tpattern=\"\\d{4}-\\d{2}\"\n\t\t\t\t\t\ttitle=\"Please use the format year(4 numbers)-month(2 numbers). E.g.: 2020-09 or 2023-03\"\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tdisplay: 'inline-block',\n\t\t\t\t\t\t\tapperance: 'none',\n\t\t\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\t\t\tborder: '1px solid var(--text)',\n\t\t\t\t\t\t\twidth: '7em',\n\t\t\t\t\t\t\tpadding: '0.5rem',\n\t\t\t\t\t\t\tlineHeight: 1,\n\t\t\t\t\t\t\tmarginRight: '1rem',\n\t\t\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\t\t\t':invalid': {\n\t\t\t\t\t\t\t\tboxShadow: '0 0 0 3px var(--danger)',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t':focus': {\n\t\t\t\t\t\t\t\toutline: 'none',\n\t\t\t\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t<IconButton look=\"sync\" type=\"submit\" disabled={!selected.length}>\n\t\t\t\t\t\tSync\n\t\t\t\t\t</IconButton>\n\t\t\t\t</form>\n\t\t\t</div>\n\n\t\t\t<button\n\t\t\t\tonClick={selectAll}\n\t\t\t\tcss={{\n\t\t\t\t\tborder: '1px solid var(--text)',\n\t\t\t\t\tborderRadius: '3px',\n\t\t\t\t\tbackground: 'transparent',\n\t\t\t\t\tapperance: 'none',\n\t\t\t\t\tfontSize: '0.75rem',\n\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t\tmargin: '1rem 0 0 0',\n\t\t\t\t\tpadding: '0.25rem',\n\t\t\t\t\t':focus': {\n\t\t\t\t\t\toutline: 'none',\n\t\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tSelect all ({sheets.length})\n\t\t\t</button>\n\n\t\t\t<button\n\t\t\t\tonClick={sortSheets}\n\t\t\t\tcss={{\n\t\t\t\t\tborder: '1px solid var(--text)',\n\t\t\t\t\tborderRadius: '3px',\n\t\t\t\t\tbackground: 'transparent',\n\t\t\t\t\tapperance: 'none',\n\t\t\t\t\tfontSize: '0.75rem',\n\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t\tmargin: '1rem 0 0 0.5rem',\n\t\t\t\t\tpadding: '0.25rem',\n\t\t\t\t\t':focus': {\n\t\t\t\t\t\toutline: 'none',\n\t\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tSort by {sort}\n\t\t\t</button>\n\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder=\"filter\"\n\t\t\t\tvalue={filter}\n\t\t\t\tonChange={filterSheets}\n\t\t\t\tcss={{\n\t\t\t\t\tapperance: 'none',\n\t\t\t\t\tborder: '1px solid var(--text)',\n\t\t\t\t\tfontSize: '0.75rem',\n\t\t\t\t\tmargin: '1rem 0 0 0.5rem',\n\t\t\t\t\tpadding: '0.25rem',\n\t\t\t\t\twidth: '5rem',\n\t\t\t\t\t':focus': {\n\t\t\t\t\t\toutline: 'none',\n\t\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t<ul\n\t\t\t\tcss={{\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\tlistStyle: 'none',\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\tmargin: '1rem 0 0 0',\n\t\t\t\t\t':after': {\n\t\t\t\t\t\tcontent: '\"\"',\n\t\t\t\t\t\tdisplay: loading ? 'block' : 'none',\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: '50%',\n\t\t\t\t\t\tleft: '50%',\n\t\t\t\t\t\tmarginLeft: '-2.5rem',\n\t\t\t\t\t\tmarginTop: '-2.5rem',\n\t\t\t\t\t\twidth: '5rem',\n\t\t\t\t\t\theight: '5rem',\n\t\t\t\t\t\tborder: '0.75rem solid #ccc',\n\t\t\t\t\t\tborderTopColor: 'var(--text)',\n\t\t\t\t\t\tborderRadius: '100%',\n\t\t\t\t\t\tanimation: `${rotation} 0.5s linear infinite`,\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{sheets.map(\n\t\t\t\t\t({ id, name, hProjectName, hClientName, gSheetIDName, output = 1, hourSummary }, i) => (\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\topacity: loading ? 0.2 : 1,\n\t\t\t\t\t\t\t\tmarginTop: '1.5rem',\n\t\t\t\t\t\t\t\tmarginLeft: '-9px',\n\t\t\t\t\t\t\t\t':not(:first-of-type)': {\n\t\t\t\t\t\t\t\t\tborderTop: '2px dashed var(--alt-bg)',\n\t\t\t\t\t\t\t\t\tpaddingTop: '1rem',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'@media (min-width: 40rem)': {\n\t\t\t\t\t\t\t\t\tmarginTop: '0.5rem',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<SheetCard\n\t\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\t\thProjectName={hProjectName}\n\t\t\t\t\t\t\t\thClientName={hClientName}\n\t\t\t\t\t\t\t\ttabName={tabName}\n\t\t\t\t\t\t\t\thourSummaryTabName={hourSummary ? hourSummaryTabName : null}\n\t\t\t\t\t\t\t\tgSheetIDName={gSheetIDName}\n\t\t\t\t\t\t\t\toutput={getOutputByID(output)}\n\t\t\t\t\t\t\t\tselected={selected}\n\t\t\t\t\t\t\t\ttoggle={toggle}\n\t\t\t\t\t\t\t\tdeleteSheet={deleteSheet}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t)}\n\t\t\t</ul>\n\t\t</Wrapper>\n\t);\n}\n","/** @jsx jsx */\n\nimport { Link } from 'react-router-dom';\nimport { jsx } from '@emotion/core';\nimport { useState } from 'react';\n\nimport { getOutput, writeOutput, getSheets, writeSheets } from './storage';\nimport { IconButton } from './primitives/IconButton';\nimport { Wrapper } from './primitives/Wrapper';\nimport { Button } from './primitives/Button';\nimport { Code } from './primitives/Code';\n\nexport function ListOutput() {\n\tconst [output, setOutput] = useState(getOutput());\n\n\tconst deleteOutput = (outputID) => {\n\t\tif (outputID !== 1) {\n\t\t\tconst sheets = getSheets().map(({ output, ...rest }) =>\n\t\t\t\toutput === outputID ? { output: 1, ...rest } : { output, ...rest }\n\t\t\t);\n\t\t\twriteSheets(sheets);\n\n\t\t\tconst newOutput = output.filter(({ id }) => id !== outputID);\n\t\t\twriteOutput(newOutput);\n\t\t\tsetOutput(newOutput);\n\t\t}\n\t};\n\n\treturn (\n\t\t<Wrapper>\n\t\t\t<h2>Output</h2>\n\n\t\t\t<IconButton look=\"add\" as={Link} to=\"/output/add\">\n\t\t\t\tAdd new\n\t\t\t</IconButton>\n\t\t\t<ul\n\t\t\t\tcss={{\n\t\t\t\t\tlistStyle: 'none',\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\tmargin: 0,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{output.map(({ id, name, columns }) => (\n\t\t\t\t\t<li\n\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\t\tgridTemplateColumns: 'auto',\n\t\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\t\tmarginTop: '1.5rem',\n\t\t\t\t\t\t\t':not(:first-of-type)': {\n\t\t\t\t\t\t\t\tborderTop: '2px dashed var(--alt-bg)',\n\t\t\t\t\t\t\t\tpaddingTop: '0.5rem',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'@media (min-width: 40rem)': {\n\t\t\t\t\t\t\t\tmarginTop: '0.5rem',\n\t\t\t\t\t\t\t\tgridTemplateColumns: 'auto 6rem',\n\t\t\t\t\t\t\t\tgap: '0.5rem',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\tto={`/output/${id}`}\n\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\ttextDecoration: 'none',\n\t\t\t\t\t\t\t\t':focus': {\n\t\t\t\t\t\t\t\t\toutline: 'none',\n\t\t\t\t\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<strong\n\t\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{name}\n\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t<Code>{columns.length} columns</Code>\n\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t{id !== 1 ? (\n\t\t\t\t\t\t\t<IconButton confirm type=\"button\" look=\"delete\" onClick={() => deleteOutput(id)}>\n\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t</li>\n\t\t\t\t))}\n\t\t\t</ul>\n\t\t\t<div\n\t\t\t\tcss={{\n\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\tgridTemplateColumns: '1fr 1fr',\n\t\t\t\t\tjustifyItems: 'start',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Button look=\"muted\" to=\"/\" as={Link}>\n\t\t\t\t\tCancel\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</Wrapper>\n\t);\n}\n","/** @jsx jsx */\n\nimport { SortableContainer, SortableElement } from 'react-sortable-hoc';\nimport { Link, useHistory } from 'react-router-dom';\nimport Select, { components } from 'react-select';\nimport { jsx } from '@emotion/core';\nimport { useState } from 'react';\n\nimport { getOutput, writeOutput } from './storage';\nimport { Wrapper } from './primitives/Wrapper';\nimport { Button } from './primitives/Button';\nimport { harvestKeys } from './harvestKeys';\nimport { Input } from './primitives/Input';\n\nfunction arrayMove(array, from, to) {\n\tarray = array.slice();\n\tarray.splice(to < 0 ? array.length + to : to, 0, array.splice(from, 1)[0]);\n\treturn array;\n}\n\nconst SortableMultiValue = SortableElement((props) => {\n\tconst onMouseDown = (event) => {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t};\n\tconst innerProps = { onMouseDown };\n\treturn <components.MultiValue {...props} innerProps={innerProps} />;\n});\n\nconst SortableSelect = SortableContainer(Select);\n\nexport function Output({ match }) {\n\tlet {\n\t\tparams: { itemID },\n\t} = match;\n\titemID = parseInt(itemID);\n\n\tlet storageOutput = getOutput();\n\tlet nameDefault = '';\n\tlet columnsDefault = [];\n\tif (itemID) {\n\t\tconst thisOutput = storageOutput.filter(({ id }) => id === itemID);\n\t\tif (thisOutput.length === 1) {\n\t\t\tnameDefault = thisOutput[0].name;\n\t\t\tcolumnsDefault = thisOutput[0].columns.map((item) => ({\n\t\t\t\tvalue: item,\n\t\t\t\tlabel: harvestKeys[item].name,\n\t\t\t}));\n\t\t}\n\t}\n\tconst [name, setName] = useState(nameDefault);\n\tconst [columns, setColumns] = useState(columnsDefault);\n\tconst history = useHistory();\n\n\tconst onChange = (selectedOptions) => setColumns(selectedOptions);\n\n\tconst onSortEnd = ({ oldIndex, newIndex }) => {\n\t\tconst newValue = arrayMove(columns, oldIndex, newIndex);\n\t\tsetColumns(newValue);\n\t};\n\n\tconst selectableItems = Object.entries(harvestKeys).map(([key, { name }]) => ({\n\t\tvalue: key,\n\t\tlabel: name,\n\t}));\n\n\tconst saveOutput = (event) => {\n\t\tevent.preventDefault();\n\n\t\tif (columns.length > 0) {\n\t\t\tif (itemID) {\n\t\t\t\tstorageOutput = storageOutput.map((output) =>\n\t\t\t\t\toutput.id === itemID\n\t\t\t\t\t\t? { id: output.id, name, columns: columns.map(({ value }) => value) }\n\t\t\t\t\t\t: output\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tstorageOutput.push({\n\t\t\t\t\tid: storageOutput.length ? storageOutput[storageOutput.length - 1].id + 1 : 1,\n\t\t\t\t\tname,\n\t\t\t\t\tcolumns: columns.map(({ value }) => value),\n\t\t\t\t});\n\t\t\t}\n\t\t\twriteOutput(storageOutput);\n\t\t\thistory.push('/output');\n\t\t} else {\n\t\t\t//\n\t\t}\n\t};\n\n\tconst colourStyles = {\n\t\tcontainer: (styles) =>\n\t\t\tcolumns && columns.length ? styles : { ...styles, boxShadow: '0 0 0 3px var(--danger)' },\n\t\tcontrol: (styles) => ({\n\t\t\t...styles,\n\t\t\tborderColor: '#767676',\n\t\t\t':hover': { borderColor: '#767676', ...styles[':hover'] },\n\t\t}),\n\t};\n\n\treturn (\n\t\t<Wrapper size=\"sm\">\n\t\t\t<h2>{itemID ? 'Edit' : 'Add'} Output</h2>\n\n\t\t\t<form\n\t\t\t\tonSubmit={saveOutput}\n\t\t\t\tcss={{\n\t\t\t\t\tmargin: 0,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<ul\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tlistStyle: 'none',\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Input\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tid=\"name\"\n\t\t\t\t\t\tlabel=\"Name\"\n\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\tonChange={(event) => setName(event.target.value)}\n\t\t\t\t\t\tmaxWidth=\"8rem\"\n\t\t\t\t\t/>\n\t\t\t\t\t<li\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tmarginBottom: '0.5rem',\n\t\t\t\t\t\t\t'@media (min-width: 37.5rem)': {\n\t\t\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\t\t\tgridTemplateColumns: '8rem auto',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\thtmlFor=\"columns\"\n\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\tdisplay: 'inline-block',\n\t\t\t\t\t\t\t\tmargin: '1rem 0.5rem 0.5rem 0',\n\t\t\t\t\t\t\t\tfontSize: '1.5rem',\n\t\t\t\t\t\t\t\talignSelf: 'center',\n\t\t\t\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\t\t\t\t'@media (min-width: 37.5rem)': {\n\t\t\t\t\t\t\t\t\tmargin: '0 0.5rem 0 0',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tColumns\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<SortableSelect\n\t\t\t\t\t\t\tinputId=\"columns\"\n\t\t\t\t\t\t\taxis=\"xy\"\n\t\t\t\t\t\t\tonSortEnd={onSortEnd}\n\t\t\t\t\t\t\tdistance={4}\n\t\t\t\t\t\t\t// small fix for https://github.com/clauderic/react-sortable-hoc/pull/352\n\t\t\t\t\t\t\tgetHelperDimensions={({ node }) => node.getBoundingClientRect()}\n\t\t\t\t\t\t\tisMulti\n\t\t\t\t\t\t\toptions={selectableItems}\n\t\t\t\t\t\t\tvalue={columns}\n\t\t\t\t\t\t\tstyles={colourStyles}\n\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\tcomponents={{\n\t\t\t\t\t\t\t\tMultiValue: SortableMultiValue,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tcloseMenuOnSelect={false}\n\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\tzIndex: 3,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\n\t\t\t\t<div\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\tgridTemplateColumns: '1fr 1fr',\n\t\t\t\t\t\tjustifyItems: 'start',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Button look=\"muted\" to=\"/output\" as={Link}>\n\t\t\t\t\t\tCancel\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tjustifySelf: 'end',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{itemID ? 'Edit' : 'Add'} output\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</Wrapper>\n\t);\n}\n","/** @jsx jsx */\n\nimport { Link, useHistory } from 'react-router-dom';\nimport { jsx } from '@emotion/core';\nimport Select from 'react-select';\nimport { useState } from 'react';\n\nimport { getLogin, getSheets, writeSheets, getOutput } from './storage';\nimport { getProjectName, getClientName } from './harvestSync';\nimport { Checkbox } from './primitives/Checkbox';\nimport { Wrapper } from './primitives/Wrapper';\nimport { Button } from './primitives/Button';\nimport { getSheetInfo } from './googleSync';\nimport { Input } from './primitives/Input';\n\nimport hProjectIDImg from './assets/harvest-project-id.png';\nimport hClientIDImg from './assets/harvest-client-id.png';\nimport gSheetIDImg from './assets/spreadsheet-id.png';\n\nexport function Sheet({ match }) {\n\tlet {\n\t\tparams: { sheetID },\n\t} = match;\n\tsheetID = parseInt(sheetID);\n\n\tconst storageOutput = getOutput();\n\tconst outputOptions = storageOutput.map(({ id, name }) => ({\n\t\tlabel: name,\n\t\tvalue: id,\n\t}));\n\n\tlet storageSheets = getSheets();\n\tlet hProjectDefault = '';\n\tlet hProjectNameDefault = '';\n\tlet hClientDefault = '';\n\tlet hClientNameDefault = '';\n\tlet gSheetIDDefault = '';\n\tlet gSheetIDNameDefault = '';\n\tlet nameDefault = '';\n\tlet outputDefault = '';\n\tlet hourSummaryDefault = true;\n\tlet tabDefault = 'project';\n\tif (sheetID) {\n\t\tconst thisSheet = storageSheets.filter(({ id }) => id === sheetID);\n\t\tif (thisSheet.length === 1) {\n\t\t\thProjectDefault = thisSheet[0].hProject;\n\t\t\thProjectNameDefault = thisSheet[0].hProjectName;\n\t\t\thClientDefault = thisSheet[0].hClient;\n\t\t\thClientNameDefault = thisSheet[0].hClientName;\n\t\t\tgSheetIDDefault = thisSheet[0].gSheetID;\n\t\t\tgSheetIDNameDefault = thisSheet[0].gSheetIDName;\n\t\t\tnameDefault = thisSheet[0].name;\n\t\t\toutputDefault = storageOutput\n\t\t\t\t.filter(({ id }) => id === thisSheet[0].output)\n\t\t\t\t.map(({ id, name }) => ({ label: name, value: id }))[0];\n\t\t\thourSummaryDefault = !!thisSheet[0].hourSummary;\n\t\t\tif (hClientDefault) {\n\t\t\t\ttabDefault = 'client';\n\t\t\t}\n\t\t}\n\t}\n\n\tconst [loadingHP, setLoadingHP] = useState(false);\n\tconst [loadingHC, setLoadingHC] = useState(false);\n\tconst [loadingG, setLoadingG] = useState(false);\n\tconst [hProject, setHProject] = useState(hProjectDefault);\n\tconst [hProjectName, setHProjectName] = useState(hProjectNameDefault);\n\tconst [hClient, setHClient] = useState(hClientDefault);\n\tconst [hClientName, setHClientName] = useState(hClientNameDefault);\n\tconst [gSheetID, setGSheetID] = useState(gSheetIDDefault);\n\tconst [gSheetIDName, setGSheetIDName] = useState(gSheetIDNameDefault);\n\tconst [name, setName] = useState(nameDefault);\n\tconst [output, setOutput] = useState(outputDefault);\n\tconst [hourSummary, setHourSummary] = useState(hourSummaryDefault);\n\tconst [tab, setTab] = useState(tabDefault);\n\tconst history = useHistory();\n\n\tconst LOGIN = getLogin();\n\n\tconst getHProjectName = async () => {\n\t\tsetLoadingHP(true);\n\t\tsetHProjectName('');\n\t\ttry {\n\t\t\tconst { name } = await getProjectName(LOGIN, hProject);\n\t\t\tsetHProjectName(name);\n\t\t} catch (error) {\n\t\t\tsetHProjectName('- not found -');\n\t\t}\n\t\tsetLoadingHP(false);\n\t};\n\n\tconst getHClientName = async () => {\n\t\tsetLoadingHC(true);\n\t\tsetHProjectName('');\n\t\ttry {\n\t\t\tconst { name } = await getClientName(LOGIN, hClient);\n\t\t\tsetHClientName(name);\n\t\t} catch (error) {\n\t\t\tsetHClientName('- not found -');\n\t\t}\n\t\tsetLoadingHC(false);\n\t};\n\n\tconst getSheetName = async () => {\n\t\tsetLoadingG(true);\n\t\tsetGSheetIDName('');\n\t\ttry {\n\t\t\tconst {\n\t\t\t\tresult: {\n\t\t\t\t\tproperties: { title },\n\t\t\t\t},\n\t\t\t} = await getSheetInfo(LOGIN, gSheetID);\n\t\t\tsetGSheetIDName(title || '');\n\t\t} catch (error) {\n\t\t\tsetGSheetIDName('- not found -');\n\t\t}\n\t\tsetLoadingG(false);\n\t};\n\n\tconst addSheet = (event) => {\n\t\tevent.preventDefault();\n\n\t\tconst hasHArvestData =\n\t\t\ttab === 'project'\n\t\t\t\t? hProjectName !== '- not found -' && hProjectName !== '' && hProjectName\n\t\t\t\t: hClientName !== '- not found -' && hClientName !== '' && hClientName;\n\n\t\tif (\n\t\t\thasHArvestData &&\n\t\t\tgSheetIDName !== '- not found -' &&\n\t\t\tgSheetIDName !== '' &&\n\t\t\tgSheetIDName &&\n\t\t\toutput\n\t\t) {\n\t\t\tif (sheetID) {\n\t\t\t\tstorageSheets = storageSheets.map((sheet) =>\n\t\t\t\t\tsheet.id === sheetID\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tid: sheet.id,\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\thProject: tab === 'project' ? hProject : '',\n\t\t\t\t\t\t\t\thProjectName: tab === 'project' ? hProjectName : '',\n\t\t\t\t\t\t\t\thClient: tab === 'client' ? hClient : '',\n\t\t\t\t\t\t\t\thClientName: tab === 'client' ? hClientName : '',\n\t\t\t\t\t\t\t\tgSheetID,\n\t\t\t\t\t\t\t\tgSheetIDName,\n\t\t\t\t\t\t\t\toutput: output.value,\n\t\t\t\t\t\t\t\thourSummary,\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: sheet\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tstorageSheets.push({\n\t\t\t\t\tid: storageSheets.length ? storageSheets[storageSheets.length - 1].id + 1 : 1,\n\t\t\t\t\tname,\n\t\t\t\t\thProject: tab === 'project' ? hProject : '',\n\t\t\t\t\thProjectName: tab === 'project' ? hProjectName : '',\n\t\t\t\t\thClient: tab === 'client' ? hClient : '',\n\t\t\t\t\thClientName: tab === 'client' ? hClientName : '',\n\t\t\t\t\tgSheetID,\n\t\t\t\t\tgSheetIDName,\n\t\t\t\t\toutput: output.value,\n\t\t\t\t\thourSummary,\n\t\t\t\t});\n\t\t\t}\n\t\t\twriteSheets(storageSheets);\n\t\t\thistory.push('/');\n\t\t}\n\t};\n\n\tconst colourStyles = {\n\t\tcontainer: (styles) => (output ? styles : { ...styles, boxShadow: '0 0 0 3px var(--danger)' }),\n\t\tcontrol: (styles) => ({\n\t\t\t...styles,\n\t\t\tborderColor: '#767676',\n\t\t\tfontSize: '1.5rem',\n\t\t\tpadding: '0.25rem 0',\n\t\t\t':hover': { borderColor: '#767676', ...styles[':hover'] },\n\t\t}),\n\t};\n\n\tconst possibleTabs = ['project', 'client'];\n\tconst toggleTab = () => {\n\t\tlet index = possibleTabs.indexOf(tab) + 1;\n\t\tif (index > possibleTabs.length - 1) {\n\t\t\tindex = 0;\n\t\t}\n\t\tsetTab(possibleTabs[index]);\n\t};\n\n\treturn (\n\t\t<Wrapper>\n\t\t\t<h2>{sheetID ? 'Edit a' : 'Add a new'} sheet</h2>\n\t\t\t<form\n\t\t\t\tonSubmit={addSheet}\n\t\t\t\tcss={{\n\t\t\t\t\tmargin: 0,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<ul\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tlistStyle: 'none',\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Input\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tid=\"name\"\n\t\t\t\t\t\tlabel=\"Name\"\n\t\t\t\t\t\tvalue={name}\n\t\t\t\t\t\thelp={\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\tThe name of this item\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\tOnly important for you to organise your items\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange={(event) => setName(event.target.value)}\n\t\t\t\t\t/>\n\t\t\t\t\t<li\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tmargin: '1rem 0 0 0',\n\t\t\t\t\t\t\t'@media (min-width: 37.5rem)': {\n\t\t\t\t\t\t\t\tpaddingLeft: '17rem',\n\t\t\t\t\t\t\t\tmargin: '0 0 0.5rem 0',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tonClick={toggleTab}\n\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\t\t\tgridTemplateColumns: '1fr 1fr',\n\t\t\t\t\t\t\t\tapperance: 'none',\n\t\t\t\t\t\t\t\tbackground: 'transparent',\n\t\t\t\t\t\t\t\tborder: '1px solid var(--text)',\n\t\t\t\t\t\t\t\tborderRadius: '6px',\n\t\t\t\t\t\t\t\tfontSize: '1rem',\n\t\t\t\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t\t\t\t\tlineHeight: 1,\n\t\t\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\t\t\t':focus': {\n\t\t\t\t\t\t\t\t\tboxShadow: '0 0 0 2px #fff, 0 0 0 5px var(--focus)',\n\t\t\t\t\t\t\t\t\toutline: 'none',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{possibleTabs.map((thisTab) => (\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tkey={thisTab}\n\t\t\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\t\t\tbackground: thisTab === tab ? 'var(--text)' : 'var(--alt-bg)',\n\t\t\t\t\t\t\t\t\t\tcolor: thisTab === tab ? '#fff' : 'var(--text)',\n\t\t\t\t\t\t\t\t\t\tpadding: '0.5rem',\n\t\t\t\t\t\t\t\t\t\ttransition: 'background 0.3s ease, color 0.3s ease',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tUse {thisTab} ID\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</li>\n\t\t\t\t\t<Input\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tid=\"hProject\"\n\t\t\t\t\t\tlabel=\"Harvest Project ID\"\n\t\t\t\t\t\tvalue={hProject}\n\t\t\t\t\t\tvisible={tab === 'project'}\n\t\t\t\t\t\thelp={\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={hProjectIDImg}\n\t\t\t\t\t\t\t\talt=\"The project ID can be found in the url of the project website in harvest.\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange={(event) => {\n\t\t\t\t\t\t\tsetHProject(event.target.value);\n\t\t\t\t\t\t\tsetHProjectName('');\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonBlur={getHProjectName}\n\t\t\t\t\t/>\n\t\t\t\t\t<Input\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tid=\"hProjectName\"\n\t\t\t\t\t\tlabel=\"Harvest Project Name\"\n\t\t\t\t\t\tvalue={hProjectName}\n\t\t\t\t\t\tdisabled\n\t\t\t\t\t\tloading={loadingHP}\n\t\t\t\t\t\treadOnly\n\t\t\t\t\t\tvisible={tab === 'project'}\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t...(hProjectName === '- not found -' || hProjectName === '' || !hProjectName\n\t\t\t\t\t\t\t\t? { boxShadow: '0 0 0 3px var(--danger)' }\n\t\t\t\t\t\t\t\t: {}),\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t<Input\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tid=\"hClient\"\n\t\t\t\t\t\tlabel=\"Harvest Client ID\"\n\t\t\t\t\t\tvalue={hClient}\n\t\t\t\t\t\tvisible={tab === 'client'}\n\t\t\t\t\t\thelp={\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={hClientIDImg}\n\t\t\t\t\t\t\t\talt=\"The project ID can be found in the url of the project website in harvest.\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange={(event) => {\n\t\t\t\t\t\t\tsetHClient(event.target.value);\n\t\t\t\t\t\t\tsetHClientName('');\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonBlur={getHClientName}\n\t\t\t\t\t/>\n\t\t\t\t\t<Input\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tid=\"hClientName\"\n\t\t\t\t\t\tlabel=\"Harvest Client Name\"\n\t\t\t\t\t\tvalue={hClientName}\n\t\t\t\t\t\tdisabled\n\t\t\t\t\t\tloading={loadingHC}\n\t\t\t\t\t\treadOnly\n\t\t\t\t\t\tvisible={tab === 'client'}\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t...(hClientName === '- not found -' || hClientName === '' || !hClientName\n\t\t\t\t\t\t\t\t? { boxShadow: '0 0 0 3px var(--danger)' }\n\t\t\t\t\t\t\t\t: {}),\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\n\t\t\t\t\t<Input\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tid=\"gSheetID\"\n\t\t\t\t\t\tlabel=\"Spreadsheet ID\"\n\t\t\t\t\t\tvalue={gSheetID}\n\t\t\t\t\t\thelp={\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={gSheetIDImg}\n\t\t\t\t\t\t\t\talt=\"The spreadsheet ID can be found in the url of the google spreadsheet.\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange={(event) => {\n\t\t\t\t\t\t\tsetGSheetID(event.target.value);\n\t\t\t\t\t\t\tsetGSheetIDName('');\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonBlur={getSheetName}\n\t\t\t\t\t/>\n\t\t\t\t\t<Input\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tid=\"gSheetIDName\"\n\t\t\t\t\t\tlabel=\"Sheet Name\"\n\t\t\t\t\t\tvalue={gSheetIDName}\n\t\t\t\t\t\tdisabled\n\t\t\t\t\t\tloading={loadingG}\n\t\t\t\t\t\treadOnly\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t...(gSheetIDName === '- not found -' || gSheetIDName === '' || !gSheetIDName\n\t\t\t\t\t\t\t\t? { boxShadow: '0 0 0 3px var(--danger)' }\n\t\t\t\t\t\t\t\t: {}),\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t\t<li\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tposition: 'relative',\n\t\t\t\t\t\t\tzIndex: 3,\n\t\t\t\t\t\t\tmarginBottom: '0.5rem',\n\t\t\t\t\t\t\t'@media (min-width: 37.5rem)': {\n\t\t\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\t\t\tgridTemplateColumns: '17rem auto',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\thtmlFor=\"output\"\n\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\tdisplay: 'inline-block',\n\t\t\t\t\t\t\t\tmargin: '1rem 0.5rem 0.5rem 0',\n\t\t\t\t\t\t\t\tfontSize: '1.5rem',\n\t\t\t\t\t\t\t\talignSelf: 'center',\n\t\t\t\t\t\t\t\twhiteSpace: 'nowrap',\n\t\t\t\t\t\t\t\t'@media (min-width: 37.5rem)': {\n\t\t\t\t\t\t\t\t\tmargin: '0 0.5rem 0 0',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tOutput\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\tinputId=\"output\"\n\t\t\t\t\t\t\toptions={outputOptions}\n\t\t\t\t\t\t\tvalue={output}\n\t\t\t\t\t\t\tonChange={setOutput}\n\t\t\t\t\t\t\tstyles={colourStyles}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tmarginBottom: '0.5rem',\n\t\t\t\t\t\t\t'@media (min-width: 37.5rem)': {\n\t\t\t\t\t\t\t\tmarginLeft: '16.5rem',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\t\t\tgridTemplateColumns: 'auto 1fr',\n\t\t\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\t\t\tfontSize: '1.5rem',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\t\tid=\"hourSummary\"\n\t\t\t\t\t\t\t\tchecked={hourSummary}\n\t\t\t\t\t\t\t\tonChange={() => setHourSummary(!hourSummary)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\tGenerate summary sheet\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\n\t\t\t\t<div\n\t\t\t\t\tcss={{\n\t\t\t\t\t\tdisplay: 'grid',\n\t\t\t\t\t\tgridTemplateColumns: '1fr 1fr',\n\t\t\t\t\t\tjustifyItems: 'start',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Button look=\"muted\" to=\"/\" as={Link}>\n\t\t\t\t\t\tCancel\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\tloading={loadingHP || loadingHC || loadingG}\n\t\t\t\t\t\tcss={{\n\t\t\t\t\t\t\tjustifySelf: 'end',\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{sheetID ? 'Edit' : 'Add'} sheet\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</Wrapper>\n\t);\n}\n","/** @jsx jsx */\n\nimport { HashRouter as Router, Switch, Route } from 'react-router-dom';\nimport { jsx, Global } from '@emotion/core';\nimport { Fragment, useState } from 'react';\n\nimport { IconButton } from './primitives/IconButton';\nimport { ImportExport } from './ImportExport';\nimport { ListSheets } from './ListSheets';\nimport { version } from '../package.json';\nimport { ListOutput } from './ListOutput';\nimport { getLogin } from './storage';\nimport { Output } from './Output';\nimport { Sheet } from './Sheet';\n\nexport function Home({ handleLogout }) {\n\tconst [colors, setColors] = useState(['rgb(1, 255, 251)', 'rgb(183, 1, 255)']);\n\tconst [index, setIndex] = useState(0);\n\tconst { avatar_url } = getLogin();\n\n\tconst easterEgg = () => {\n\t\tconst colorSets = [\n\t\t\t['rgb(1, 255, 251)', 'rgb(183, 1, 255)'],\n\t\t\t['#f857a6', '#ff5858'],\n\t\t\t['#2BC0E4', '#EAECC6'],\n\t\t\t['#7474BF', '#348AC7'],\n\t\t\t['#A9C9FF', '#FFBBEC'],\n\t\t\t['#3D7EAA', '#FFE47A'],\n\t\t\t['#08AEEA', '#2AF598'],\n\t\t\t['#5f2c82', '#49a09d'],\n\t\t\t['#00DBDE', '#FC00FF'],\n\t\t\t['#FC354C', '#0ABFBC'],\n\t\t\t['#f2709c', '#ff9472'],\n\t\t\t['green', 'red'],\n\t\t\t['red', 'blue'],\n\t\t\t['#888', '#888'],\n\t\t];\n\t\tconst newIndex = index + 1 > colorSets.length - 1 ? 0 : index + 1;\n\t\tsetIndex(newIndex);\n\n\t\tsetColors(colorSets[newIndex]);\n\t};\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<Global\n\t\t\t\tstyles={{\n\t\t\t\t\thtml: {\n\t\t\t\t\t\t'--bg-color1': colors[0],\n\t\t\t\t\t\t'--bg-color2': colors[1],\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<h1\n\t\t\t\tcss={{\n\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t'\"Playfair Display\", \"PT Serif\", Cambria, \"Hoefler Text\", Utopia, \"Liberation Serif\", \"Nimbus Roman No9 L Regular\", Times, \"Times New Roman\", serif',\n\t\t\t\t\tfontStyle: 'italic',\n\t\t\t\t\tfontSize: '10vw',\n\t\t\t\t\tlineHeight: 1,\n\t\t\t\t\tmargin: '1vw 0 3vw 0',\n\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t\tfontWeight: 700,\n\t\t\t\t\ttextShadow: '0 0 1px #000, 0 1.8vw 1.8vw #333',\n\t\t\t\t\tcolor: '#fff',\n\t\t\t\t\t'@media (min-width: 75rem)': {\n\t\t\t\t\t\tfontSize: '7.5rem',\n\t\t\t\t\t\tmargin: '0.75rem 0 2.25rem 0',\n\t\t\t\t\t\ttextShadow: '0 0 1px #000, 0 1.34375rem 1.34375rem #333',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tHarvest 2 Sheet\n\t\t\t</h1>\n\t\t\t<IconButton\n\t\t\t\tlook=\"logout\"\n\t\t\t\tonClick={handleLogout}\n\t\t\t\ticon={avatar_url ? avatar_url : null}\n\t\t\t\tconfirm\n\t\t\t\tcss={{\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\tmargin: '0 auto',\n\t\t\t\t\t'@media (min-width: 41.875rem)': {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\ttop: '1rem',\n\t\t\t\t\t\tright: '1rem',\n\t\t\t\t\t},\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tLogout\n\t\t\t</IconButton>\n\n\t\t\t<Router>\n\t\t\t\t<Switch>\n\t\t\t\t\t<Route exact path=\"/\" component={ListSheets} />\n\t\t\t\t\t<Route exact path=\"/add\" component={Sheet} />\n\t\t\t\t\t<Route exact path=\"/edit/:sheetID\" component={Sheet} />\n\t\t\t\t\t<Route exact path=\"/output\" component={ListOutput} />\n\t\t\t\t\t<Route exact path=\"/output/add\" component={Output} />\n\t\t\t\t\t<Route exact path=\"/output/:itemID\" component={Output} />\n\t\t\t\t\t<Route exact path=\"/import-export\" component={ImportExport} />\n\t\t\t\t</Switch>\n\t\t\t</Router>\n\t\t\t<div\n\t\t\t\tcss={{\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\tpadding: '1rem',\n\t\t\t\t\ttextAlign: 'right',\n\t\t\t\t\tcolor: '#fff',\n\t\t\t\t\tfontSize: '0.5rem',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<span onClick={easterEgg}>v{version}</span>\n\t\t\t</div>\n\t\t</Fragment>\n\t);\n}\n","/** @jsx jsx */\n\nimport { jsx } from '@emotion/core';\nimport { useState } from 'react';\n\nimport { getLogin, writeLogin } from './storage';\nimport { harvestLogin } from './harvestSync';\nimport { googleLogin } from './googleSync';\nimport { LoginForm } from './LoginForm';\nimport { Home } from './Home';\n\nimport harvestAccess from './assets/harvest-access.png';\nimport harvestAccessTokenID from './assets/harvest-token-id.png';\n\nexport function App() {\n\tconst [login, setLogin] = useState(getLogin());\n\tconst [loading, setLoading] = useState(false);\n\tconst [error, setError] = useState('');\n\n\tconst [hToken, setHToken] = useState('');\n\tconst [hID, setHID] = useState('');\n\tconst [gAPIKey, setGAPIKey] = useState('');\n\n\tconst handleLogin = async (event) => {\n\t\tevent.preventDefault();\n\t\tsetLoading(true);\n\n\t\tif (hToken && hID && gAPIKey) {\n\t\t\tconst login = {\n\t\t\t\tHARVEST_ACCESS_TOKEN: hToken,\n\t\t\t\tHARVEST_ACCOUNT_ID: hID,\n\t\t\t\tGOOGLE_API_KEY: gAPIKey,\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tconst { avatar_url } = await harvestLogin(login);\n\t\t\t\tawait googleLogin(login);\n\n\t\t\t\twriteLogin({ avatar_url, ...login });\n\t\t\t\tsetLogin(login);\n\t\t\t\tsetLoading(false);\n\t\t\t} catch (error) {\n\t\t\t\tif (typeof error === 'object') {\n\t\t\t\t\tsetError(`Can't login. Check that you allow popups in the browser.`);\n\t\t\t\t} else {\n\t\t\t\t\tsetError(error.toString());\n\t\t\t\t}\n\t\t\t\tsetLoading(false);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst handleLogout = () => {\n\t\twriteLogin({});\n\t\tsetLogin({});\n\t};\n\n\tconst hasLogin = login\n\t\t? !!login.HARVEST_ACCESS_TOKEN || !!login.HARVEST_ACCOUNT_ID || !!login.GOOGLE_API_KEY\n\t\t: false;\n\n\tconst HTokenHelp = () => (\n\t\t<div>\n\t\t\tLog into <strong>https://id.getharvest.com/developers</strong>\n\t\t\t<br />\n\t\t\tand create a Personal Access Tokens\n\t\t\t<br />\n\t\t\t<img src={harvestAccess} alt=\"\" css={{ width: '30rem !important' }} />\n\t\t\t<br />\n\t\t\tCopy the \"Your Token\" and paste it here\n\t\t\t<br />\n\t\t\t<img src={harvestAccessTokenID} alt=\"\" css={{ width: '30rem !important' }} />\n\t\t</div>\n\t);\n\n\treturn (\n\t\t<main\n\t\t\tcss={{\n\t\t\t\ttextRendering: 'optimizeLegibility',\n\t\t\t\tfontKerning: 'auto',\n\t\t\t\tMozOsxFontSmoothing: 'grayscale',\n\t\t\t}}\n\t\t>\n\t\t\t{!hasLogin ? (\n\t\t\t\t<LoginForm\n\t\t\t\t\thandleLogin={handleLogin}\n\t\t\t\t\tloading={loading}\n\t\t\t\t\terror={error}\n\t\t\t\t\tinputLines={[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'hToken',\n\t\t\t\t\t\t\tlabel: 'Harvest access token',\n\t\t\t\t\t\t\tvalue: hToken,\n\t\t\t\t\t\t\tsetValue: setHToken,\n\t\t\t\t\t\t\thelp: <HTokenHelp />,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'hID',\n\t\t\t\t\t\t\tlabel: 'Harvest account ID',\n\t\t\t\t\t\t\tvalue: hID,\n\t\t\t\t\t\t\tsetValue: setHID,\n\t\t\t\t\t\t\thelp: <HTokenHelp />,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'gAPIKey',\n\t\t\t\t\t\t\tlabel: 'Google API key',\n\t\t\t\t\t\t\tvalue: gAPIKey,\n\t\t\t\t\t\t\tsetValue: setGAPIKey,\n\t\t\t\t\t\t\thelp: 'Ask Dom for it',\n\t\t\t\t\t\t},\n\t\t\t\t\t]}\n\t\t\t\t/>\n\t\t\t) : (\n\t\t\t\t<Home handleLogout={handleLogout} />\n\t\t\t)}\n\t\t</main>\n\t);\n}\n","import * as serviceWorker from './serviceWorker';\nimport { Global } from '@emotion/core';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\nimport React from 'react';\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<Global\n\t\t\tstyles={{\n\t\t\t\thtml: {\n\t\t\t\t\t'--bg-color1': 'rgb(1, 255, 251)',\n\t\t\t\t\t'--bg-color2': 'rgb(183, 1, 255)',\n\t\t\t\t\t'--alt-bg': '#eee',\n\t\t\t\t\t'--text': '#383E48',\n\t\t\t\t\t'--info': '#005fcc',\n\t\t\t\t\t'--confirm': '#008800',\n\t\t\t\t\t'--danger': '#ee0000',\n\t\t\t\t\t'--focus': '#005fcc',\n\t\t\t\t\tbackground:\n\t\t\t\t\t\t'rgb(183, 1, 255) -webkit-radial-gradient(left bottom, var(--bg-color1), var(--bg-color2)) repeat fixed 0% 0%',\n\t\t\t\t\theight: '100%',\n\t\t\t\t},\n\t\t\t\tbody: {\n\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t'system-ui,-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,\"Noto Sans\",sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",\"Noto Color Emoji\"',\n\t\t\t\t\tlineHeight: 1.2,\n\t\t\t\t\tmargin: 0,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\tcolor: 'var(--text)',\n\t\t\t\t},\n\t\t\t\ta: {\n\t\t\t\t\tcolor: 'var(--text)',\n\t\t\t\t},\n\t\t\t\t'*, *:before, *:after': {\n\t\t\t\t\tboxSizing: 'border-box',\n\t\t\t\t},\n\t\t\t}}\n\t\t/>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}