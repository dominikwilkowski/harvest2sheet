(this.webpackJsonpharvest2sheet=this.webpackJsonpharvest2sheet||[]).push([[0],{34:function(e,t,r){e.exports=r(45)},45:function(e,t,r){"use strict";r.r(t);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var n=r(1),a=r(29),o=r.n(a),i=r(3),c=r.n(i),s=r(8),u=r(5),l=r(0),d=r.n(l),b=r(32),p=r(17),m=r(31),f=r(30),h=r(14),g={date:{name:"Date",value:function(e){return e.spent_date}},hours:{name:"Hours",value:function(e){return e.hours}},rounded_hours:{name:"Rounded Hours",value:function(e){return e.rounded_hours}},notes:{name:"Notes",value:function(e){return e.notes}},locked:{name:"Locked",value:function(e){return e.is_locked?"Yes":"No"}},locked_reason:{name:"Locked Reason",value:function(e){return e.locked_reason}},closed:{name:"Closed",value:function(e){return e.is_closed?"Yes":"No"}},billed:{name:"Billed",value:function(e){return e.is_billed?"Yes":"No"}},timer_started_at:{name:"Timer Started At",value:function(e){return e.timer_started_at}},started_time:{name:"Started Timer",value:function(e){return e.started_time}},ended_time:{name:"Ended Timer",value:function(e){return e.ended_time}},running:{name:"Running",value:function(e){return e.is_running?"Yes":"No"}},billable:{name:"Billable",value:function(e){return e.billable}},budgeted:{name:"Budgeted",value:function(e){return e.budgeted}},billable_rate:{name:"Billable Rate",value:function(e){return e.billable_rate}},billable_amount:{name:"Billable Amount",value:function(e){return e.rounded_hours*e.billable_rate}},cost_rate:{name:"Cost Rate",value:function(e){return e.cost_rate}},cost_amount:{name:"Cost Amount",value:function(e){return e.rounded_hours*e.cost_rate}},created_at:{name:"Created At",value:function(e){return Object(h.a)(Object(p.a)(e.created_at),"yyyy-MM-dd")}},updated_at:{name:"Updated At",value:function(e){return e.updated_at}},user:{name:"User",value:function(e){return e.user.name}},client:{name:"Client",value:function(e){return e.client.name}},currency:{name:"Currency",value:function(e){return e.client.currency}},project:{name:"Project",value:function(e){return e.project.name}},project_code:{name:"Project Code",value:function(e){return e.project.code}},task:{name:"Task",value:function(e){return e.task.name}}};function v(e){return O.apply(this,arguments)}function O(){return(O=Object(s.a)(c.a.mark((function e(t){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.harvestapp.com/v2/users/me",{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 3:return r=e.sent,e.next=6,r.json();case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),new Error("Harvest login failed. Please check your credentials.");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function j(e,t){return x.apply(this,arguments)}function x(){return(x=Object(s.a)(c.a.mark((function e(t,r){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.harvestapp.com/v2/projects/".concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Harvest sync failed. Please check your credentials.");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function S(e,t,r){return w.apply(this,arguments)}function w(){return(w=Object(s.a)(c.a.mark((function e(t,r,n){var a,o,i,s,u,l,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],o=Object(p.a)("".concat(n,"-01T00:00:00.000Z")),Object(f.a)(o)&&"Invalid Date"!==o.toString()){e.next=5;break}return console.error("The date passed in is not valid"),e.abrupt("return");case 5:return i=Object(m.a)(Object(b.a)(o)),u=[(s=["date","user","client","project","task","hours","rounded_hours","notes","billable_rate","billable_amount","cost_rate","cost_amount","currency"]).map((function(e){return g[e]?g[e].name:"unknown"}))],e.prev=8,e.next=11,fetch("https://api.harvestapp.com/v2/time_entries?from=".concat(Object(h.a)(o,"yyyyMMdd"),"&to=").concat(Object(h.a)(i,"yyyyMMdd"),"&project_id=").concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 11:return l=e.sent,e.next=14,l.json();case 14:d=e.sent,d.time_entries.reverse().forEach((function(e){u.push(s.map((function(t){return g[t]?g[t].value(e):""})))})),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(8),a.push(e.t0);case 22:return e.abrupt("return",{csv:u,errors:a.length?a.join("\n"):null});case 23:case"end":return e.stop()}}),e,null,[[8,19]])})))).apply(this,arguments)}function y(e,t){return k.apply(this,arguments)}function k(){return(k=Object(s.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t,resource:{requests:[{addSheet:{properties:{title:r,tabColor:{red:155,green:155,blue:155}}}}]}});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function _(e,t){return C.apply(this,arguments)}function C(){return(C=Object(s.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.gapi.client.sheets.spreadsheets.values.clear({spreadsheetId:t,range:"".concat(r,"!A1:ZZZ9999")});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,r){return T.apply(this,arguments)}function T(){return(T=Object(s.a)(c.a.mark((function e(t,r,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.gapi.client.sheets.spreadsheets.values.append({spreadsheetId:t,range:r,valueInputOption:"RAW",insertDataOption:"OVERWRITE",resource:{values:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return window.gapi.client?Promise.resolve():new Promise(function(){var r=Object(s.a)(c.a.mark((function r(n,a){return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t>2&&a("Google login failed. Check you credentials."),r.prev=1,r.next=4,window.gapi.load("client:auth2",function(){var r=Object(s.a)(c.a.mark((function r(o){return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,window.gapi.client.init({apiKey:e.GOOGLE_API_KEY,clientId:e.GOOGLE_CLIENT_ID,discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"],scope:"https://www.googleapis.com/auth/spreadsheets"});case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),a("Google login failed. Check you credentials.");case 8:if(!window.gapi.auth2.getAuthInstance().isSignedIn.get()){r.next=13;break}n(),r.next=24;break;case 13:return r.prev=13,r.next=16,window.gapi.auth2.getAuthInstance().signIn();case 16:return r.next=18,E(e,t+1);case 18:n(),r.next=24;break;case 21:r.prev=21,r.t1=r.catch(13),a(r.t1);case 24:case"end":return r.stop()}}),r,null,[[0,5],[13,21]])})));return function(e){return r.apply(this,arguments)}}());case 4:r.next=9;break;case 6:r.prev=6,r.t0=r.catch(1),a(r.t0);case 9:case"end":return r.stop()}}),r,null,[[1,6]])})));return function(e,t){return r.apply(this,arguments)}}())}function N(e,t){return A.apply(this,arguments)}function A(){return(A=Object(s.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t);case 2:return e.next=4,window.gapi.client.sheets.spreadsheets.get({spreadsheetId:r});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,r,n,a){return R.apply(this,arguments)}function R(){return(R=Object(s.a)(c.a.mark((function e(t,r,n,a,o){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(t);case 2:return e.next=4,y(r,o);case 4:return e.next=6,_(r,o);case 6:return e.next=8,I(r,o,a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){var t=e.children,r=e.size,a=void 0===r?"md":r;return Object(n.b)("div",{css:{maxWidth:{sm:"30rem",md:"60rem",lg:"93.75rem"}[a],background:"#fff",margin:"1rem auto",padding:"2rem 1rem",boxShadow:"0 0 1rem 0.25rem rgba(0, 0, 0, 0.4)",overflow:"hidden","@media (min-width: 37.5rem)":{padding:"2rem"}}},t)}var H=r(15),P=r(18);function z(e){var t=e.children,r=e.loading,a=e.look,o=void 0===a?"default":a,i=e.as,c=void 0===i?"button":i,s=Object(P.a)(e,["children","loading","look","as"]),u={default:{background:"#008800",color:"#fff",":hover":s.disabled?{}:{boxShadow:"0 0 0 2px white, 0 0 0 3px #008800"}},muted:{border:"1px solid #767676",":hover":s.disabled?{}:{boxShadow:"0 0 0 2px white, 0 0 0 3px #767676"}}},l=Object(n.c)({to:{transform:"rotate( 360deg )"}});return Object(n.b)(c,Object.assign({disabled:!!r,css:Object(H.a)({position:"relative",display:"inline-block",border:"none",borderRadius:"1px",apperance:"none",fontSize:"1rem",cursor:"pointer",lineHeight:1,padding:"1rem 1.5rem",margin:"1rem 0 0 0",textDecoration:"none",":after":{content:'""',display:r?"block":"none",position:"absolute",top:"12px",left:"50%",marginLeft:"-0.75rem",width:"1.5rem",height:"1.5rem",border:"3px solid #aaa",borderTopColor:"#000",borderRadius:"100%",animation:"".concat(l," 0.6s linear infinite")},":disabled":{opacity:.4}},u[o]?u[o]:{})},s),t)}function G(e){var t=e.id,r=e.label,a=e.loading,o=void 0!==a&&a,i=Object(P.a)(e,["id","label","loading"]),c=Object(n.c)({to:{transform:"rotate( 360deg )"}});return Object(n.b)("li",{css:{marginBottom:"0.5rem","@media (min-width: 37.5rem)":{display:"grid",gridTemplateColumns:"16rem auto"}}},Object(n.b)("label",{htmlFor:t,css:{display:"block",margin:"1rem 0 0.5rem 0",fontSize:"1.5rem",alignSelf:"center",whiteSpace:"nowrap","@media (min-width: 37.5rem)":{display:"inline-block",margin:"0 0.5rem 0 0"}}},r),Object(n.b)("span",{css:{position:"relative",":after":{content:'""',display:o?"block":"none",position:"absolute",top:"10px",left:"50%",marginLeft:"-0.75rem",width:"1.5rem",height:"1.5rem",border:"3px solid #aaa",borderTopColor:"#000",borderRadius:"100%",animation:"".concat(c," 0.6s linear infinite")}}},Object(n.b)("input",Object.assign({id:t,type:"text",css:{fontSize:"1.5rem",padding:"0.5rem",margin:0,border:"1px solid #767676",borderRadius:"0.2rem",apperance:"none",width:"100%",color:"#383E48",":focus":{boxShadow:"0 0 0 3px #006cff",borderColor:"#006cff",outline:"none"},":disabled":{background:"#eee"}}},i))))}function B(e){var t=e.handleLogin,r=e.inputLines,a=e.loading,o=e.error,i=Object(n.c)({to:{transform:"rotate( 360deg )"}});return Object(n.b)(l.Fragment,null,Object(n.b)("h1",{css:{fontFamily:'"Playfair Display", "PT Serif", Cambria, "Hoefler Text", Utopia, "Liberation Serif", "Nimbus Roman No9 L Regular", Times, "Times New Roman", serif',fontStyle:"italic",fontSize:"20vw",margin:"0 0 5vw 0",textAlign:"center",fontWeight:700,textShadow:"0 1.8vw 1.8vw #333",color:"#fff","@media (min-width: 125rem)":{fontSize:"25rem",marginBottom:"6.25rem",textShadow:"0 2.25rem 2.25rem #333"}}},"Login"),Object(n.b)(L,null,Object(n.b)("form",{onSubmit:t,css:{position:"relative",margin:0,padding:0,":after":{content:'""',display:a?"block":"none",position:"absolute",top:"50%",left:"50%",marginLeft:"-2.5rem",marginTop:"-2.5rem",width:"5rem",height:"5rem",border:"0.75rem solid #aaa",borderTopColor:"#383E48",borderRadius:"100%",animation:"".concat(i," 0.5s linear infinite")}}},Object(n.b)("ul",{css:{listStyle:"none",padding:0,margin:0,opacity:a?.4:1}},r.map((function(e){var t=e.id,r=e.label,o=e.value,i=e.setValue;return Object(n.b)(G,{required:!0,key:t,id:t,label:r,value:o,disabled:a,onChange:function(e){return i(e.target.value)}})}))),Object(n.b)(z,{type:"submit",disabled:a,css:{float:"right"}},"Save login"),o&&Object(n.b)("span",{css:{display:"inline-block",marginTop:"1rem",color:"red"}},o))))}var U=r(13),V=r(6);function F(e){var t=e.children,r=e.confirm,a=e.onClick,o=e.look,i=void 0===o?"add":o,c=e.as,s=void 0===c?"button":c,d=Object(P.a)(e,["children","confirm","onClick","look","as"]),b=Object(l.useState)(!1),p=Object(u.a)(b,2),m=p[0],f=p[1],h=Object(l.useState)(!1),g=Object(u.a)(h,2),v=g[0],O=g[1],j=Object(l.useState)([]),x=Object(u.a)(j,2),S=x[0],w=x[1],y=Object(n.c)({"0%":{transform:"scale(0.6)",opacity:0},"33%":{transform:"scale(1)",opacity:1},"100%":{transform:"scale(1.4)",opacity:0}}),k=Object(n.c)({"0%":{boxShadow:"0 0 0 3px rgba(255, 255, 255, 0.2)",opacity:0},"33%":{boxShadow:"0 0 0 10px rgba(255, 255, 255, 0.2)",opacity:1},"100%":{boxShadow:"0 0 0 16px rgba(255, 255, 255, 0.2)",opacity:0}}),_={adjust:{":before":{content:'""',position:"absolute",top:"50%",left:"1rem",width:"0.75rem",height:"1rem",marginTop:"-0.5rem",background:"#383E48",borderRadius:"3px 3px 0 0",transition:"background 0.2s ease"},":after":{content:'""',position:"absolute",top:"50%",left:"1.075rem",width:"0.6rem",height:"0.6rem",marginTop:"0.2rem",background:"#eee",transform:"rotate(45deg)",transition:"background 0.2s ease"},":hover":{background:"#005FCC",color:"#fff"},":hover:before":{background:"#fff"},":hover:after":{background:"#005FCC"}},logout:{padding:"0.5rem 1rem",background:"#fff",":hover":{background:"#ee0000",color:"#fff"}},sync:{background:d.disabled?"#eee":"#008800",color:d.disabled?"#383E48":"#fff",cursor:d.disabled?"not-allowed":"pointer",":before":{content:'""',position:"absolute",top:"50%",left:"0.5rem",width:"1.5rem",height:"1.5rem",marginTop:"-0.75rem",background:"rgba(255,255,255, 0.2)",borderRadius:"50px",opacity:0,animation:d.disabled?"none":"".concat(y," 3s 2s infinite linear")},":after":{content:'""',position:"absolute",top:"50%",left:"1rem",width:"4px",height:"4px",marginTop:"-2px",marginLeft:"2px",background:d.disabled?"#383E48":"#fff",borderRadius:"50%",boxShadow:"0 0 0 1px rgba(255, 255, 255, 0.2)",animation:d.disabled?"none":"".concat(k," 3s infinite linear")}},add:{":before, :after":{content:'""',position:"absolute",width:"1rem",height:"0.25rem",background:"#383E48",borderRadius:"2px",top:"50%",marginTop:"-0.125rem",left:"1rem",transition:"background 0.2s ease"},":after":{transform:"rotate(-90deg)"},":hover":{background:"#005FCC",color:"#fff"},":hover:before, :hover:after":{background:"#fff"}},delete:{":before, :after":{content:'""',position:"absolute",width:"1rem",height:"0.25rem",background:"#383E48",borderRadius:"2px",transform:"rotate(45deg)",top:"50%",marginTop:"-0.125rem",left:"1rem",transition:"background 0.2s ease"},":after":{transform:"rotate(-45deg)"},":hover":{background:"#ee0000",color:"#fff"},":hover:before, :hover:after":{background:"#fff"}},edit:{":before":{content:'""',position:"absolute",top:"50%",marginTop:"-0.5rem",left:"1rem",width:"0.9rem",height:"1rem",border:"2px solid #383E48",transition:"border 0.2s ease"},":after":{content:'""',position:"absolute",top:"2px",left:"1.65rem",background:"#383E48",width:"4px",height:"1rem",transform:"rotate(45deg)",borderRadius:"1px 1px 50% 50%",boxShadow:"0 0 0 2px #eee",transition:"background 0.2s ease, box-shadow 0.2s ease"},":hover":{background:"#008800",color:"#fff"},":hover:before":{borderColor:"#fff"},":hover:after":{background:"#fff",boxShadow:"0 0 0 2px #008800"}}};return Object(n.b)(s,Object.assign({css:Object(H.a)({position:"relative",display:"inline-block",apperance:"none",background:"#eee",color:"#383E48",border:"none",padding:"0.5rem 1rem 0.5rem 2.5rem",fontSize:"0.75rem",textDecoration:"none",textAlign:"center",lineHeight:1,borderRadius:"3px",transition:"background 0.2s ease, color 0.2s ease",overflow:"hidden",cursor:"pointer"},_[i]?_[i]:{}),onClick:function(e){clearTimeout(S),w([]),r&&!m?(e.preventDefault(),O(!0),w(setTimeout((function(){f(!1),O(!1),w([])}),3e3))):("function"==typeof a&&a(),O(!1)),f(!m)}},d),v?"Sure?":t)}var K=r(25);function M(e){return Object(n.b)("span",Object.assign({css:{display:"inline-block",background:"#eee",border:"1px solid #ccc",padding:"0 0.25rem",borderRadius:"3px",margin:"0.25rem 0.25rem 0 0",fontSize:"0.75rem"}},e))}function J(e){var t=e.id,r=e.name,a=e.hProjectName,o=e.tabName,i=e.gSheetIDName,c=e.selected,s=e.toggle,u=e.deleteSheet;return Object(n.b)("div",{css:{display:"grid",gridTemplateColumns:"3rem auto",gap:"0.5rem",alignItems:"center","@media (min-width: 40rem)":{gridTemplateColumns:"3rem auto 12rem"}}},Object(n.b)("label",{css:{position:"relative",overflow:"hidden",display:"block",width:"3rem",height:"3rem",cursor:"pointer"}},Object(n.b)("input",{id:t,type:"checkbox",checked:c.includes(t),onChange:function(){return s(t)},css:{position:"absolute",top:"-5rem",left:"-5rem"}}),Object(n.b)("span",{css:{display:"block",width:"2rem",height:"2rem",margin:"0.5rem",border:"4px solid #000",borderRadius:"3px",":before":{content:'""',display:"none",position:"absolute",top:"0.5rem",right:"0.5rem",width:"1.5rem",height:"0.8rem",borderBottom:"4px solid #000",borderLeft:"4px solid #000",transform:"rotate(-45deg)",zIndex:2},":after":{content:'""',display:"none",position:"absolute",top:"0",right:"0",width:"1.3rem",height:"1.3rem",background:"#fff",zIndex:1},"input:checked + &:before,input:checked + &:after":{display:"block"}}})),Object(n.b)("label",{htmlFor:t,css:{display:"block",cursor:"pointer"}},Object(n.b)("strong",{css:{display:"block"}},r),Object(n.b)(M,null,a),Object(n.b)(M,null,i),Object(n.b)(M,null,o)),Object(n.b)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",alignItems:"center",gridColumn:"1 / 3","@media (min-width: 40rem)":{gridTemplateColumns:"1fr 1fr",gridColumn:"unset"}}},Object(n.b)(F,{look:"edit",as:U.b,to:"/edit/".concat(t)},"Edit"),Object(n.b)(F,{confirm:!0,type:"button",look:"delete",onClick:function(){return u(t)}},"Delete")))}function q(){var e=JSON.parse(localStorage.getItem("harvest2sheetLogin")||"{}"),t=Object(l.useState)(JSON.parse(localStorage.getItem("harvest2sheetSheets")||"[]")),r=Object(u.a)(t,2),a=r[0],o=r[1],i=Object(l.useState)(Object(h.a)(new Date,"yyyy-MM")),d=Object(u.a)(i,2),b=d[0],m=d[1],f=Object(l.useState)(!1),g=Object(u.a)(f,2),v=g[0],O=g[1],j=Object(l.useState)([]),x=Object(u.a)(j,2),w=x[0],y=x[1],k=function(e){var t=a.filter((function(t){return t.id!==e}));localStorage.setItem("harvest2sheetSheets",JSON.stringify(t)),o(t)},_=function(e){if(w.includes(e)){var t=Object(K.a)(w).filter((function(t){return t!==e}));y(t)}else{var r=Object(K.a)(w);r.push(e),y(r)}},C=function(){var t=Object(s.a)(c.a.mark((function t(r,n){var o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),O(!0),o=a.filter((function(e){var t=e.id;return w.includes(t)})),t.next=5,Promise.all(o.map(function(){var t=Object(s.a)(c.a.mark((function t(r){var a,o,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.hProject,o=r.gSheetID,t.prev=1,t.next=4,S(e,a,b);case 4:return i=t.sent,t.next=7,D(e,o,b,i.csv,n);case 7:y([]),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.error(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}()));case 5:O(!1);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),I=Object(n.c)({to:{transform:"rotate( 360deg )"}}),T=Object(p.a)("".concat(7===b.length?b:"2020-01","-01T00:00:00.000Z")),E="H|".concat(Object(h.a)(T,"LLL"),"'").concat(Object(h.a)(T,"yy"));return Object(n.b)(L,{size:"lg"},Object(n.b)("h2",null,"Sheets"),Object(n.b)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",alignItems:"baseline"}},Object(n.b)("div",{css:{justifySelf:"start"}},Object(n.b)(F,{look:"add",as:U.b,to:"/add"},"Add new"),Object(n.b)(F,{look:"adjust",as:U.b,to:"/output",css:{marginLeft:"0.5rem"}},"Output")),Object(n.b)("form",{onSubmit:function(e){return C(e,E)},css:{justifySelf:"end"}},Object(n.b)("input",{type:"text",value:b,onChange:function(e){return m(e.target.value)},pattern:"\\d{4}-\\d{2}",title:"Please use the format year(4 numbers)-month(2 numbers). E.g.: 2020-09 or 2023-03",css:{display:"inline-block",apperance:"none",background:"#fff",border:"1px solid #383E48",width:"7em",padding:"0.5rem",lineHeight:1,marginRight:"1rem",textAlign:"center",":invalid":{boxShadow:"0 0 0 3px #ee0000"}}}),Object(n.b)(F,{look:"sync",type:"submit",disabled:!w.length},"Sync"))),Object(n.b)("ul",{css:{position:"relative",listStyle:"none",padding:0,margin:0,":after":{content:'""',display:v?"block":"none",position:"absolute",top:"50%",left:"50%",marginLeft:"-2.5rem",marginTop:"-2.5rem",width:"5rem",height:"5rem",border:"0.75rem solid #aaa",borderTopColor:"#383E48",borderRadius:"100%",animation:"".concat(I," 0.5s linear infinite")}}},a.map((function(e,t){var r=e.id,a=e.name,o=e.hProjectName,i=e.gSheetIDName;return Object(n.b)("li",{key:r,css:{opacity:v?.2:1,marginTop:"1.5rem",":not(:first-of-type)":{borderTop:"2px dashed #eee",paddingTop:"0.5rem"},"@media (min-width: 40rem)":{marginTop:"0.5rem"}}},Object(n.b)(J,{id:r,name:a,hProjectName:o,tabName:E,gSheetIDName:i,selected:w,toggle:_,deleteSheet:k}))}))))}function W(){return Object(n.b)(L,null,Object(n.b)("h2",null,"Output"),Object(n.b)(z,{look:"muted",to:"/",as:U.b},"Cancel"))}function Y(e){var t=e.match.params.sheetID;t=parseInt(t);var r=JSON.parse(localStorage.getItem("harvest2sheetSheets")||"[]"),a="",o="",i="",d="",b="";if(t){var p=r.filter((function(e){return e.id===t}));1===p.length&&(a=p[0].hProject,o=p[0].hProjectName,i=p[0].gSheetID,d=p[0].gSheetIDName,b=p[0].name)}var m=Object(l.useState)(!1),f=Object(u.a)(m,2),h=f[0],g=f[1],v=Object(l.useState)(a),O=Object(u.a)(v,2),x=O[0],S=O[1],w=Object(l.useState)(o),y=Object(u.a)(w,2),k=y[0],_=y[1],C=Object(l.useState)(i),I=Object(u.a)(C,2),T=I[0],E=I[1],A=Object(l.useState)(d),D=Object(u.a)(A,2),R=D[0],P=D[1],B=Object(l.useState)(b),F=Object(u.a)(B,2),K=F[0],M=F[1],J=Object(V.f)(),q=JSON.parse(localStorage.getItem("harvest2sheetLogin")||"{}"),W=function(){var e=Object(s.a)(c.a.mark((function e(){var t,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),_(""),e.prev=2,e.next=5,j(q,x);case 5:t=e.sent,r=t.name,_(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),_("- not found -");case 13:g(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(s.a)(c.a.mark((function e(){var t,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),P(""),e.prev=2,e.next=5,N(q,T);case 5:t=e.sent,r=t.result.properties.title,P(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),P("- not found -");case 13:g(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();return Object(n.b)(L,null,Object(n.b)("h2",null,t?"Edit a":"Add a new"," sheet"),Object(n.b)("form",{onSubmit:function(e){e.preventDefault(),"- not found -"!==k&&""!==k&&"- not found -"!==R&&""!==R&&(t?r=r.map((function(e){return e.id===t?{id:e.id,name:K,hProject:x,hProjectName:k,gSheetID:T,gSheetIDName:R}:e})):r.push({id:r.length?r[r.length-1].id+1:1,name:K,hProject:x,hProjectName:k,gSheetID:T,gSheetIDName:R}),localStorage.setItem("harvest2sheetSheets",JSON.stringify(r)),J.push("/"))},css:{margin:0,padding:0}},Object(n.b)("ul",{css:{listStyle:"none",padding:0,margin:0}},Object(n.b)(G,{required:!0,id:"name",label:"Sheet name",value:K,onChange:function(e){return M(e.target.value)}}),Object(n.b)(G,{required:!0,id:"hProject",label:"Harvest Project ID",value:x,onChange:function(e){S(e.target.value),_("")},onBlur:W}),Object(n.b)(G,{required:!0,id:"hProjectName",label:"Harvest Project Name",value:k,disabled:!0,loading:h,readOnly:!0,css:Object(H.a)({},"- not found -"===k?{boxShadow:"0 0 0 3px red"}:{})}),Object(n.b)(G,{required:!0,id:"gSheetID",label:"Spreadsheet ID",value:T,onChange:function(e){E(e.target.value),P("")},onBlur:Y}),Object(n.b)(G,{required:!0,id:"gSheetIDName",label:"Sheet Name",value:R,disabled:!0,loading:h,readOnly:!0,css:Object(H.a)({},"- not found -"===R?{boxShadow:"0 0 0 3px red"}:{})})),Object(n.b)(z,{look:"muted",to:"/",as:U.b},"Cancel"),Object(n.b)(z,{type:"submit",loading:h,css:{float:"right"}},t?"Edit":"Add"," sheet")))}function Z(e){var t=e.handleLogout;return Object(n.b)(l.Fragment,null,Object(n.b)("h1",{css:{fontFamily:'"Playfair Display", "PT Serif", Cambria, "Hoefler Text", Utopia, "Liberation Serif", "Nimbus Roman No9 L Regular", Times, "Times New Roman", serif',fontStyle:"italic",fontSize:"10vw",lineHeight:1,margin:"1vw 0 3vw 0",textAlign:"center",fontWeight:700,textShadow:"0 0 1px #000, 0 1.8vw 1.8vw #333",color:"#fff","@media (min-width: 75rem)":{fontSize:"7.5rem",margin:"0.75rem 0 2.25rem 0",textShadow:"0 0 1px #000, 0 1.34375rem 1.34375rem #333"}}},"Harvest 2 Sheet"),Object(n.b)(F,{look:"logout",onClick:t,css:{position:"absolute",top:"1rem",right:"1rem"}},"Logout"),Object(n.b)(U.a,null,Object(n.b)(V.c,null,Object(n.b)(V.a,{exact:!0,path:"/",component:q}),Object(n.b)(V.a,{exact:!0,path:"/add",component:Y}),Object(n.b)(V.a,{exact:!0,path:"/output",component:W}),Object(n.b)(V.a,{exact:!0,path:"/edit/:sheetID",component:Y}))))}function $(){var e=Object(l.useState)(JSON.parse(localStorage.getItem("harvest2sheetLogin")||"{}")),t=Object(u.a)(e,2),r=t[0],a=t[1],o=Object(l.useState)(!1),i=Object(u.a)(o,2),d=i[0],b=i[1],p=Object(l.useState)(""),m=Object(u.a)(p,2),f=m[0],h=m[1],g=Object(l.useState)(""),O=Object(u.a)(g,2),j=O[0],x=O[1],S=Object(l.useState)(""),w=Object(u.a)(S,2),y=w[0],k=w[1],_=Object(l.useState)(""),C=Object(u.a)(_,2),I=C[0],T=C[1],N=Object(l.useState)(""),A=Object(u.a)(N,2),D=A[0],R=A[1],L=function(){var e=Object(s.a)(c.a.mark((function e(t){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),b(!0),!(j&&y&&I&&D)){e.next=18;break}return r={HARVEST_ACCESS_TOKEN:j,HARVEST_ACCOUNT_ID:y,GOOGLE_CLIENT_ID:I,GOOGLE_API_KEY:D},e.prev=4,e.next=7,v(r);case 7:return e.next=9,E(r);case 9:localStorage.setItem("harvest2sheetLogin",JSON.stringify(r)),a(r),b(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),h(e.t0.toString()),b(!1);case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}(),H=!!r&&(!!r.HARVEST_ACCESS_TOKEN||!!r.HARVEST_ACCOUNT_ID||!!r.GOOGLE_CLIENT_ID||!!r.GOOGLE_API_KEY);return Object(n.b)("main",{css:{textRendering:"optimizeLegibility",fontKerning:"auto",MozOsxFontSmoothing:"grayscale"}},H?Object(n.b)(Z,{handleLogout:function(){localStorage.setItem("harvest2sheetLogin","{}"),a({})}}):Object(n.b)(B,{handleLogin:L,loading:d,error:f,inputLines:[{id:"hToken",label:"Harvest access token",value:j,setValue:x},{id:"hID",label:"Harvest account ID",value:y,setValue:k},{id:"gClientID",label:"Google client ID",value:I,setValue:T},{id:"gAPIKey",label:"Google API key",value:D,setValue:R}]}))}o.a.render(d.a.createElement(d.a.StrictMode,null,d.a.createElement(n.a,{styles:{html:{background:"rgb(183, 1, 255) -webkit-radial-gradient(left bottom, rgb(1, 255, 251), rgb(183, 1, 255)) repeat fixed 0% 0%",height:"100%"},body:{fontFamily:'system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"',lineHeight:1.2,margin:0,padding:0,color:"#383E48"},a:{color:"#383E48"},"*, *:before, *:after":{boxSizing:"border-box"}}}),d.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.375fb74a.chunk.js.map