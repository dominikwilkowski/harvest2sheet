(this.webpackJsonpharvest2sheet=this.webpackJsonpharvest2sheet||[]).push([[0],{29:function(e){e.exports=JSON.parse('{"a":"1.1.0"}')},45:function(e,t,r){e.exports=r.p+"static/media/harvest-project-id.966e79e5.png"},46:function(e,t,r){e.exports=r.p+"static/media/harvest-client-id.a2219d3e.png"},47:function(e,t,r){e.exports=r.p+"static/media/spreadsheet-id.0f499f40.png"},48:function(e,t,r){e.exports=r.p+"static/media/harvest-access.07c26b4d.png"},49:function(e,t,r){e.exports=r.p+"static/media/harvest-token-id.946649fd.png"},50:function(e,t,r){e.exports=r(61)},61:function(e,t,r){"use strict";r.r(t);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var n=r(0),a=r(19),o=r.n(a),i=r(4),c=r.n(i),s=r(6),d=r(10),u=r(3),l=r(1),p=r.n(l);function b(e,t){var r=localStorage.getItem(e)||t;try{return JSON.parse(r)}catch(n){return{}}}function m(e,t){if("object"!==typeof t)throw new Error('Data to be written to storage is not an object but "'.concat(typeof t,'"'));localStorage.setItem(e,JSON.stringify(t))}function f(){return b("harvest2sheetLogin","{}")}function h(e){m("harvest2sheetLogin",e)}function g(){return b("harvest2sheetSheets","[]")}function v(e){m("harvest2sheetSheets",e)}function j(){return b("harvest2sheetOutputs","[]")}function O(e){m("harvest2sheetOutputs",e)}var x=r(43),w=r(25),y=r(42),S=r(41),k=r(21),C={date:{name:"Date",value:function(e){return e.spent_date}},hours:{name:"Hours",value:function(e){return e.hours}},rounded_hours:{name:"Rounded Hours",value:function(e){return e.rounded_hours}},notes:{name:"Notes",value:function(e){return e.notes}},locked:{name:"Locked",value:function(e){return e.is_locked?"Yes":"No"}},locked_reason:{name:"Locked Reason",value:function(e){return e.locked_reason}},closed:{name:"Closed",value:function(e){return e.is_closed?"Yes":"No"}},billed:{name:"Billed",value:function(e){return e.is_billed?"Yes":"No"}},timer_started_at:{name:"Timer Started At",value:function(e){return e.timer_started_at}},started_time:{name:"Started Timer",value:function(e){return e.started_time}},ended_time:{name:"Ended Timer",value:function(e){return e.ended_time}},running:{name:"Running",value:function(e){return e.is_running?"Yes":"No"}},billable:{name:"Billable",value:function(e){return e.billable}},budgeted:{name:"Budgeted",value:function(e){return e.budgeted}},billable_rate:{name:"Billable Rate",value:function(e){return e.billable_rate}},billable_amount:{name:"Billable Amount",value:function(e){return e.rounded_hours*e.billable_rate}},cost_rate:{name:"Cost Rate",value:function(e){return e.cost_rate}},cost_amount:{name:"Cost Amount",value:function(e){return e.rounded_hours*e.cost_rate}},created_at:{name:"Created At",value:function(e){return Object(k.a)(Object(w.a)(e.created_at),"yyyy-MM-dd")}},updated_at:{name:"Updated At",value:function(e){return e.updated_at}},user:{name:"User",value:function(e){return e.user.name}},client:{name:"Client",value:function(e){return e.client.name}},currency:{name:"Currency",value:function(e){return e.client.currency}},project:{name:"Project",value:function(e){return e.project.name}},project_code:{name:"Project Code",value:function(e){return e.project.code}},task:{name:"Task",value:function(e){return e.task.name}}};function T(e){return I.apply(this,arguments)}function I(){return(I=Object(d.a)(c.a.mark((function e(t){var r,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.harvestapp.com/v2/users/me",{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Harvest login failed. Please check your credentials.");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function A(e,t){return _.apply(this,arguments)}function _(){return(_=Object(d.a)(c.a.mark((function e(t,r){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.harvestapp.com/v2/projects/".concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Harvest sync failed. Please check your credentials.");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function E(e,t){return R.apply(this,arguments)}function R(){return(R=Object(d.a)(c.a.mark((function e(t,r){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.harvestapp.com/v2/clients/".concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Harvest sync failed. Please check your credentials.");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function N(e,t,r,n){return D.apply(this,arguments)}function D(){return(D=Object(d.a)(c.a.mark((function e(t,r,n,a){var o,i,s,d,u,l,p,b=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=b.length>4&&void 0!==b[4]?b[4]:"project_id",i=[],s=Object(w.a)("".concat(n,"-01T00:00:00.000Z")),Object(S.a)(s)&&"Invalid Date"!==s.toString()){e.next=6;break}return console.error("The date passed in is not valid"),e.abrupt("return");case 6:return d=Object(y.a)(Object(x.a)(s)),u=[a.map((function(e){return C[e]?C[e].name:"unknown"}))],e.prev=8,e.next=11,fetch("https://api.harvestapp.com/v2/time_entries?from=".concat(Object(k.a)(s,"yyyyMMdd"),"&to=").concat(Object(k.a)(d,"yyyyMMdd"),"&").concat(o,"=").concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 11:return l=e.sent,e.next=14,l.json();case 14:p=e.sent,p.time_entries.reverse().forEach((function(e){u.push(a.map((function(t){return C[t]?C[t].value(e):""})))})),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(8),i.push(e.t0);case 22:return e.abrupt("return",{csv:u,errors:i.length?i.join("\n"):null});case 23:case"end":return e.stop()}}),e,null,[[8,19]])})))).apply(this,arguments)}function H(e,t){return z.apply(this,arguments)}function z(){return(z=Object(d.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t,resource:{requests:[{addSheet:{properties:{title:r,tabColor:{red:155,green:155,blue:155}}}}]}});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function L(e,t){return P.apply(this,arguments)}function P(){return(P=Object(d.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.gapi.client.sheets.spreadsheets.values.clear({spreadsheetId:t,range:"".concat(r,"!A1:ZZZ9999")});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,t,r){return F.apply(this,arguments)}function F(){return(F=Object(d.a)(c.a.mark((function e(t,r,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.gapi.client.sheets.spreadsheets.values.append({spreadsheetId:t,range:r,valueInputOption:"RAW",insertDataOption:"OVERWRITE",resource:{values:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return window.gapi.client?Promise.resolve():new Promise(function(){var r=Object(d.a)(c.a.mark((function r(n,a){return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t>2&&a("Google login failed. Check you credentials."),r.prev=1,r.next=4,window.gapi.load("client:auth2",function(){var r=Object(d.a)(c.a.mark((function r(o){return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,window.gapi.client.init({apiKey:e.GOOGLE_API_KEY,clientId:"75225162198-vsj9mtn0o9tf0ru487t4he9a90mrd2mp.apps.googleusercontent.com",discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"],scope:"https://www.googleapis.com/auth/spreadsheets"});case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),a("Google login failed. Check you credentials.");case 8:if(!window.gapi.auth2.getAuthInstance().isSignedIn.get()){r.next=13;break}n(),r.next=24;break;case 13:return r.prev=13,r.next=16,window.gapi.auth2.getAuthInstance().signIn();case 16:return r.next=18,U(e,t+1);case 18:n(),r.next=24;break;case 21:r.prev=21,r.t1=r.catch(13),a(r.t1);case 24:case"end":return r.stop()}}),r,null,[[0,5],[13,21]])})));return function(e){return r.apply(this,arguments)}}());case 4:r.next=9;break;case 6:r.prev=6,r.t0=r.catch(1),a(r.t0);case 9:case"end":return r.stop()}}),r,null,[[1,6]])})));return function(e,t){return r.apply(this,arguments)}}())}function V(e,t){return M.apply(this,arguments)}function M(){return(M=Object(d.a)(c.a.mark((function e(t,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t);case 2:return e.next=4,window.gapi.client.sheets.spreadsheets.get({spreadsheetId:r});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t,r,n,a){return G.apply(this,arguments)}function G(){return(G=Object(d.a)(c.a.mark((function e(t,r,n,a,o){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t);case 2:return e.next=4,H(r,o);case 4:return e.next=6,L(r,o);case 6:return e.next=8,B(r,o,a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){var t=e.children,r=e.size,a=void 0===r?"md":r;return Object(n.d)("div",{css:{maxWidth:{sm:"50rem",md:"60rem",lg:"93.75rem"}[a],background:"#fff",margin:"1rem auto",padding:"1rem",boxShadow:"0 0 1rem 0.25rem rgba(0, 0, 0, 0.4)","@media (min-width: 37.5rem)":{padding:"2rem"}}},t)}var K=r(15);function Y(e){var t=e.children,r=e.loading,a=e.look,o=void 0===a?"default":a,i=e.as,c=void 0===i?"button":i,d=Object(K.a)(e,["children","loading","look","as"]),u={default:{"--gradient":"linear-gradient(to right, var(--bg-color1) 0%, var(--bg-color2) 100%)"},muted:{"--gradient":"linear-gradient(to right, #ccc 0%, #555 50%, #ccc 100%)",":hover:before, :focus:before":d.disabled?{}:{filter:"invert(1)"}}},l=Object(n.e)({to:{transform:"rotate( 360deg )"}});return Object(n.d)(c,Object.assign({disabled:r,css:Object(s.a)({position:"relative",display:"inline-block",border:"none",background:"#fff",apperance:"none",fontSize:"1rem",cursor:"pointer",lineHeight:1,padding:"3px",borderRadius:"6px",margin:"1rem 0 0 0",textDecoration:"none",":before":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,background:"var(--gradient)",borderRadius:"8px",transition:"filter 0.3s ease",zIndex:1},":after":{content:'""',display:r?"block":"none",position:"absolute",top:"50%",left:"50%",marginLeft:"-0.75rem",marginTop:"-0.75rem",width:"1.5rem",height:"1.5rem",border:"3px solid #ccc",borderTopColor:"var(--text)",borderRadius:"100%",animation:"".concat(l," 0.6s linear infinite"),zIndex:2},":disabled":{opacity:.4},":hover:before":d.disabled?{}:{filter:"hue-rotate(180deg)"},":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}},u[o]?u[o]:{})},d),Object(n.d)("span",{css:{position:"relative",display:"block",background:"#fff",padding:"0.5rem 2.5rem",borderRadius:"6px",zIndex:2}},t))}function J(e){var t=e.id,r=e.label,a=e.required,o=e.maxWidth,i=void 0===o?"17rem":o,c=e.loading,s=void 0!==c&&c,d=e.help,u=void 0===d?"":d,l=e.visible,p=void 0===l||l,b=Object(K.a)(e,["id","label","required","maxWidth","loading","help","visible"]),m=Object(n.e)({to:{transform:"rotate( 360deg )"}});return Object(n.d)("li",{css:{display:p?"block":"none",marginBottom:"0.5rem","@media (min-width: 37.5rem)":{display:p?"grid":"none",gridTemplateColumns:"".concat(i," auto")}}},Object(n.d)("label",{htmlFor:t,css:{display:"inline-block",margin:"1rem 0.5rem 0.5rem 0",fontSize:"1.5rem",alignSelf:"center",whiteSpace:"nowrap","@media (min-width: 37.5rem)":{margin:"0 0.5rem 0 0"}}},r),Object(n.d)("div",{css:{position:"relative",":after":{content:'""',display:s?"block":"none",position:"absolute",top:"10px",left:"50%",marginLeft:"-0.75rem",width:"1.5rem",height:"1.5rem",border:"3px solid #ccc",borderTopColor:"var(--text)",borderRadius:"100%",animation:"".concat(m," 0.6s linear infinite")}}},Object(n.d)("input",Object.assign({id:t,type:"text",css:{fontSize:"1.5rem",padding:u?"0.5rem 1.5rem 0.5rem 0.5rem":"0.5rem",margin:0,border:"1px solid #767676",borderRadius:"0.2rem",apperance:"none",width:"100%",color:"var(--text)",":focus":{boxShadow:"0 0 0 3px #006cff",borderColor:"#006cff",outline:"none"},":disabled":{background:"var(--alt-bg)"}},required:!!p&&a},b)),u&&Object(n.d)("button",{type:"button","aria-label":"Help",css:{position:"absolute",top:"5px",right:"5px",display:"inline-block",background:"#fff",apperance:"none",fontSize:"1rem",cursor:"pointer",lineHeight:1,border:"1px solid var(--text)",borderRadius:"100%",width:"1rem",height:"1rem",padding:0,margin:0,":before":{content:'"?"',position:"absolute",top:"50%",left:"0",margin:"-0.5em 0 0 0",fontSize:"0.75rem",width:"100%",textAlign:"center"},":focus, :hover":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}},Object(n.d)("div",{css:{display:"none",position:"absolute",width:"max-content",maxWidth:"93vw",right:"-0.4rem",top:"2.6rem",background:"#fff",border:"3px solid var(--info)",padding:"0.5rem",whiteSpace:"nowrap",textAlign:"right",zIndex:4,":before":{content:'""',position:"absolute",top:"-1.7rem",right:"0.6rem",width:"3px",height:"1.7rem",background:"var(--info)"},"button:focus > &, button:active > &, button:hover > &":{display:"block"},"& img":{maxWidth:"100%"},"@media (min-width: 63.75rem)":{maxWidth:"59.375rem"}}},u))))}function Z(e){var t=e.handleLogin,r=e.inputLines,a=e.loading,o=e.error,i=Object(n.e)({to:{transform:"rotate( 360deg )"}});return Object(n.d)(l.Fragment,null,Object(n.d)("h1",{css:{fontFamily:'"Playfair Display", "PT Serif", Cambria, "Hoefler Text", Utopia, "Liberation Serif", "Nimbus Roman No9 L Regular", Times, "Times New Roman", serif',fontStyle:"italic",fontSize:"20vw",margin:"0 0 5vw 0",textAlign:"center",fontWeight:700,textShadow:"0 1.8vw 1.8vw #333",color:"#fff","@media (min-width: 125rem)":{fontSize:"25rem",marginBottom:"6.25rem",textShadow:"0 2.25rem 2.25rem #333"}}},"Login"),Object(n.d)(W,null,Object(n.d)("form",{onSubmit:t,css:{position:"relative",margin:0,padding:0,":after":{content:'""',display:a?"block":"none",position:"absolute",top:"50%",left:"50%",marginLeft:"-2.5rem",marginTop:"-2.5rem",width:"5rem",height:"5rem",border:"0.75rem solid #aaa",borderTopColor:"var(--text)",borderRadius:"100%",animation:"".concat(i," 0.5s linear infinite")}}},Object(n.d)("ul",{css:{listStyle:"none",padding:0,margin:0,opacity:a?.4:1}},r.map((function(e){var t=e.id,r=e.label,o=e.value,i=e.setValue,c=e.help;return Object(n.d)(J,{required:!0,key:t,id:t,label:r,value:o,help:c,disabled:a,onChange:function(e){return i(e.target.value)}})}))),Object(n.d)("div",{css:{display:"grid",gridTemplateColumns:"1fr",justifyItems:"end"}},Object(n.d)(Y,{type:"submit",disabled:a},"Save login")),o&&Object(n.d)("span",{css:{display:"inline-block",marginTop:"1rem",color:"var(--danger)"}},o))))}var $=r(14),Q=r(11);function X(e){var t=e.children,r=e.confirm,a=e.onClick,o=e.look,i=void 0===o?"add":o,c=e.as,d=void 0===c?"button":c,p=Object(K.a)(e,["children","confirm","onClick","look","as"]),b=Object(l.useState)(!1),m=Object(u.a)(b,2),f=m[0],h=m[1],g=Object(l.useState)(!1),v=Object(u.a)(g,2),j=v[0],O=v[1],x=Object(l.useState)([]),w=Object(u.a)(x,2),y=w[0],S=w[1],k=Object(n.e)({"0%":{transform:"scale(0.6)",opacity:0},"33%":{transform:"scale(1)",opacity:1},"100%":{transform:"scale(1.4)",opacity:0}}),C=Object(n.e)({"0%":{boxShadow:"0 0 0 3px rgba(255, 255, 255, 0.2)",opacity:0},"33%":{boxShadow:"0 0 0 10px rgba(255, 255, 255, 0.2)",opacity:1},"100%":{boxShadow:"0 0 0 16px rgba(255, 255, 255, 0.2)",opacity:0}}),T={"import-export":{":before, :after":{content:'""',position:"absolute",top:"50%",left:"14px",width:"10px",height:"10px",marginTop:"-5px",border:"3px solid var(--text)",borderRadius:"100% 0 100% 100%",transform:"rotate(45deg)",transition:"border 0.2s ease"},":after":{left:"25px",borderRadius:"100% 100% 100% 0"},":hover":{background:"var(--info)",color:"#fff"},":hover:before, :hover:after":{borderColor:"#fff"}},import:{":before":{content:'""',position:"absolute",top:"50%",left:"20px",width:"3px",height:"10px",marginTop:"-6px",background:"var(--text)",borderRadius:"2px",transition:"background 0.2s ease"},":after":{content:'""',position:"absolute",top:"50%",left:"17px",width:"9px",height:"9px",marginTop:"-3px",border:"3px solid var(--text)",borderStyle:"none solid solid none",transform:"rotate(45deg)",borderRadius:"2px",transition:"border 0.2s ease"},":hover":{background:"var(--info)",color:"#fff"},":hover:before":{background:"#fff"},":hover:after":{borderColor:"#fff"}},export:{":before":{content:'""',position:"absolute",top:"50%",left:"17px",width:"9px",height:"9px",marginTop:"-6px",border:"3px solid var(--text)",borderStyle:"solid none none solid",transform:"rotate(45deg)",borderRadius:"2px",transition:"border 0.2s ease"},":after":{content:'""',position:"absolute",top:"50%",left:"20px",width:"3px",height:"10px",marginTop:"-4px",background:"var(--text)",borderRadius:"2px",transition:"background 0.2s ease"},":hover":{background:"var(--info)",color:"#fff"},":hover:before":{borderColor:"#fff"},":hover:after":{background:"#fff"}},adjust:{":before":{content:'""',position:"absolute",top:"50%",left:"14px",width:"14px",height:"14px",marginTop:"-7px",border:"6px solid var(--text)",borderRadius:"100%",transition:"border 0.2s ease"},":after":{content:'""',position:"absolute",boxSizing:"content-box",top:"50%",left:"12px",width:"10px",height:"10px",marginTop:"-9px",border:"4px dotted var(--text)",borderRadius:"100%",transition:"border 0.2s ease"},":hover":{background:"var(--info)",color:"#fff"},":hover:before, :hover:after":{borderColor:"#fff"}},logout:{padding:"0.5rem 1rem",background:"#fff",":hover":{background:"var(--danger)",color:"#fff"}},sync:{background:p.disabled?"var(--alt-bg)":"var(--confirm)",color:p.disabled?"var(--text)":"#fff",cursor:p.disabled?"not-allowed":"pointer",":before":{content:'""',position:"absolute",top:"50%",left:"0.5rem",width:"1.5rem",height:"1.5rem",marginTop:"-0.75rem",background:"rgba(255,255,255, 0.2)",borderRadius:"50px",opacity:0,animation:p.disabled?"none":"".concat(k," 3s 2s infinite linear")},":after":{content:'""',position:"absolute",top:"50%",left:"1rem",width:"4px",height:"4px",marginTop:"-2px",marginLeft:"2px",background:p.disabled?"var(--text)":"#fff",borderRadius:"50%",boxShadow:"0 0 0 1px rgba(255, 255, 255, 0.2)",animation:p.disabled?"none":"".concat(C," 3s infinite linear")}},add:{":before, :after":{content:'""',position:"absolute",width:"1rem",height:"0.25rem",background:"var(--text)",borderRadius:"2px",top:"50%",marginTop:"-0.125rem",left:"1rem",transition:"background 0.2s ease"},":after":{transform:"rotate(-90deg)"},":hover":{background:"var(--info)",color:"#fff"},":hover:before, :hover:after":{background:"#fff"}},delete:{":before, :after":{content:'""',position:"absolute",width:"1rem",height:"0.25rem",background:"var(--text)",borderRadius:"2px",transform:"rotate(45deg)",top:"50%",marginTop:"-0.125rem",left:"1rem",transition:"background 0.2s ease"},":after":{transform:"rotate(-45deg)"},":hover":{background:"var(--danger)",color:"#fff"},":hover:before, :hover:after":{background:"#fff"}},edit:{":before":{content:'""',position:"absolute",top:"50%",marginTop:"-0.5rem",left:"1rem",width:"0.9rem",height:"1rem",border:"2px solid var(--text)",transition:"border 0.2s ease"},":after":{content:'""',position:"absolute",top:"2px",left:"1.65rem",background:"var(--text)",width:"4px",height:"1rem",transform:"rotate(45deg)",borderRadius:"1px 1px 50% 50%",boxShadow:"0 0 0 2px var(--alt-bg)",transition:"background 0.2s ease, box-shadow 0.2s ease"},":hover":{background:"var(--confirm)",color:"#fff"},":hover:before":{borderColor:"#fff"},":hover:after":{background:"#fff",boxShadow:"0 0 0 2px var(--confirm)"}}};return Object(n.d)(d,Object.assign({css:Object(s.a)({position:"relative",display:"inline-block",apperance:"none",background:"var(--alt-bg)",color:"var(--text)",border:"none",borderRadius:"6px",padding:"0.5rem 1rem 0.5rem 2.5rem",fontSize:"0.75rem",textDecoration:"none",textAlign:"center",lineHeight:1,transition:"background 0.2s ease, color 0.2s ease",overflow:"hidden",cursor:"pointer",":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}},T[i]?T[i]:{}),onClick:function(e){clearTimeout(y),S([]),r&&!f?(e.preventDefault(),O(!0),S(setTimeout((function(){h(!1),O(!1),S([])}),3e3))):("function"==typeof a&&a(),O(!1)),h(!f)}},p),j?"Sure?":t)}function ee(e){var t=e.id,r=e.label,a=Object(K.a)(e,["id","label"]);return Object(n.d)("div",null,Object(n.d)("input",Object.assign({id:t,type:"checkbox"},a,{css:{position:"absolute",opacity:0}})),Object(n.d)("label",{htmlFor:t,css:{position:"relative",display:"inline-flex",paddingLeft:"1.5rem",height:"1rem",marginBottom:"0.5rem",alignItems:"center",cursor:"pointer",":before":{content:'""',position:"absolute",left:0,top:0,width:"1rem",height:"1rem",border:"3px solid var(--text)",borderRadius:"3px"},":after":{content:'""',display:"none",position:"absolute",left:"5px",top:"4px",width:"6px",height:"6px",border:"2px solid var(--text)",borderStyle:"none solid solid none",transform:"rotate(45deg)"},"input:checked + &:after":{display:"block"},"input:focus + &":{boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}},r))}var te=r(29);function re(){var e=g(),t=j(),r=Object(l.useState)(!1),a=Object(u.a)(r,2),o=a[0],i=a[1],c=Object(l.useState)(!1),d=Object(u.a)(c,2),p=d[0],b=d[1],m=Object(l.useState)(!1),f=Object(u.a)(m,2),h=f[0],x=f[1],w=Object(l.useState)(""),y=Object(u.a)(w,2),S=y[0],k=y[1],C=Object(l.useState)(""),T=Object(u.a)(C,2),I=T[0],A=T[1],_=Object(Q.f)();return Object(n.d)(W,null,Object(n.d)("h2",null,"Export"),Object(n.d)("div",{css:{marginLeft:"1rem"}},Object(n.d)(ee,{id:"includeOutput",label:"Include Output",checked:o,onChange:function(e){return i(e.target.checked)}})),Object(n.d)(X,{look:"export",as:"a",href:"data:text/plain;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(Object(s.a)({version:te.a,sheets:e},o?{output:t}:{}),null,"\t"))),download:"harvest2sheet.export",css:{marginTop:"1rem"}},"Export"),Object(n.d)("h2",{css:{borderTop:"2px dashed var(--alt-bg)",paddingTop:"0.5rem",marginBottom:"1rem"}},"Import"),Object(n.d)("form",{onSubmit:function(t){if(t.preventDefault(),S){var r=new FileReader;r.onload=function(t){var r=t.target.result;try{if(r=JSON.parse(r),p&&r.sheets&&(h||(r.sheets=r.sheets.map((function(e){e.output;var t=Object(K.a)(e,["output"]);return Object(s.a)({output:1},t)}))),v(r.sheets)),h&&r.output){if(!p)v(e.map((function(e){e.output;var t=Object(K.a)(e,["output"]);return Object(s.a)({output:1},t)})));O(r.output)}_.push("/")}catch(I){A('The import file could not be read. Please make sure it\'s in the right format "harvest2sheet.export"')}},r.readAsText(S)}}},Object(n.d)("div",{css:{position:"relative",marginLeft:"1rem"}},Object(n.d)("input",{id:"file",type:"file",required:!0,onChange:function(e){return k(e.target.files[0])},css:{position:"absolute",opacity:0,width:"1px",left:"0.5rem",height:"1.5rem"}}),Object(n.d)("label",{htmlFor:"file",css:{position:"relative",display:"block",width:"12.5rem",height:"1.5rem",borderRadius:"6px",border:"3px solid var(--text)",margin:"0.5rem 0",":before":{content:'"Browse"',display:"flex",position:"absolute",left:0,bottom:0,top:0,width:"3.3rem",background:"var(--text)",color:"#fff",padding:"0 6px",fontSize:"0.75rem",alignItems:"center"},":after":{content:S&&S.name?'"'.concat(S.name,'"'):'"Choose file..."',display:"flex",position:"absolute",left:"3.8rem",bottom:0,top:0,width:"8rem",overflow:"hidden",fontSize:"0.75rem",alignItems:"center",textAlign:"center"},"input:focus + &":{boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}}),Object(n.d)(ee,{id:"overrideSheets",label:"Override sheets",checked:p,onChange:function(e){return b(e.target.checked)}}),Object(n.d)(ee,{id:"overrideOutput",label:"Override output",checked:h,onChange:function(e){return x(e.target.checked)}})),I&&Object(n.d)("div",{css:{color:"var(--danger)"}},I),Object(n.d)(X,{look:"import",type:"submit",css:{marginTop:"1rem"}},"Import")),Object(n.d)(Y,{look:"muted",to:"/",as:$.b,css:{marginTop:"1.5rem"}},"Cancel"))}var ne=r(37);function ae(e){return Object(n.d)("span",Object.assign({css:{display:"inline-block",background:"var(--alt-bg)",border:"1px solid #ccc",padding:"0 0.25rem",borderRadius:"3px",margin:"0.25rem 0.25rem 0 0",fontSize:"0.75rem"}},e))}function oe(e){var t=e.id,r=e.name,a=e.hProjectName,o=e.hClientName,i=e.tabName,c=e.gSheetIDName,s=e.output,d=e.selected,u=e.toggle,l=e.deleteSheet;return Object(n.d)("div",{css:{display:"grid",gridTemplateColumns:"3rem auto",gap:"0.5rem",alignItems:"center","@media (min-width: 40rem)":{gridTemplateColumns:"3rem auto 12rem"}}},Object(n.d)("label",{css:{position:"relative",overflow:"hidden",display:"block",width:"3rem",height:"3rem",cursor:"pointer"}},Object(n.d)("input",{id:t,type:"checkbox",checked:d.includes(t),onChange:function(){return u(t)},css:{position:"absolute",top:"-5rem",left:"-5rem"}}),Object(n.d)("span",{css:{display:"block",width:"2rem",height:"2rem",margin:"0.5rem",border:"4px solid var(--text)",borderRadius:"3px",":before":{content:'""',display:"none",position:"absolute",top:"0.7rem",right:"0.4rem",width:"1.5rem",height:"0.8rem",borderBottom:"4px solid var(--text)",borderLeft:"4px solid var(--text)",transform:"rotate(-45deg)",zIndex:2},":after":{content:'""',display:"none",position:"absolute",top:"0",right:"0",width:"1.1rem",height:"1.5rem",background:"#fff",zIndex:1},"input:checked + &:before,input:checked + &:after":{display:"block"},"input:focus + &":{boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}})),Object(n.d)("label",{htmlFor:t,css:{display:"block",cursor:"pointer"}},Object(n.d)("strong",{css:{display:"block"}},r),Object(n.d)(ae,null,a||o),Object(n.d)(ae,null,c),Object(n.d)(ae,null,i),Object(n.d)(ae,null,s.name," (",s.columns.length," columns)")),Object(n.d)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",alignItems:"center",gridColumn:"1 / 3","@media (min-width: 40rem)":{gridTemplateColumns:"1fr 1fr",gridColumn:"unset"}}},Object(n.d)(X,{look:"edit",as:$.b,to:"/edit/".concat(t)},"Edit"),Object(n.d)(X,{confirm:!0,type:"button",look:"delete",onClick:function(){return l(t)}},"Delete")))}function ie(){var e=f(),t=g(),r=j();0===r.length&&(r=[{id:1,name:"Default",columns:["date","user","client","project","task","hours","rounded_hours","notes","billable_rate","billable_amount","cost_rate","cost_amount","currency"]}],v(t.map((function(e){return Object(s.a)({output:1},e)}))),O(r));var a=Object(l.useState)(t),o=Object(u.a)(a,2),i=o[0],p=o[1],b=Object(l.useState)(Object(k.a)(new Date,"yyyy-MM")),m=Object(u.a)(b,2),h=m[0],x=m[1],y=Object(l.useState)(!1),S=Object(u.a)(y,2),C=S[0],T=S[1],I=Object(l.useState)([]),A=Object(u.a)(I,2),_=A[0],E=A[1],R=function(e){return r.filter((function(t){return t.id===e}))[0]},D=function(e){var t=i.filter((function(t){return t.id!==e}));v(t),p(t)},H=function(e){if(_.includes(e)){var t=Object(ne.a)(_).filter((function(t){return t!==e}));E(t)}else{var r=Object(ne.a)(_);r.push(e),E(r)}},z=function(){var t=Object(d.a)(c.a.mark((function t(r,n){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),T(!0),a=i.filter((function(e){var t=e.id;return _.includes(t)})),t.next=5,Promise.all(a.map(function(){var t=Object(d.a)(c.a.mark((function t(r){var a,o,i,s,d,u,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.hProject,o=r.hClient,i=r.gSheetID,s=r.output,d=a||o,u=a?"project_id":"client_id",t.prev=3,t.next=6,N(e,d,h,R(s).columns,u);case 6:return l=t.sent,t.next=9,q(e,i,h,l.csv,n);case 9:E([]),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),console.error(t.t0);case 15:case"end":return t.stop()}}),t,null,[[3,12]])})));return function(e){return t.apply(this,arguments)}}()));case 5:T(!1);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),L=Object(n.e)({to:{transform:"rotate( 360deg )"}}),P=Object(w.a)("".concat(7===h.length?h:"2020-01","-01T00:00:00.000Z")),B="H|".concat(Object(k.a)(P,"LLL"),"'").concat(Object(k.a)(P,"yy"));return Object(n.d)(W,{size:"lg"},Object(n.d)("h2",null,"Sheets"),Object(n.d)("div",{css:{display:"grid",gridTemplateColumns:"1fr",alignItems:"center","@media (min-width: 28.75rem)":{gridTemplateColumns:"1fr 1fr"}}},Object(n.d)("div",{css:{"@media (min-width: 28.75rem)":{justifySelf:"start"}}},Object(n.d)(X,{look:"add",as:$.b,to:"/add"},"Add new"),Object(n.d)(X,{look:"adjust",as:$.b,to:"/output",css:{marginLeft:"0.5rem"}},"Output"),Object(n.d)(X,{look:"import-export",as:$.b,to:"/import-export",css:{marginLeft:"0.5rem"}},"Import/Export")),Object(n.d)("form",{onSubmit:function(e){return z(e,B)},css:{marginTop:"1rem","@media (min-width: 28.75rem)":{justifySelf:"end",marginTop:0}}},Object(n.d)("input",{type:"text",value:h,onChange:function(e){return x(e.target.value)},pattern:"\\d{4}-\\d{2}",title:"Please use the format year(4 numbers)-month(2 numbers). E.g.: 2020-09 or 2023-03",css:{display:"inline-block",apperance:"none",background:"#fff",border:"1px solid var(--text)",width:"7em",padding:"0.5rem",lineHeight:1,marginRight:"1rem",textAlign:"center",":invalid":{boxShadow:"0 0 0 3px var(--danger)"},":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}}),Object(n.d)(X,{look:"sync",type:"submit",disabled:!_.length},"Sync"))),Object(n.d)("button",{onClick:function(){E(i.map((function(e){return e.id})))},css:{border:"none",background:"transparent",apperance:"none",fontSize:"0.75rem",cursor:"pointer",margin:"1rem 0 0 0.5rem",padding:0,":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}},"Select all"),Object(n.d)("ul",{css:{position:"relative",listStyle:"none",padding:0,margin:0,":after":{content:'""',display:C?"block":"none",position:"absolute",top:"50%",left:"50%",marginLeft:"-2.5rem",marginTop:"-2.5rem",width:"5rem",height:"5rem",border:"0.75rem solid #ccc",borderTopColor:"var(--text)",borderRadius:"100%",animation:"".concat(L," 0.5s linear infinite")}}},i.map((function(e,t){var r=e.id,a=e.name,o=e.hProjectName,i=e.hClientName,c=e.gSheetIDName,s=e.output,d=void 0===s?1:s;return Object(n.d)("li",{key:r,css:{opacity:C?.2:1,marginTop:"1.5rem",":not(:first-of-type)":{borderTop:"2px dashed var(--alt-bg)",paddingTop:"0.5rem"},"@media (min-width: 40rem)":{marginTop:"0.5rem"}}},Object(n.d)(oe,{id:r,name:a,hProjectName:o,hClientName:i,tabName:B,gSheetIDName:c,output:R(d),selected:_,toggle:H,deleteSheet:D}))}))))}function ce(){var e=Object(l.useState)(j()),t=Object(u.a)(e,2),r=t[0],a=t[1];return Object(n.d)(W,null,Object(n.d)("h2",null,"Output"),Object(n.d)(X,{look:"add",as:$.b,to:"/output/add"},"Add new"),Object(n.d)("ul",{css:{listStyle:"none",padding:0,margin:0}},r.map((function(e){var t=e.id,o=e.name,i=e.columns;return Object(n.d)("li",{key:t,css:{display:"grid",gridTemplateColumns:"auto",alignItems:"center",marginTop:"1.5rem",":not(:first-of-type)":{borderTop:"2px dashed var(--alt-bg)",paddingTop:"0.5rem"},"@media (min-width: 40rem)":{marginTop:"0.5rem",gridTemplateColumns:"auto 6rem",gap:"0.5rem"}}},Object(n.d)($.b,{to:"/output/".concat(t),css:{textDecoration:"none",":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}},Object(n.d)("strong",{css:{display:"block"}},o),Object(n.d)(ae,null,i.length," columns")),1!==t?Object(n.d)(X,{confirm:!0,type:"button",look:"delete",onClick:function(){return function(e){if(1!==e){v(g().map((function(t){var r=t.output,n=Object(K.a)(t,["output"]);return r===e?Object(s.a)({output:1},n):Object(s.a)({output:r},n)})));var t=r.filter((function(t){return t.id!==e}));O(t),a(t)}}(t)}},"Delete"):null)}))),Object(n.d)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",justifyItems:"start"}},Object(n.d)(Y,{look:"muted",to:"/",as:$.b},"Cancel")))}var se=r(36),de=r(7),ue=r(30);var le=Object(se.b)((function(e){var t={onMouseDown:function(e){e.preventDefault(),e.stopPropagation()}};return Object(n.d)(de.z.MultiValue,Object.assign({},e,{innerProps:t}))})),pe=Object(se.a)(ue.a);function be(e){var t=e.match.params.itemID;t=parseInt(t);var r=j(),a="",o=[];if(t){var i=r.filter((function(e){return e.id===t}));1===i.length&&(a=i[0].name,o=i[0].columns.map((function(e){return{value:e,label:C[e].name}})))}var c=Object(l.useState)(a),d=Object(u.a)(c,2),p=d[0],b=d[1],m=Object(l.useState)(o),f=Object(u.a)(m,2),h=f[0],g=f[1],v=Object(Q.f)(),x=Object.entries(C).map((function(e){var t=Object(u.a)(e,2);return{value:t[0],label:t[1].name}})),w={container:function(e){return h&&h.length?e:Object(s.a)(Object(s.a)({},e),{},{boxShadow:"0 0 0 3px var(--danger)"})},control:function(e){return Object(s.a)(Object(s.a)({},e),{},{borderColor:"#767676",":hover":Object(s.a)({borderColor:"#767676"},e[":hover"])})}};return Object(n.d)(W,{size:"sm"},Object(n.d)("h2",null,t?"Edit":"Add"," Output"),Object(n.d)("form",{onSubmit:function(e){e.preventDefault(),h.length>0&&(t?r=r.map((function(e){return e.id===t?{id:e.id,name:p,columns:h.map((function(e){return e.value}))}:e})):r.push({id:r.length?r[r.length-1].id+1:1,name:p,columns:h.map((function(e){return e.value}))}),O(r),v.push("/output"))},css:{margin:0,padding:0}},Object(n.d)("ul",{css:{listStyle:"none",padding:0,margin:0}},Object(n.d)(J,{required:!0,id:"name",label:"Name",value:p,onChange:function(e){return b(e.target.value)},maxWidth:"8rem"}),Object(n.d)("li",{css:{marginBottom:"0.5rem","@media (min-width: 37.5rem)":{display:"grid",gridTemplateColumns:"8rem auto"}}},Object(n.d)("label",{htmlFor:"columns",css:{display:"inline-block",margin:"1rem 0.5rem 0.5rem 0",fontSize:"1.5rem",alignSelf:"center",whiteSpace:"nowrap","@media (min-width: 37.5rem)":{margin:"0 0.5rem 0 0"}}},"Columns"),Object(n.d)(pe,{inputId:"columns",axis:"xy",onSortEnd:function(e){var t,r,n,a=e.oldIndex,o=e.newIndex,i=(r=a,n=o,(t=(t=h).slice()).splice(n<0?t.length+n:n,0,t.splice(r,1)[0]),t);g(i)},distance:4,getHelperDimensions:function(e){return e.node.getBoundingClientRect()},isMulti:!0,options:x,value:h,styles:w,onChange:function(e){return g(e)},components:{MultiValue:le},closeMenuOnSelect:!1,css:{zIndex:3}}))),Object(n.d)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",justifyItems:"start"}},Object(n.d)(Y,{look:"muted",to:"/output",as:$.b},"Cancel"),Object(n.d)(Y,{type:"submit",css:{justifySelf:"end"}},"Save output"))))}var me=r(45),fe=r.n(me),he=r(46),ge=r.n(he),ve=r(47),je=r.n(ve);function Oe(e){var t=e.match.params.sheetID;t=parseInt(t);var r=j(),a=r.map((function(e){var t=e.id;return{label:e.name,value:t}})),o=g(),i="",p="",b="",m="",h="",O="",x="",w="",y="project";if(t){var S=o.filter((function(e){return e.id===t}));1===S.length&&(i=S[0].hProject,p=S[0].hProjectName,b=S[0].hClient,m=S[0].hClientName,h=S[0].gSheetID,O=S[0].gSheetIDName,x=S[0].name,w=r.filter((function(e){return e.id===S[0].output})).map((function(e){var t=e.id;return{label:e.name,value:t}}))[0],b&&(y="client"))}var k=Object(l.useState)(!1),C=Object(u.a)(k,2),T=C[0],I=C[1],_=Object(l.useState)(!1),R=Object(u.a)(_,2),N=R[0],D=R[1],H=Object(l.useState)(!1),z=Object(u.a)(H,2),L=z[0],P=z[1],B=Object(l.useState)(i),F=Object(u.a)(B,2),U=F[0],M=F[1],q=Object(l.useState)(p),G=Object(u.a)(q,2),K=G[0],Z=G[1],X=Object(l.useState)(b),ee=Object(u.a)(X,2),te=ee[0],re=ee[1],ne=Object(l.useState)(m),ae=Object(u.a)(ne,2),oe=ae[0],ie=ae[1],ce=Object(l.useState)(h),se=Object(u.a)(ce,2),de=se[0],le=se[1],pe=Object(l.useState)(O),be=Object(u.a)(pe,2),me=be[0],he=be[1],ve=Object(l.useState)(x),Oe=Object(u.a)(ve,2),xe=Oe[0],we=Oe[1],ye=Object(l.useState)(w),Se=Object(u.a)(ye,2),ke=Se[0],Ce=Se[1],Te=Object(l.useState)(y),Ie=Object(u.a)(Te,2),Ae=Ie[0],_e=Ie[1],Ee=Object(Q.f)(),Re=f(),Ne=function(){var e=Object(d.a)(c.a.mark((function e(){var t,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(!0),Z(""),e.prev=2,e.next=5,A(Re,U);case 5:t=e.sent,r=t.name,Z(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),Z("- not found -");case 13:I(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),De=function(){var e=Object(d.a)(c.a.mark((function e(){var t,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),Z(""),e.prev=2,e.next=5,E(Re,te);case 5:t=e.sent,r=t.name,ie(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),ie("- not found -");case 13:D(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),He=function(){var e=Object(d.a)(c.a.mark((function e(){var t,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),he(""),e.prev=2,e.next=5,V(Re,de);case 5:t=e.sent,r=t.result.properties.title,he(r||""),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),he("- not found -");case 13:P(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),ze={container:function(e){return ke?e:Object(s.a)(Object(s.a)({},e),{},{boxShadow:"0 0 0 3px var(--danger)"})},control:function(e){return Object(s.a)(Object(s.a)({},e),{},{borderColor:"#767676",fontSize:"1.5rem",padding:"0.25rem 0",":hover":Object(s.a)({borderColor:"#767676"},e[":hover"])})}},Le=["project","client"];return Object(n.d)(W,null,Object(n.d)("h2",null,t?"Edit a":"Add a new"," sheet"),Object(n.d)("form",{onSubmit:function(e){e.preventDefault(),("project"===Ae?"- not found -"!==K&&""!==K&&K:"- not found -"!==oe&&""!==oe&&oe)&&"- not found -"!==me&&""!==me&&me&&ke&&(t?o=o.map((function(e){return e.id===t?{id:e.id,name:xe,hProject:"project"===Ae?U:"",hProjectName:"project"===Ae?K:"",hClient:"client"===Ae?te:"",hClientName:"client"===Ae?oe:"",gSheetID:de,gSheetIDName:me,output:ke.value}:e})):o.push({id:o.length?o[o.length-1].id+1:1,name:xe,hProject:"project"===Ae?U:"",hProjectName:"project"===Ae?K:"",hClient:"client"===Ae?te:"",hClientName:"client"===Ae?oe:"",gSheetID:de,gSheetIDName:me,output:ke.value}),v(o),Ee.push("/"))},css:{margin:0,padding:0}},Object(n.d)("ul",{css:{listStyle:"none",padding:0,margin:0}},Object(n.d)(J,{required:!0,id:"name",label:"Name",value:xe,help:Object(n.d)("span",null,"The name of this item",Object(n.d)("br",null),"Only important for you to organise your items"),onChange:function(e){return we(e.target.value)}}),Object(n.d)("li",{css:{margin:"1rem 0 0 0","@media (min-width: 37.5rem)":{paddingLeft:"17rem",margin:"0 0 0.5rem 0"}}},Object(n.d)("button",{type:"button",onClick:function(){var e=Le.indexOf(Ae)+1;e>Le.length-1&&(e=0),_e(Le[e])},css:{display:"grid",gridTemplateColumns:"1fr 1fr",apperance:"none",background:"transparent",border:"1px solid var(--text)",borderRadius:"6px",fontSize:"1rem",cursor:"pointer",lineHeight:1,padding:0,width:"100%",overflow:"hidden",":focus":{boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)",outline:"none"}}},Le.map((function(e){return Object(n.d)("span",{key:e,css:{background:e===Ae?"var(--text)":"var(--alt-bg)",color:e===Ae?"#fff":"var(--text)",padding:"0.5rem",transition:"background 0.3s ease, color 0.3s ease"}},"Use ",e," ID")})))),Object(n.d)(J,{required:!0,id:"hProject",label:"Harvest Project ID",value:U,visible:"project"===Ae,help:Object(n.d)("img",{src:fe.a,alt:"The project ID can be found in the url of the project website in harvest."}),onChange:function(e){M(e.target.value),Z("")},onBlur:Ne}),Object(n.d)(J,{required:!0,id:"hProjectName",label:"Harvest Project Name",value:K,disabled:!0,loading:T,readOnly:!0,visible:"project"===Ae,css:Object(s.a)({},"- not found -"!==K&&""!==K&&K?{}:{boxShadow:"0 0 0 3px var(--danger)"})}),Object(n.d)(J,{required:!0,id:"hClient",label:"Harvest Client ID",value:te,visible:"client"===Ae,help:Object(n.d)("img",{src:ge.a,alt:"The project ID can be found in the url of the project website in harvest."}),onChange:function(e){re(e.target.value),ie("")},onBlur:De}),Object(n.d)(J,{required:!0,id:"hClientName",label:"Harvest Client Name",value:oe,disabled:!0,loading:N,readOnly:!0,visible:"client"===Ae,css:Object(s.a)({},"- not found -"!==oe&&""!==oe&&oe?{}:{boxShadow:"0 0 0 3px var(--danger)"})}),Object(n.d)(J,{required:!0,id:"gSheetID",label:"Spreadsheet ID",value:de,help:Object(n.d)("img",{src:je.a,alt:"The spreadsheet ID can be found in the url of the google spreadsheet."}),onChange:function(e){le(e.target.value),he("")},onBlur:He}),Object(n.d)(J,{required:!0,id:"gSheetIDName",label:"Sheet Name",value:me,disabled:!0,loading:L,readOnly:!0,css:Object(s.a)({},"- not found -"!==me&&""!==me&&me?{}:{boxShadow:"0 0 0 3px var(--danger)"})}),Object(n.d)("li",{css:{position:"relative",zIndex:3,marginBottom:"0.5rem","@media (min-width: 37.5rem)":{display:"grid",gridTemplateColumns:"17rem auto"}}},Object(n.d)("label",{htmlFor:"output",css:{display:"inline-block",margin:"1rem 0.5rem 0.5rem 0",fontSize:"1.5rem",alignSelf:"center",whiteSpace:"nowrap","@media (min-width: 37.5rem)":{margin:"0 0.5rem 0 0"}}},"Output"),Object(n.d)(ue.a,{inputId:"output",options:a,value:ke,onChange:Ce,styles:ze}))),Object(n.d)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",justifyItems:"start"}},Object(n.d)(Y,{look:"muted",to:"/",as:$.b},"Cancel"),Object(n.d)(Y,{type:"submit",loading:T||N||L,css:{justifySelf:"end"}},t?"Edit":"Add"," sheet"))))}function xe(e){var t=e.handleLogout,r=Object(l.useState)(["rgb(1, 255, 251)","rgb(183, 1, 255)"]),a=Object(u.a)(r,2),o=a[0],i=a[1],c=Object(l.useState)(0),d=Object(u.a)(c,2),p=d[0],b=d[1],m=f().avatar_url;return Object(n.d)(l.Fragment,null,Object(n.d)(n.c,{styles:{html:{"--bg-color1":o[0],"--bg-color2":o[1]}}}),Object(n.d)("h1",{css:{fontFamily:'"Playfair Display", "PT Serif", Cambria, "Hoefler Text", Utopia, "Liberation Serif", "Nimbus Roman No9 L Regular", Times, "Times New Roman", serif',fontStyle:"italic",fontSize:"10vw",lineHeight:1,margin:"1vw 0 3vw 0",textAlign:"center",fontWeight:700,textShadow:"0 0 1px #000, 0 1.8vw 1.8vw #333",color:"#fff","@media (min-width: 75rem)":{fontSize:"7.5rem",margin:"0.75rem 0 2.25rem 0",textShadow:"0 0 1px #000, 0 1.34375rem 1.34375rem #333"}}},"Harvest 2 Sheet"),Object(n.d)(X,{look:"logout",onClick:t,css:Object(s.a)({display:"block",margin:"0 auto","@media (min-width: 41.875rem)":{position:"absolute",top:"1rem",right:"1rem"}},m?{paddingLeft:"2rem"}:{})},m&&Object(n.d)("img",{src:m,alt:"",css:{position:"absolute",left:"6px",top:"3px",height:"22px",borderRadius:"100%"}}),"Logout"),Object(n.d)($.a,null,Object(n.d)(Q.c,null,Object(n.d)(Q.a,{exact:!0,path:"/",component:ie}),Object(n.d)(Q.a,{exact:!0,path:"/add",component:Oe}),Object(n.d)(Q.a,{exact:!0,path:"/edit/:sheetID",component:Oe}),Object(n.d)(Q.a,{exact:!0,path:"/output",component:ce}),Object(n.d)(Q.a,{exact:!0,path:"/output/add",component:be}),Object(n.d)(Q.a,{exact:!0,path:"/output/:itemID",component:be}),Object(n.d)(Q.a,{exact:!0,path:"/import-export",component:re}))),Object(n.d)("div",{css:{display:"block",padding:"1rem",textAlign:"right",color:"#fff",fontSize:"0.5rem"}},Object(n.d)("span",{onClick:function(){var e=[["rgb(1, 255, 251)","rgb(183, 1, 255)"],["#f857a6","#ff5858"],["#2BC0E4","#EAECC6"],["#7474BF","#348AC7"],["#A9C9FF","#FFBBEC"],["#3D7EAA","#FFE47A"],["#08AEEA","#2AF598"],["#5f2c82","#49a09d"],["#00DBDE","#FC00FF"],["#FC354C","#0ABFBC"],["#f2709c","#ff9472"],["green","red"],["red","blue"],["#888","#888"]],t=p+1>e.length-1?0:p+1;b(t),i(e[t])}},"v",te.a)))}var we=r(48),ye=r.n(we),Se=r(49),ke=r.n(Se);function Ce(){var e=Object(l.useState)(f()),t=Object(u.a)(e,2),r=t[0],a=t[1],o=Object(l.useState)(!1),i=Object(u.a)(o,2),p=i[0],b=i[1],m=Object(l.useState)(""),g=Object(u.a)(m,2),v=g[0],j=g[1],O=Object(l.useState)(""),x=Object(u.a)(O,2),w=x[0],y=x[1],S=Object(l.useState)(""),k=Object(u.a)(S,2),C=k[0],I=k[1],A=Object(l.useState)(""),_=Object(u.a)(A,2),E=_[0],R=_[1],N=function(){var e=Object(d.a)(c.a.mark((function e(t){var r,n,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),b(!0),!(w&&C&&E)){e.next=20;break}return r={HARVEST_ACCESS_TOKEN:w,HARVEST_ACCOUNT_ID:C,GOOGLE_API_KEY:E},e.prev=4,e.next=7,T(r);case 7:return n=e.sent,o=n.avatar_url,e.next=11,U(r);case 11:h(Object(s.a)({avatar_url:o},r)),a(r),b(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),"object"===typeof e.t0?j("Can't login. Check that you allow popups in the browser."):j(e.t0.toString()),b(!1);case 20:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(t){return e.apply(this,arguments)}}(),D=!!r&&(!!r.HARVEST_ACCESS_TOKEN||!!r.HARVEST_ACCOUNT_ID||!!r.GOOGLE_API_KEY),H=function(){return Object(n.d)("div",null,"Log into ",Object(n.d)("strong",null,"https://id.getharvest.com/developers"),Object(n.d)("br",null),"and create a Personal Access Tokens",Object(n.d)("br",null),Object(n.d)("img",{src:ye.a,alt:"",css:{width:"30rem !important"}}),Object(n.d)("br",null),'Copy the "Your Token" and paste it here',Object(n.d)("br",null),Object(n.d)("img",{src:ke.a,alt:"",css:{width:"30rem !important"}}))};return Object(n.d)("main",{css:{textRendering:"optimizeLegibility",fontKerning:"auto",MozOsxFontSmoothing:"grayscale"}},D?Object(n.d)(xe,{handleLogout:function(){h({}),a({})}}):Object(n.d)(Z,{handleLogin:N,loading:p,error:v,inputLines:[{id:"hToken",label:"Harvest access token",value:w,setValue:y,help:Object(n.d)(H,null)},{id:"hID",label:"Harvest account ID",value:C,setValue:I,help:Object(n.d)(H,null)},{id:"gAPIKey",label:"Google API key",value:E,setValue:R,help:"Ask Dom for it"}]}))}o.a.render(p.a.createElement(p.a.StrictMode,null,p.a.createElement(n.c,{styles:{html:{"--bg-color1":"rgb(1, 255, 251)","--bg-color2":"rgb(183, 1, 255)","--alt-bg":"#eee","--text":"#383E48","--info":"#005fcc","--confirm":"#008800","--danger":"#ee0000","--focus":"#005fcc",background:"rgb(183, 1, 255) -webkit-radial-gradient(left bottom, var(--bg-color1), var(--bg-color2)) repeat fixed 0% 0%",height:"100%"},body:{fontFamily:'system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"',lineHeight:1.2,margin:0,padding:0,color:"var(--text)"},a:{color:"var(--text)"},"*, *:before, *:after":{boxSizing:"border-box"}}}),p.a.createElement(Ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[50,1,2]]]);
//# sourceMappingURL=main.0170b07b.chunk.js.map