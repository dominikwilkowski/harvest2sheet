(this.webpackJsonpharvest2sheet=this.webpackJsonpharvest2sheet||[]).push([[0],{43:function(e){e.exports=JSON.parse('{"a":"1.6.0"}')},70:function(e,t,r){"use strict";r.r(t);var n=r(24);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var a=r(17),o=r(23),i=r.n(o),c=r(6),s=r.n(c),u=r(5),d=r(12),l=r(4),p=r(1),b=r(0),m=r.n(b),f="harvest2sheetOutputs",h="harvest2sheetSheets",g="harvest2sheetLogin";function v(e,t){var r=localStorage.getItem(e)||t;try{return JSON.parse(r)}catch(n){return{}}}function j(e,t){if("object"!==typeof t)throw new Error('Data to be written to storage is not an object but "'.concat(typeof t,'"'));localStorage.setItem(e,JSON.stringify(t))}function O(){return v(g,"{}")}function x(e){j(g,e)}function y(){return v(h,"[]")}function w(e){j(h,e)}function S(){return v(f,"[]")}function k(e){j(f,e)}var C=r(26),T=r(56),I=r(28),_=r(55),A=r(54),E=r(21),R={date:{name:"Date",value:function(e){return e.spent_date?Object(E.a)(Object(I.a)(e.spent_date),"dd MMM yy"):""}},hours:{name:"Hours",value:function(e){return e.hours}},rounded_hours:{name:"Rounded Hours",value:function(e){return e.rounded_hours}},notes:{name:"Notes",value:function(e){return e.notes}},locked:{name:"Locked",value:function(e){return e.is_locked?"Yes":"No"}},locked_reason:{name:"Locked Reason",value:function(e){return e.locked_reason}},closed:{name:"Closed",value:function(e){return e.is_closed?"Yes":"No"}},billed:{name:"Billed",value:function(e){return e.is_billed?"Yes":"No"}},timer_started_at:{name:"Timer Started At",value:function(e){return e.timer_started_at}},started_time:{name:"Started Timer",value:function(e){return e.started_time}},ended_time:{name:"Ended Timer",value:function(e){return e.ended_time}},running:{name:"Running",value:function(e){return e.is_running?"Yes":"No"}},billable:{name:"Billable",value:function(e){return e.billable}},budgeted:{name:"Budgeted",value:function(e){return e.budgeted}},billable_rate:{name:"Billable Rate",value:function(e){return e.billable_rate}},billable_amount:{name:"Billable Amount",value:function(e){return e.rounded_hours*e.billable_rate}},cost_rate:{name:"Cost Rate",value:function(e){return e.cost_rate}},cost_amount:{name:"Cost Amount",value:function(e){return e.rounded_hours*e.cost_rate}},created_at:{name:"Created At",value:function(e){return e.created_at?Object(E.a)(Object(I.a)(e.created_at),"dd MMM yy h:m:s a"):""}},updated_at:{name:"Updated At",value:function(e){return e.updated_at?Object(E.a)(Object(I.a)(e.updated_at),"dd MMM yy h:m:s a"):""}},user:{name:"User",value:function(e){return e.user.name}},client:{name:"Client",value:function(e){return e.client.name}},currency:{name:"Currency",value:function(e){return e.client.currency}},project:{name:"Project",value:function(e){return e.project.name}},project_code:{name:"Project Code",value:function(e){return e.project.code}},task:{name:"Task",value:function(e){return e.task.name}}};function D(e){return N.apply(this,arguments)}function N(){return(N=Object(d.a)(s.a.mark((function e(t){var r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.harvestapp.com/v2/users/me",{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 3:return r=e.sent,e.next=6,r.json();case 6:return n=e.sent,e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Harvest login failed. Please check your credentials.");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function z(e,t){return H.apply(this,arguments)}function H(){return(H=Object(d.a)(s.a.mark((function e(t,r){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.harvestapp.com/v2/projects/".concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Harvest sync failed. Please check your credentials.");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function P(e,t){return L.apply(this,arguments)}function L(){return(L=Object(d.a)(s.a.mark((function e(t,r){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.harvestapp.com/v2/clients/".concat(r),{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(0),new Error("Harvest sync failed. Please check your credentials.");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function B(e,t,r,n,a){return M.apply(this,arguments)}function M(){return(M=Object(d.a)(s.a.mark((function e(t,r,n,a,o){var i,c,u,d,l,p=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=p.length>5&&void 0!==p[5]?p[5]:1,e.prev=1,e.next=4,fetch("https://api.harvestapp.com/v2/time_entries?from=".concat(r,"&to=").concat(n,"&").concat(a,"=").concat(o,"&page=").concat(i),{method:"GET",headers:{Authorization:"Bearer ".concat(t.HARVEST_ACCESS_TOKEN),"Harvest-Account-Id":t.HARVEST_ACCOUNT_ID,"User-Agent":"Harvest2Sheet"}});case 4:return c=e.sent,e.next=7,c.json();case 7:return u=e.sent,d=u.time_entries,l=u.total_pages,e.abrupt("return",{timeEntries:d,totalPages:parseInt(l)});case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function F(e){var t={},r=[];e.forEach((function(e){var n=R.user.value(e),a=R.date.value(e);t[n]||(t[n]={days:0,bucket:0,entries:{}});var o=R.rounded_hours.value(e);t[n].entries[a]?t[n].entries[a]+=o:t[n].entries[a]=o,r.includes(a)||r.push(a)}));var n=[""],a=["Total full days"],o=["Total remaining bucket hours"],i=["Rounded bucket days"],c=["All days"],s=[],u=0;return Object.keys(t).forEach((function(e,r){n.push(e);var s=Object.entries(t[e].entries);s.length>u&&(u=s.length),s.forEach((function(r){var n=Object(l.a)(r,2),a=(n[0],n[1]);Math.round(a)>=6?t[e].days++:t[e].bucket+=a})),a.push(t[e].days),o.push(t[e].bucket);var d=function(e){var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r=Math.floor(e/t.length);return"".concat(r>0?t[r-1]:"").concat(t[e-t.length*r])}(r+1);i.push("=ROUND(".concat(d,"3/8)")),c.push("=SUM(".concat(d,"2,").concat(d,"4)"))})),r.forEach((function(e){var r=[e];Object.keys(t).forEach((function(n){var a=t[n].entries[e];r.push(a||"")})),s.push(r)})),[n,a,o,i,c,[],["Timesheet by dates"]].concat(s)}function U(e,t,r,n){return V.apply(this,arguments)}function V(){return(V=Object(d.a)(s.a.mark((function e(t,r,n,a){var o,i,c,u,l,p,b,m,f,h,g=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=g.length>4&&void 0!==g[4]?g[4]:"project_id",i=[],c=Object(I.a)("".concat(n,"-01T00:00:00.000Z")),Object(A.a)(c)&&"Invalid Date"!==c.toString()){e.next=6;break}return console.error("The date passed in is not valid"),e.abrupt("return");case 6:return u=Object(_.a)(Object(T.a)(c)),l=[a.map((function(e){return R[e]?R[e].name:"unknown"}))],e.prev=8,e.next=11,B(t,Object(E.a)(c,"yyyyMMdd"),Object(E.a)(u,"yyyyMMdd"),o,r);case 11:if(b=e.sent,m=b.timeEntries,f=b.totalPages,p=Object(C.a)(m),!(f>1)){e.next=18;break}return e.next=18,Promise.all(Array(f-1).fill().map(function(){var e=Object(d.a)(s.a.mark((function e(n,a){var i,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(t,Object(E.a)(c,"yyyyMMdd"),Object(E.a)(u,"yyyyMMdd"),o,r,a+2);case 2:i=e.sent,d=i.timeEntries,p=[].concat(Object(C.a)(p),Object(C.a)(d));case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()));case 18:p=p.sort((function(e,t){return parseInt(e.spent_date.replace(/-/g,""))-parseInt(t.spent_date.replace(/-/g,""))})),h=p.map((function(e){return a.map((function(t){return R[t]?R[t].value(e):""}))})),l=[].concat(Object(C.a)(l),Object(C.a)(h)),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(8),i.push(e.t0);case 26:return e.abrupt("return",{csv:l,allData:p,errors:i.length?i.join("\n"):null});case 27:case"end":return e.stop()}}),e,null,[[8,23]])})))).apply(this,arguments)}function G(e,t){return q.apply(this,arguments)}function q(){return(q=Object(d.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t,resource:{requests:[{addSheet:{properties:{title:r,tabColor:{red:155,green:155,blue:155}}}}]}});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function W(e,t){return K.apply(this,arguments)}function K(){return(K=Object(d.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.gapi.client.sheets.spreadsheets.values.clear({spreadsheetId:t,range:"".concat(r,"!A1:ZZZ9999")});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t,r){return J.apply(this,arguments)}function J(){return(J=Object(d.a)(s.a.mark((function e(t,r,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.gapi.client.sheets.spreadsheets.values.append({spreadsheetId:t,range:r,valueInputOption:"USER_ENTERED",insertDataOption:"OVERWRITE",resource:{values:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return window.gapi.client?Promise.resolve():new Promise(function(){var r=Object(d.a)(s.a.mark((function r(n,a){return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t>2&&a("Google login failed. Check you credentials."),r.prev=1,r.next=4,window.gapi.load("client:auth2",function(){var r=Object(d.a)(s.a.mark((function r(o){return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,window.gapi.client.init({apiKey:e.GOOGLE_API_KEY,clientId:"75225162198-vsj9mtn0o9tf0ru487t4he9a90mrd2mp.apps.googleusercontent.com",discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"],scope:"https://www.googleapis.com/auth/spreadsheets"});case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),a("Google login failed. Check you credentials.");case 8:if(!window.gapi.auth2.getAuthInstance().isSignedIn.get()){r.next=13;break}n(),r.next=24;break;case 13:return r.prev=13,r.next=16,window.gapi.auth2.getAuthInstance().signIn();case 16:return r.next=18,Z(e,t+1);case 18:n(),r.next=24;break;case 21:r.prev=21,r.t1=r.catch(13),a(r.t1);case 24:case"end":return r.stop()}}),r,null,[[0,5],[13,21]])})));return function(e){return r.apply(this,arguments)}}());case 4:r.next=9;break;case 6:r.prev=6,r.t0=r.catch(1),a(r.t0);case 9:case"end":return r.stop()}}),r,null,[[1,6]])})));return function(e,t){return r.apply(this,arguments)}}())}function $(e,t){return Q.apply(this,arguments)}function Q(){return(Q=Object(d.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t);case 2:return e.next=4,window.gapi.client.sheets.spreadsheets.get({spreadsheetId:r});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t,r,n,a){return ee.apply(this,arguments)}function ee(){return(ee=Object(d.a)(s.a.mark((function e(t,r,n,a,o){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(t);case 2:return e.next=4,G(r,o);case 4:return e.next=6,W(r,o);case 6:return e.next=8,Y(r,o,a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){var t=e.children,r=e.size,n=void 0===r?"md":r;return Object(p.a)("div",{css:{maxWidth:{sm:"50rem",md:"60rem",lg:"93.75rem"}[n],background:"#fff",margin:"1rem auto",padding:"1rem",boxShadow:"0 0 1rem 0.25rem rgba(0, 0, 0, 0.4)","@media (min-width: 37.5rem)":{padding:"2rem"}},children:t})}var re=r(18);function ne(e){var t=e.children,r=e.loading,n=e.look,o=void 0===n?"default":n,i=e.as,c=void 0===i?"button":i,s=Object(re.a)(e,["children","loading","look","as"]),d={default:{"--gradient":"linear-gradient(to right, var(--bg-color1) 0%, var(--bg-color2) 100%)"},muted:{"--gradient":"linear-gradient(to right, #ccc 0%, #555 50%, #ccc 100%)",":hover:before, :focus:before":s.disabled?{}:{filter:"invert(1)"}}},l=Object(a.b)({to:{transform:"rotate( 360deg )"}});return Object(p.a)(c,Object(u.a)(Object(u.a)({disabled:r,css:Object(u.a)({position:"relative",display:"inline-block",border:"none",background:"#fff",apperance:"none",fontSize:"1rem",cursor:"pointer",lineHeight:1,padding:"3px",borderRadius:"6px",margin:"1rem 0 0 0",textDecoration:"none",":before":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,background:"var(--gradient)",borderRadius:"8px",transition:"filter 0.3s ease",zIndex:1},":after":{content:'""',display:r?"block":"none",position:"absolute",top:"50%",left:"50%",marginLeft:"-0.75rem",marginTop:"-0.75rem",width:"1.5rem",height:"1.5rem",border:"3px solid #ccc",borderTopColor:"var(--text)",borderRadius:"100%",animation:"".concat(l," 0.6s linear infinite"),zIndex:2},":disabled":{opacity:.4},":hover:before":s.disabled?{}:{filter:"hue-rotate(180deg)"},":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}},d[o]?d[o]:{})},s),{},{children:Object(p.a)("span",{css:{position:"relative",display:"block",background:"#fff",padding:"0.5rem 2.5rem",borderRadius:"6px",zIndex:2},children:t})}))}function ae(e){var t=e.id,r=e.label,n=e.required,o=e.maxWidth,i=void 0===o?"17rem":o,c=e.loading,s=void 0!==c&&c,d=e.help,l=void 0===d?"":d,b=e.visible,m=void 0===b||b,f=Object(re.a)(e,["id","label","required","maxWidth","loading","help","visible"]),h=Object(a.b)({to:{transform:"rotate( 360deg )"}});return Object(p.b)("li",{css:{display:m?"block":"none",marginBottom:"0.5rem","@media (min-width: 37.5rem)":{display:m?"grid":"none",gridTemplateColumns:"".concat(i," auto")}},children:[Object(p.a)("label",{htmlFor:t,css:{display:"inline-block",margin:"1rem 0.5rem 0.5rem 0",fontSize:"1.5rem",alignSelf:"center",whiteSpace:"nowrap","@media (min-width: 37.5rem)":{margin:"0 0.5rem 0 0"}},children:r}),Object(p.b)("div",{css:{position:"relative",":after":{content:'""',display:s?"block":"none",position:"absolute",top:"10px",left:"50%",marginLeft:"-0.75rem",width:"1.5rem",height:"1.5rem",border:"3px solid #ccc",borderTopColor:"var(--text)",borderRadius:"100%",animation:"".concat(h," 0.6s linear infinite")}},children:[Object(p.a)("input",Object(u.a)({id:t,type:"text",css:{fontSize:"1.5rem",padding:l?"0.5rem 1.5rem 0.5rem 0.5rem":"0.5rem",margin:0,border:"1px solid #767676",borderRadius:"0.2rem",apperance:"none",width:"100%",color:"var(--text)",":focus":{boxShadow:"0 0 0 3px #006cff",borderColor:"#006cff",outline:"none"},":disabled":{background:"var(--alt-bg)"}},required:!!m&&n},f)),l&&Object(p.a)("button",{type:"button","aria-label":"Help",css:{position:"absolute",top:"5px",right:"5px",display:"inline-block",background:"#fff",apperance:"none",fontSize:"1rem",cursor:"pointer",lineHeight:1,border:"1px solid var(--text)",borderRadius:"100%",width:"1rem",height:"1rem",padding:0,margin:0,":before":{content:'"?"',position:"absolute",top:"50%",left:"0",margin:"-0.5em 0 0 0",fontSize:"0.75rem",width:"100%",textAlign:"center"},":focus, :hover":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}},children:Object(p.a)("div",{css:{display:"none",position:"absolute",width:"max-content",maxWidth:"93vw",right:"-0.4rem",top:"2.6rem",background:"#fff",border:"3px solid var(--info)",padding:"0.5rem",whiteSpace:"nowrap",textAlign:"right",zIndex:4,":before":{content:'""',position:"absolute",top:"-1.7rem",right:"0.6rem",width:"3px",height:"1.7rem",background:"var(--info)"},"button:focus > &, button:active > &, button:hover > &":{display:"block"},"& img":{maxWidth:"100%"},"@media (min-width: 63.75rem)":{maxWidth:"59.375rem"}},children:l})})]})]})}function oe(e){var t=e.handleLogin,r=e.inputLines,n=e.loading,o=e.error,i=Object(a.b)({to:{transform:"rotate( 360deg )"}});return Object(p.b)(b.Fragment,{children:[Object(p.a)("h1",{css:{fontFamily:'"Playfair Display", "PT Serif", Cambria, "Hoefler Text", Utopia, "Liberation Serif", "Nimbus Roman No9 L Regular", Times, "Times New Roman", serif',fontStyle:"italic",fontSize:"20vw",margin:"0 0 5vw 0",textAlign:"center",fontWeight:700,textShadow:"0 1.8vw 1.8vw #333",color:"#fff","@media (min-width: 125rem)":{fontSize:"25rem",marginBottom:"6.25rem",textShadow:"0 2.25rem 2.25rem #333"}},children:"Login"}),Object(p.a)(te,{children:Object(p.b)("form",{onSubmit:t,css:{position:"relative",margin:0,padding:0,":after":{content:'""',display:n?"block":"none",position:"absolute",top:"50%",left:"50%",marginLeft:"-2.5rem",marginTop:"-2.5rem",width:"5rem",height:"5rem",border:"0.75rem solid #aaa",borderTopColor:"var(--text)",borderRadius:"100%",animation:"".concat(i," 0.5s linear infinite")}},children:[Object(p.a)("ul",{css:{listStyle:"none",padding:0,margin:0,opacity:n?.4:1},children:r.map((function(e){var t=e.id,r=e.label,a=e.value,o=e.setValue,i=e.help;return Object(p.a)(ae,{required:!0,id:t,label:r,value:a,help:i,disabled:n,onChange:function(e){return o(e.target.value)}},t)}))}),Object(p.a)("div",{css:{display:"grid",gridTemplateColumns:"1fr",justifyItems:"end"},children:Object(p.a)(ne,{type:"submit",disabled:n,children:"Save login"})}),o&&Object(p.a)("span",{css:{display:"inline-block",marginTop:"1rem",color:"var(--danger)"},children:o})]})})]})}var ie=r(16),ce=r(14);function se(e){var t=e.children,r=e.confirm,n=e.onClick,o=e.icon,i=e.look,c=void 0===i?"add":i,s=e.as,d=void 0===s?"button":s,m=Object(re.a)(e,["children","confirm","onClick","icon","look","as"]),f=Object(b.useState)(!1),h=Object(l.a)(f,2),g=h[0],v=h[1],j=Object(b.useState)(!1),O=Object(l.a)(j,2),x=O[0],y=O[1],w=Object(b.useState)([]),S=Object(l.a)(w,2),k=S[0],C=S[1],T=Object(a.b)({"0%":{transform:"scale(0.6)",opacity:0},"33%":{transform:"scale(1)",opacity:1},"100%":{transform:"scale(1.4)",opacity:0}}),I=Object(a.b)({"0%":{boxShadow:"0 0 0 3px rgba(255, 255, 255, 0.2)",opacity:0},"33%":{boxShadow:"0 0 0 10px rgba(255, 255, 255, 0.2)",opacity:1},"100%":{boxShadow:"0 0 0 16px rgba(255, 255, 255, 0.2)",opacity:0}}),_={"import-export":{":before, :after":{content:'""',position:"absolute",top:"50%",left:"14px",width:"10px",height:"10px",marginTop:"-5px",border:"3px solid var(--text)",borderRadius:"100% 0 100% 100%",transform:"rotate(45deg)",transition:"border 0.2s ease"},":after":{left:"25px",borderRadius:"100% 100% 100% 0"},":hover":{background:"var(--info)",color:"#fff"},":hover:before, :hover:after":{borderColor:"#fff"}},import:{":before":{content:'""',position:"absolute",top:"50%",left:"20px",width:"3px",height:"10px",marginTop:"-6px",background:"var(--text)",borderRadius:"2px",transition:"background 0.2s ease"},":after":{content:'""',position:"absolute",top:"50%",left:"17px",width:"9px",height:"9px",marginTop:"-3px",border:"3px solid var(--text)",borderStyle:"none solid solid none",transform:"rotate(45deg)",borderRadius:"2px",transition:"border 0.2s ease"},":hover":{background:"var(--info)",color:"#fff"},":hover:before":{background:"#fff"},":hover:after":{borderColor:"#fff"}},export:{":before":{content:'""',position:"absolute",top:"50%",left:"17px",width:"9px",height:"9px",marginTop:"-6px",border:"3px solid var(--text)",borderStyle:"solid none none solid",transform:"rotate(45deg)",borderRadius:"2px",transition:"border 0.2s ease"},":after":{content:'""',position:"absolute",top:"50%",left:"20px",width:"3px",height:"10px",marginTop:"-4px",background:"var(--text)",borderRadius:"2px",transition:"background 0.2s ease"},":hover":{background:"var(--info)",color:"#fff"},":hover:before":{borderColor:"#fff"},":hover:after":{background:"#fff"}},adjust:{":before":{content:'""',position:"absolute",top:"50%",left:"14px",width:"14px",height:"14px",marginTop:"-7px",border:"6px solid var(--text)",borderRadius:"100%",transition:"border 0.2s ease"},":after":{content:'""',position:"absolute",boxSizing:"content-box",top:"50%",left:"12px",width:"10px",height:"10px",marginTop:"-9px",border:"4px dotted var(--text)",borderRadius:"100%",transition:"border 0.2s ease"},":hover":{background:"var(--info)",color:"#fff"},":hover:before, :hover:after":{borderColor:"#fff"}},logout:{background:"#fff",padding:o?"0.5rem 1rem 0.5rem 2rem":"0.5rem 1rem",":hover":{background:"var(--danger)",color:"#fff"}},sync:{background:m.disabled?"var(--alt-bg)":"var(--confirm)",color:m.disabled?"var(--text)":"#fff",cursor:m.disabled?"not-allowed":"pointer",":before":{content:'""',position:"absolute",top:"50%",left:"0.5rem",width:"1.5rem",height:"1.5rem",marginTop:"-0.75rem",background:"rgba(255,255,255, 0.2)",borderRadius:"50px",opacity:0,animation:m.disabled?"none":"".concat(T," 3s 2s infinite linear")},":after":{content:'""',position:"absolute",top:"50%",left:"1rem",width:"4px",height:"4px",marginTop:"-2px",marginLeft:"2px",background:m.disabled?"var(--text)":"#fff",borderRadius:"50%",boxShadow:"0 0 0 1px rgba(255, 255, 255, 0.2)",animation:m.disabled?"none":"".concat(I," 3s infinite linear")}},add:{":before, :after":{content:'""',position:"absolute",width:"1rem",height:"0.25rem",background:"var(--text)",borderRadius:"2px",top:"50%",marginTop:"-0.125rem",left:"1rem",transition:"background 0.2s ease"},":after":{transform:"rotate(-90deg)"},":hover":{background:"var(--info)",color:"#fff"},":hover:before, :hover:after":{background:"#fff"}},delete:{":before, :after":{content:'""',position:"absolute",width:"1rem",height:"0.25rem",background:"var(--text)",borderRadius:"2px",transform:"rotate(45deg)",top:"50%",marginTop:"-0.125rem",left:"1rem",transition:"background 0.2s ease"},":after":{transform:"rotate(-45deg)"},":hover":{background:"var(--danger)",color:"#fff"},":hover:before, :hover:after":{background:"#fff"}},edit:{":before":{content:'""',position:"absolute",top:"50%",marginTop:"-0.5rem",left:"1rem",width:"0.9rem",height:"1rem",border:"2px solid var(--text)",transition:"border 0.2s ease"},":after":{content:'""',position:"absolute",top:"2px",left:"1.65rem",background:"var(--text)",width:"4px",height:"1rem",transform:"rotate(45deg)",borderRadius:"1px 1px 50% 50%",boxShadow:"0 0 0 2px var(--alt-bg)",transition:"background 0.2s ease, box-shadow 0.2s ease"},":hover":{background:"var(--confirm)",color:"#fff"},":hover:before":{borderColor:"#fff"},":hover:after":{background:"#fff",boxShadow:"0 0 0 2px var(--confirm)"}}};return Object(p.b)(d,Object(u.a)(Object(u.a)({css:Object(u.a)({position:"relative",display:"inline-block",apperance:"none",background:"var(--alt-bg)",color:"var(--text)",border:"none",borderRadius:"6px",padding:o?"0.5rem 1rem 0.5rem 2rem":"0.5rem 1rem 0.5rem 2.5rem",fontSize:"0.75rem",textDecoration:"none",textAlign:"center",lineHeight:1,transition:"background 0.2s ease, color 0.2s ease",overflow:"hidden",cursor:"pointer",":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}},_[c]?_[c]:{}),onClick:function(e){clearTimeout(k),C([]),r&&!g?(e.preventDefault(),y(!0),C(setTimeout((function(){v(!1),y(!1),C([])}),3e3))):("function"==typeof n&&n(),y(!1)),v(!g)}},m),{},{children:[o&&Object(p.a)("img",{src:o,alt:"",css:{position:"absolute",left:"6px",top:"3px",height:"22px",borderRadius:"100%"}}),x?"Sure?":t]}))}function ue(e){var t=e.id,r=e.checked,n=e.onChange,a=e.size,o=void 0===a?"lg":a,i=Object(re.a)(e,["id","checked","onChange","size"]),c={sm:{root:{width:"1rem",height:"1rem",border:"3px solid var(--text)"},before:{top:"-1px",right:"-3px",width:"0.75rem",height:"0.4rem",borderBottom:"2px solid var(--text)",borderLeft:"2px solid var(--text)"},after:{top:"-8px",right:"-8px",width:"0.55rem",height:"0.85rem"}},lg:{root:{width:"2rem",height:"2rem",border:"4px solid var(--text)"},before:{top:"-1px",right:"-5px",width:"1.5rem",height:"0.8rem",borderBottom:"4px solid var(--text)",borderLeft:"4px solid var(--text)"},after:{top:"-10px",right:"-10px",width:"0.8rem",height:"1.4rem"}}};return Object(p.b)("div",Object(u.a)(Object(u.a)({css:{position:"relative",display:"inline-block",overflow:"hidden"}},i),{},{children:[Object(p.a)("input",{id:t,type:"checkbox",checked:r,onChange:n,css:{position:"absolute",top:"-5rem",left:"-5rem"}}),Object(p.a)("span",{css:Object(u.a)(Object(u.a)({position:"relative",display:"block",borderRadius:"3px",zIndex:1,margin:"7px"},c[o].root),{},{":before":Object(u.a)({content:'""',display:"none",position:"absolute",transform:"rotate(-45deg)",zIndex:3},c[o].before),":after":Object(u.a)({content:'""',display:"none",position:"absolute",background:"#fff",zIndex:2},c[o].after),"input:checked + &:before,input:checked + &:after":{display:"block"},"input:focus + &":{boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}})})]}))}var de=r(43);function le(){var e=y(),t=S(),r=Object(b.useState)(!1),n=Object(l.a)(r,2),a=n[0],o=n[1],i=Object(b.useState)(!1),c=Object(l.a)(i,2),s=c[0],d=c[1],m=Object(b.useState)(!1),f=Object(l.a)(m,2),h=f[0],g=f[1],v=Object(b.useState)(""),j=Object(l.a)(v,2),O=j[0],x=j[1],C=Object(b.useState)(""),T=Object(l.a)(C,2),I=T[0],_=T[1],A=Object(ce.f)();return Object(p.b)(te,{children:[Object(p.a)("h2",{children:"Export"}),Object(p.b)("label",{css:{display:"grid",gridTemplateColumns:"2rem 1fr",alignItems:"center",margin:"0 0 0 0.5rem"},children:[Object(p.a)(ue,{size:"sm",id:"includeOutput",checked:a,onChange:function(e){return o(e.target.checked)}}),"Include Output"]}),Object(p.a)(se,{look:"export",as:"a",href:"data:text/plain;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(Object(u.a)({version:de.a,sheets:e},a?{output:t}:{}),null,"\t"))),download:"harvest2sheet.export",css:{marginTop:"1rem"},children:"Export"}),Object(p.a)("h2",{css:{borderTop:"2px dashed var(--alt-bg)",paddingTop:"0.5rem",marginBottom:"1rem"},children:"Import"}),Object(p.b)("form",{onSubmit:function(t){if(t.preventDefault(),_(""),O){var r=new FileReader;r.onload=function(t){var r=t.target.result;try{if(r=JSON.parse(r),s&&r.sheets&&(h||(r.sheets=r.sheets.map((function(e){e.output;var t=Object(re.a)(e,["output"]);return Object(u.a)({output:1},t)}))),w(r.sheets)),h&&r.output){if(!s)w(e.map((function(e){e.output;var t=Object(re.a)(e,["output"]);return Object(u.a)({output:1},t)})));k(r.output)}A.push("/")}catch(I){_('The import file could not be read. Please make sure it\'s in the right format "harvest2sheet.export"'),x("")}},r.readAsText(O)}},children:[Object(p.b)("div",{css:{position:"relative",marginLeft:"1rem"},children:[Object(p.a)("input",{id:"file",type:"file",required:!0,onChange:function(e){return x(e.target.files[0])},css:{position:"absolute",opacity:0,width:"1px",left:"0.5rem",height:"1.5rem"}}),Object(p.a)("label",{htmlFor:"file",css:{position:"relative",display:"block",width:"12.5rem",height:"1.5rem",borderRadius:"6px",border:"3px solid var(--text)",margin:"0.5rem 0",":before":{content:'"Browse"',display:"flex",position:"absolute",left:0,bottom:0,top:0,width:"3.3rem",background:"var(--text)",color:"#fff",padding:"0 6px",fontSize:"0.75rem",alignItems:"center"},":after":{content:O&&O.name?'"'.concat(O.name,'"'):'"Choose file..."',display:"flex",position:"absolute",left:"3.8rem",bottom:0,top:0,width:"8rem",overflow:"hidden",whiteSpace:"nowrap",fontSize:"0.75rem",alignItems:"center",textAlign:"center"},"input:focus + &":{boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}}),Object(p.b)("label",{css:{display:"grid",gridTemplateColumns:"2rem 1fr",alignItems:"center",marginLeft:"-0.5rem"},children:[Object(p.a)(ue,{size:"sm",id:"overrideSheets",checked:s,onChange:function(e){return d(e.target.checked)}}),"Override sheets"]}),Object(p.b)("label",{css:{display:"grid",gridTemplateColumns:"2rem 1fr",alignItems:"center",marginLeft:"-0.5rem"},children:[Object(p.a)(ue,{size:"sm",id:"overrideOutput",checked:h,onChange:function(e){return g(e.target.checked)}}),"Override output"]})]}),I&&Object(p.a)("div",{css:{color:"var(--danger)"},children:I}),Object(p.a)(se,{look:"import",type:"submit",css:{marginTop:"1rem"},children:"Import"})]}),Object(p.a)(ne,{look:"muted",to:"/",as:ie.b,css:{marginTop:"1.5rem"},children:"Cancel"})]})}var pe=r(57);function be(e){var t=e.kind,r=Object(re.a)(e,["kind"]),n={project:{content:'"P"',title:"Project"},client:{content:'"C"',title:"Client"}};return Object(p.a)("span",Object(u.a)({title:t?n[t].title:null,css:Object(u.a)({display:"inline-block",background:"var(--alt-bg)",border:"1px solid #ccc",padding:"0 0.25rem",borderRadius:"3px",margin:"0.125rem",fontSize:"0.75rem"},t?{":before":{content:n[t].content,display:"inline-block",fontWeight:900,marginRight:"0.25rem",paddingRight:"0.25rem",borderRight:"1px solid #ccc"}}:{})},r))}function me(e){var t=e.id,r=e.name,n=e.hProjectName,a=e.hClientName,o=e.tabName,i=e.hourSummaryTabName,c=e.gSheetIDName,s=e.output,u=e.selected,d=e.toggle,l=e.deleteSheet;return Object(p.b)("div",{css:{display:"grid",gridTemplateColumns:"3rem auto",gap:"0.5rem",alignItems:"center","@media (min-width: 40rem)":{gridTemplateColumns:"3rem auto 12rem"}},children:[Object(p.a)("label",{css:{display:"block",width:"3rem",height:"3rem",cursor:"pointer"},children:Object(p.a)(ue,{id:t,checked:u.includes(t),onChange:function(){return d(t)},css:{margin:"2px"}})}),Object(p.b)("label",{htmlFor:t,css:{display:"block",cursor:"pointer"},children:[Object(p.a)("strong",{css:{display:"block"},children:r}),Object(p.b)("div",{css:{"@media (min-width: 40rem)":{display:"grid",gridTemplateColumns:"auto 1fr",gap:"1.75rem",alignItems:"center"}},children:[Object(p.a)("div",{css:{"@media (min-width: 40rem)":{position:"relative",":before":{content:'""',position:"absolute",top:"50%",right:"-1.25rem",height:"4px",width:"1rem",marginTop:"-2px",background:"var(--text)"},":after":{content:'""',position:"absolute",top:"50%",right:"-1.8rem",border:"6px solid var(--text)",borderColor:"transparent transparent transparent var(--text)",marginTop:"-6px"}}},children:Object(p.a)(be,{kind:n?"project":"client",children:n||a})}),Object(p.b)("div",{children:[Object(p.a)(be,{children:c}),Object(p.a)(be,{children:o}),i&&Object(p.a)(be,{children:i}),Object(p.b)(be,{children:[s.name," (",s.columns.length," columns)"]})]})]})]}),Object(p.b)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.5rem",alignItems:"center",gridColumn:"1 / 3","@media (min-width: 40rem)":{gridTemplateColumns:"1fr 1fr",gridColumn:"unset"}},children:[Object(p.a)(se,{look:"edit",as:ie.b,to:"/edit/".concat(t),children:"Edit"}),Object(p.a)(se,{confirm:!0,type:"button",look:"delete",onClick:function(){return l(t)},children:"Delete"})]})]})}function fe(){var e=O(),t=y(),r=S();0===r.length&&(r=[{id:1,name:"Default",columns:["date","user","client","project","task","hours","rounded_hours","notes","billable_rate","billable_amount","cost_rate","cost_amount","currency"]}],w(t.map((function(e){return Object(u.a)({output:1},e)}))),k(r));var n=Object(b.useState)(t),o=Object(l.a)(n,2),i=o[0],c=o[1],m=Object(b.useState)(Object(E.a)(Object(pe.a)(new Date,5),"yyyy-MM")),f=Object(l.a)(m,2),h=f[0],g=f[1],v=Object(b.useState)(!1),j=Object(l.a)(v,2),x=j[0],T=j[1],_=Object(b.useState)([]),A=Object(l.a)(_,2),R=A[0],D=A[1],N=Object(b.useState)("name"),z=Object(l.a)(N,2),H=z[0],P=z[1],L=Object(b.useState)(""),B=Object(l.a)(L,2),M=B[0],V=B[1],G=function(e,t){return"time"===t?e.sort((function(e,t){return e.name<t.name?-1:1})):e.sort((function(e,t){return e.id-t.id}))},q=function(e){return r.filter((function(t){return t.id===e}))[0]},W=function(e){var t=i.filter((function(t){return t.id!==e}));w(t),c(t)},K=function(e){if(R.includes(e)){var t=Object(C.a)(R).filter((function(t){return t!==e}));D(t)}else{var r=Object(C.a)(R);r.push(e),D(r)}},Y=function(){var t=Object(d.a)(s.a.mark((function t(r,n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),T(!0),a=i.filter((function(e){var t=e.id;return R.includes(t)})),t.next=5,Promise.all(a.map(function(){var t=Object(d.a)(s.a.mark((function t(r){var a,o,i,c,u,d,l,p,b;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.hProject,o=r.hClient,i=r.gSheetID,c=r.output,u=r.hourSummary,d=a||o,l=a?"project_id":"client_id",t.prev=3,t.next=6,U(e,d,h,q(c).columns,l);case 6:return p=t.sent,t.next=9,X(e,i,h,p.csv,n);case 9:if(!u){t.next=13;break}return b=F(p.allData),t.next=13,X(e,i,h,b,Q);case 13:D([]),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(3),console.error(t.t0);case 19:case"end":return t.stop()}}),t,null,[[3,16]])})));return function(e){return t.apply(this,arguments)}}()));case 5:T(!1);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),J=Object(a.b)({to:{transform:"rotate( 360deg )"}}),Z=Object(I.a)("".concat(7===h.length?h:"2020-01","-01T00:00:00.000Z")),$="H|".concat(Object(E.a)(Z,"LLL"),"'").concat(Object(E.a)(Z,"yy")),Q="".concat($,"|Summary");return Object(p.b)(te,{size:"lg",children:[Object(p.a)("h2",{children:"Sheets"}),Object(p.b)("div",{css:{display:"grid",gridTemplateColumns:"1fr",alignItems:"center","@media (min-width: 35.625rem)":{gridTemplateColumns:"auto 1fr"}},children:[Object(p.b)("div",{css:{"@media (min-width: 35.625rem)":{justifySelf:"start"}},children:[Object(p.a)(se,{look:"add",as:ie.b,to:"/add",children:"Add new"}),Object(p.a)(se,{look:"adjust",as:ie.b,to:"/output",css:{marginLeft:"0.5rem"},children:"Output"}),Object(p.a)(se,{look:"import-export",as:ie.b,to:"/import-export",css:{marginLeft:"0.5rem"},children:"Import/Export"})]}),Object(p.b)("form",{onSubmit:function(e){return Y(e,$)},css:{marginTop:"1rem","@media (min-width: 35.625rem)":{justifySelf:"end",marginTop:0}},children:[Object(p.a)("input",{type:"text",value:h,onChange:function(e){return g(e.target.value)},pattern:"\\d{4}-\\d{2}",title:"Please use the format year(4 numbers)-month(2 numbers). E.g.: 2020-09 or 2023-03",css:{display:"inline-block",apperance:"none",background:"#fff",border:"1px solid var(--text)",width:"7em",padding:"0.5rem",lineHeight:1,marginRight:"1rem",textAlign:"center",":invalid":{boxShadow:"0 0 0 3px var(--danger)"},":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}}),Object(p.a)(se,{look:"sync",type:"submit",disabled:!R.length,children:"Sync"})]})]}),Object(p.b)("button",{onClick:function(){D(i.map((function(e){return e.id})))},css:{border:"1px solid var(--text)",borderRadius:"3px",background:"transparent",apperance:"none",fontSize:"0.75rem",cursor:"pointer",margin:"1rem 0 0 0",padding:"0.25rem",":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}},children:["Select all (",i.length,")"]}),Object(p.b)("button",{onClick:function(){D([])},css:{border:"1px solid var(--text)",borderRadius:"3px",background:"transparent",apperance:"none",fontSize:"0.75rem",cursor:"pointer",margin:"1rem 0 0 0.5rem",padding:"0.25rem",":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}},children:["Deselect all (",R.length,")"]}),Object(p.b)("button",{onClick:function(){"time"===H?(P("name"),c(G(i,"name"))):(P("time"),c(G(i,"time")))},css:{border:"1px solid var(--text)",borderRadius:"3px",background:"transparent",apperance:"none",fontSize:"0.75rem",cursor:"pointer",margin:"1rem 0 0 0.5rem",padding:"0.25rem",":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}},children:["Sort by ",H]}),Object(p.a)("input",{type:"text",placeholder:"filter",value:M,onChange:function(e){V(e.target.value);var r=t.filter((function(t){return t.name.toLowerCase().includes(e.target.value.toLowerCase())}));c(G(r,H))},css:{apperance:"none",border:"1px solid var(--text)",fontSize:"0.75rem",margin:"1rem 0 0 0.5rem",padding:"0.25rem",width:"5rem",":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}}}),Object(p.a)("ul",{css:{position:"relative",listStyle:"none",padding:0,margin:"1rem 0 0 0",":after":{content:'""',display:x?"block":"none",position:"absolute",top:"50%",left:"50%",marginLeft:"-2.5rem",marginTop:"-2.5rem",width:"5rem",height:"5rem",border:"0.75rem solid #ccc",borderTopColor:"var(--text)",borderRadius:"100%",animation:"".concat(J," 0.5s linear infinite")}},children:i.map((function(e,t){var r=e.id,n=e.name,a=e.hProjectName,o=e.hClientName,i=e.gSheetIDName,c=e.output,s=void 0===c?1:c,u=e.hourSummary;return Object(p.a)("li",{css:{opacity:x?.2:1,marginTop:"1.5rem",marginLeft:"-9px",":not(:first-of-type)":{borderTop:"2px dashed var(--alt-bg)",paddingTop:"1rem"},"@media (min-width: 40rem)":{marginTop:"0.5rem"}},children:Object(p.a)(me,{id:r,name:n,hProjectName:a,hClientName:o,tabName:$,hourSummaryTabName:u?Q:null,gSheetIDName:i,output:q(s),selected:R,toggle:K,deleteSheet:W})},r)}))})]})}function he(){var e=Object(b.useState)(S()),t=Object(l.a)(e,2),r=t[0],n=t[1];return Object(p.b)(te,{children:[Object(p.a)("h2",{children:"Output"}),Object(p.a)(se,{look:"add",as:ie.b,to:"/output/add",children:"Add new"}),Object(p.a)("ul",{css:{listStyle:"none",padding:0,margin:0},children:r.map((function(e){var t=e.id,a=e.name,o=e.columns;return Object(p.b)("li",{css:{display:"grid",gridTemplateColumns:"auto",alignItems:"center",marginTop:"1.5rem",":not(:first-of-type)":{borderTop:"2px dashed var(--alt-bg)",paddingTop:"0.5rem"},"@media (min-width: 40rem)":{marginTop:"0.5rem",gridTemplateColumns:"auto 6rem",gap:"0.5rem"}},children:[Object(p.b)(ie.b,{to:"/output/".concat(t),css:{textDecoration:"none",":focus":{outline:"none",boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)"}},children:[Object(p.a)("strong",{css:{display:"block"},children:a}),Object(p.b)(be,{children:[o.length," columns"]})]}),1!==t?Object(p.a)(se,{confirm:!0,type:"button",look:"delete",onClick:function(){return function(e){if(1!==e){w(y().map((function(t){var r=t.output,n=Object(re.a)(t,["output"]);return r===e?Object(u.a)({output:1},n):Object(u.a)({output:r},n)})));var t=r.filter((function(t){return t.id!==e}));k(t),n(t)}}(t)},children:"Delete"}):null]},t)}))}),Object(p.a)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",justifyItems:"start"},children:Object(p.a)(ne,{look:"muted",to:"/",as:ie.b,children:"Cancel"})})]})}var ge=r(51),ve=r(8),je=r(45);var Oe=Object(ge.b)((function(e){var t={onMouseDown:function(e){e.preventDefault(),e.stopPropagation()}};return Object(p.a)(ve.z.MultiValue,Object(u.a)(Object(u.a)({},e),{},{innerProps:t}))})),xe=Object(ge.a)(je.a);function ye(e){var t=e.match.params.itemID;t=parseInt(t);var r=S(),n="",a=[];if(t){var o=r.filter((function(e){return e.id===t}));1===o.length&&(n=o[0].name,a=o[0].columns.map((function(e){return{value:e,label:R[e].name}})))}var i=Object(b.useState)(n),c=Object(l.a)(i,2),s=c[0],d=c[1],m=Object(b.useState)(a),f=Object(l.a)(m,2),h=f[0],g=f[1],v=Object(ce.f)(),j=Object.entries(R).map((function(e){var t=Object(l.a)(e,2);return{value:t[0],label:t[1].name}})),O={container:function(e){return h&&h.length?e:Object(u.a)(Object(u.a)({},e),{},{boxShadow:"0 0 0 3px var(--danger)"})},control:function(e){return Object(u.a)(Object(u.a)({},e),{},{borderColor:"#767676",":hover":Object(u.a)({borderColor:"#767676"},e[":hover"])})}};return Object(p.b)(te,{size:"sm",children:[Object(p.b)("h2",{children:[t?"Edit":"Add"," Output"]}),Object(p.b)("form",{onSubmit:function(e){e.preventDefault(),h.length>0&&(t?r=r.map((function(e){return e.id===t?{id:e.id,name:s,columns:h.map((function(e){return e.value}))}:e})):r.push({id:r.length?r[r.length-1].id+1:1,name:s,columns:h.map((function(e){return e.value}))}),k(r),v.push("/output"))},css:{margin:0,padding:0},children:[Object(p.b)("ul",{css:{listStyle:"none",padding:0,margin:0},children:[Object(p.a)(ae,{required:!0,id:"name",label:"Name",value:s,onChange:function(e){return d(e.target.value)},maxWidth:"8rem"}),Object(p.b)("li",{css:{marginBottom:"0.5rem","@media (min-width: 37.5rem)":{display:"grid",gridTemplateColumns:"8rem auto"}},children:[Object(p.a)("label",{htmlFor:"columns",css:{display:"inline-block",margin:"1rem 0.5rem 0.5rem 0",fontSize:"1.5rem",alignSelf:"center",whiteSpace:"nowrap","@media (min-width: 37.5rem)":{margin:"0 0.5rem 0 0"}},children:"Columns"}),Object(p.a)(xe,{inputId:"columns",axis:"xy",onSortEnd:function(e){var t,r,n,a=e.oldIndex,o=e.newIndex,i=(r=a,n=o,(t=(t=h).slice()).splice(n<0?t.length+n:n,0,t.splice(r,1)[0]),t);g(i)},distance:4,getHelperDimensions:function(e){return e.node.getBoundingClientRect()},isMulti:!0,options:j,value:h,styles:O,onChange:function(e){return g(e)},components:{MultiValue:Oe},closeMenuOnSelect:!1,css:{zIndex:3}})]})]}),Object(p.b)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",justifyItems:"start"},children:[Object(p.a)(ne,{look:"muted",to:"/output",as:ie.b,children:"Cancel"}),Object(p.b)(ne,{type:"submit",css:{justifySelf:"end"},children:[t?"Edit":"Add"," output"]})]})]})]})}var we=r.p+"static/media/harvest-project-id.28b3bcd2.png",Se=r.p+"static/media/harvest-client-id.eb1348b8.png",ke=r.p+"static/media/spreadsheet-id.3133f048.png";function Ce(e){var t=e.match.params.sheetID;t=parseInt(t);var r=S(),n=r.map((function(e){var t=e.id;return{label:e.name,value:t}})),a=y(),o="",i="",c="",m="",f="",h="",g="",v="",j=!0,x="project";if(t){var k=a.filter((function(e){return e.id===t}));1===k.length&&(o=k[0].hProject,i=k[0].hProjectName,c=k[0].hClient,m=k[0].hClientName,f=k[0].gSheetID,h=k[0].gSheetIDName,g=k[0].name,v=r.filter((function(e){return e.id===k[0].output})).map((function(e){var t=e.id;return{label:e.name,value:t}}))[0],j=!!k[0].hourSummary,c&&(x="client"))}var C=Object(b.useState)(!1),T=Object(l.a)(C,2),I=T[0],_=T[1],A=Object(b.useState)(!1),E=Object(l.a)(A,2),R=E[0],D=E[1],N=Object(b.useState)(!1),H=Object(l.a)(N,2),L=H[0],B=H[1],M=Object(b.useState)(o),F=Object(l.a)(M,2),U=F[0],V=F[1],G=Object(b.useState)(i),q=Object(l.a)(G,2),W=q[0],K=q[1],Y=Object(b.useState)(c),J=Object(l.a)(Y,2),Z=J[0],Q=J[1],X=Object(b.useState)(m),ee=Object(l.a)(X,2),re=ee[0],oe=ee[1],se=Object(b.useState)(f),de=Object(l.a)(se,2),le=de[0],pe=de[1],be=Object(b.useState)(h),me=Object(l.a)(be,2),fe=me[0],he=me[1],ge=Object(b.useState)(g),ve=Object(l.a)(ge,2),Oe=ve[0],xe=ve[1],ye=Object(b.useState)(v),Ce=Object(l.a)(ye,2),Te=Ce[0],Ie=Ce[1],_e=Object(b.useState)(j),Ae=Object(l.a)(_e,2),Ee=Ae[0],Re=Ae[1],De=Object(b.useState)(x),Ne=Object(l.a)(De,2),ze=Ne[0],He=Ne[1],Pe=Object(ce.f)(),Le=O(),Be=function(){var e=Object(d.a)(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(!0),K(""),e.prev=2,e.next=5,z(Le,U);case 5:t=e.sent,r=t.name,K(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),K("- not found -");case 13:_(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),Me=function(){var e=Object(d.a)(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),K(""),e.prev=2,e.next=5,P(Le,Z);case 5:t=e.sent,r=t.name,oe(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),oe("- not found -");case 13:D(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(d.a)(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),he(""),e.prev=2,e.next=5,$(Le,le);case 5:t=e.sent,r=t.result.properties.title,he(r||""),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),he("- not found -");case 13:B(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}(),Ue={container:function(e){return Te?e:Object(u.a)(Object(u.a)({},e),{},{boxShadow:"0 0 0 3px var(--danger)"})},control:function(e){return Object(u.a)(Object(u.a)({},e),{},{borderColor:"#767676",fontSize:"1.5rem",padding:"0.25rem 0",":hover":Object(u.a)({borderColor:"#767676"},e[":hover"])})}},Ve=["project","client"];return Object(p.b)(te,{children:[Object(p.b)("h2",{children:[t?"Edit a":"Add a new"," sheet"]}),Object(p.b)("form",{onSubmit:function(e){e.preventDefault(),("project"===ze?"- not found -"!==W&&""!==W&&W:"- not found -"!==re&&""!==re&&re)&&"- not found -"!==fe&&""!==fe&&fe&&Te&&(t?a=a.map((function(e){return e.id===t?{id:e.id,name:Oe,hProject:"project"===ze?U:"",hProjectName:"project"===ze?W:"",hClient:"client"===ze?Z:"",hClientName:"client"===ze?re:"",gSheetID:le,gSheetIDName:fe,output:Te.value,hourSummary:Ee}:e})):a.push({id:a.length?a[a.length-1].id+1:1,name:Oe,hProject:"project"===ze?U:"",hProjectName:"project"===ze?W:"",hClient:"client"===ze?Z:"",hClientName:"client"===ze?re:"",gSheetID:le,gSheetIDName:fe,output:Te.value,hourSummary:Ee}),w(a),Pe.push("/"))},css:{margin:0,padding:0},children:[Object(p.b)("ul",{css:{listStyle:"none",padding:0,margin:0},children:[Object(p.a)(ae,{required:!0,id:"name",label:"Name",value:Oe,help:Object(p.b)("span",{children:["The name of this item",Object(p.a)("br",{}),"Only important for you to organise your items"]}),onChange:function(e){return xe(e.target.value)}}),Object(p.a)("li",{css:{margin:"1rem 0 0 0","@media (min-width: 37.5rem)":{paddingLeft:"17rem",margin:"0 0 0.5rem 0"}},children:Object(p.a)("button",{type:"button",onClick:function(){var e=Ve.indexOf(ze)+1;e>Ve.length-1&&(e=0),He(Ve[e])},css:{display:"grid",gridTemplateColumns:"1fr 1fr",apperance:"none",background:"transparent",border:"1px solid var(--text)",borderRadius:"6px",fontSize:"1rem",cursor:"pointer",lineHeight:1,padding:0,width:"100%",overflow:"hidden",":focus":{boxShadow:"0 0 0 2px #fff, 0 0 0 5px var(--focus)",outline:"none"}},children:Ve.map((function(e){return Object(p.b)("span",{css:{background:e===ze?"var(--text)":"var(--alt-bg)",color:e===ze?"#fff":"var(--text)",padding:"0.5rem",transition:"background 0.3s ease, color 0.3s ease"},children:["Use ",e," ID"]},e)}))})}),Object(p.a)(ae,{required:!0,id:"hProject",label:"Harvest Project ID",value:U,visible:"project"===ze,help:Object(p.a)("img",{src:we,alt:"The project ID can be found in the url of the project website in harvest."}),onChange:function(e){V(e.target.value),K("")},onBlur:Be}),Object(p.a)(ae,{required:!0,id:"hProjectName",label:"Harvest Project Name",value:W,disabled:!0,loading:I,readOnly:!0,visible:"project"===ze,css:Object(u.a)({},"- not found -"!==W&&""!==W&&W?{}:{boxShadow:"0 0 0 3px var(--danger)"})}),Object(p.a)(ae,{required:!0,id:"hClient",label:"Harvest Client ID",value:Z,visible:"client"===ze,help:Object(p.a)("img",{src:Se,alt:"The project ID can be found in the url of the project website in harvest."}),onChange:function(e){Q(e.target.value),oe("")},onBlur:Me}),Object(p.a)(ae,{required:!0,id:"hClientName",label:"Harvest Client Name",value:re,disabled:!0,loading:R,readOnly:!0,visible:"client"===ze,css:Object(u.a)({},"- not found -"!==re&&""!==re&&re?{}:{boxShadow:"0 0 0 3px var(--danger)"})}),Object(p.a)(ae,{required:!0,id:"gSheetID",label:"Spreadsheet ID",value:le,help:Object(p.a)("img",{src:ke,alt:"The spreadsheet ID can be found in the url of the google spreadsheet."}),onChange:function(e){pe(e.target.value),he("")},onBlur:Fe}),Object(p.a)(ae,{required:!0,id:"gSheetIDName",label:"Sheet Name",value:fe,disabled:!0,loading:L,readOnly:!0,css:Object(u.a)({},"- not found -"!==fe&&""!==fe&&fe?{}:{boxShadow:"0 0 0 3px var(--danger)"})}),Object(p.b)("li",{css:{position:"relative",zIndex:3,marginBottom:"0.5rem","@media (min-width: 37.5rem)":{display:"grid",gridTemplateColumns:"17rem auto"}},children:[Object(p.a)("label",{htmlFor:"output",css:{display:"inline-block",margin:"1rem 0.5rem 0.5rem 0",fontSize:"1.5rem",alignSelf:"center",whiteSpace:"nowrap","@media (min-width: 37.5rem)":{margin:"0 0.5rem 0 0"}},children:"Output"}),Object(p.a)(je.a,{inputId:"output",options:n,value:Te,onChange:Ie,styles:Ue})]}),Object(p.a)("li",{css:{marginBottom:"0.5rem","@media (min-width: 37.5rem)":{marginLeft:"16.5rem"}},children:Object(p.b)("label",{css:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center",fontSize:"1.5rem"},children:[Object(p.a)(ue,{id:"hourSummary",checked:Ee,onChange:function(){return Re(!Ee)}}),"Generate summary sheet"]})})]}),Object(p.b)("div",{css:{display:"grid",gridTemplateColumns:"1fr 1fr",justifyItems:"start"},children:[Object(p.a)(ne,{look:"muted",to:"/",as:ie.b,children:"Cancel"}),Object(p.b)(ne,{type:"submit",loading:I||R||L,css:{justifySelf:"end"},children:[t?"Edit":"Add"," sheet"]})]})]})]})}function Te(e){var t=e.handleLogout,r=Object(b.useState)(["rgb(1, 255, 251)","rgb(183, 1, 255)"]),n=Object(l.a)(r,2),o=n[0],i=n[1],c=Object(b.useState)(0),s=Object(l.a)(c,2),u=s[0],d=s[1],m=O().avatar_url;return Object(p.b)(b.Fragment,{children:[Object(p.a)(a.a,{styles:{html:{"--bg-color1":o[0],"--bg-color2":o[1]}}}),Object(p.a)("h1",{css:{fontFamily:'"Playfair Display", "PT Serif", Cambria, "Hoefler Text", Utopia, "Liberation Serif", "Nimbus Roman No9 L Regular", Times, "Times New Roman", serif',fontStyle:"italic",fontSize:"10vw",lineHeight:1,margin:"1vw 0 3vw 0",textAlign:"center",fontWeight:700,textShadow:"0 0 1px #000, 0 1.8vw 1.8vw #333",color:"#fff","@media (min-width: 75rem)":{fontSize:"7.5rem",margin:"0.75rem 0 2.25rem 0",textShadow:"0 0 1px #000, 0 1.34375rem 1.34375rem #333"}},children:"Harvest 2 Sheet"}),Object(p.a)(se,{look:"logout",onClick:t,icon:m||null,confirm:!0,css:{display:"block",margin:"0 auto","@media (min-width: 41.875rem)":{position:"absolute",top:"1rem",right:"1rem"}},children:"Logout"}),Object(p.a)(ie.a,{children:Object(p.b)(ce.c,{children:[Object(p.a)(ce.a,{exact:!0,path:"/",component:fe}),Object(p.a)(ce.a,{exact:!0,path:"/add",component:Ce}),Object(p.a)(ce.a,{exact:!0,path:"/edit/:sheetID",component:Ce}),Object(p.a)(ce.a,{exact:!0,path:"/output",component:he}),Object(p.a)(ce.a,{exact:!0,path:"/output/add",component:ye}),Object(p.a)(ce.a,{exact:!0,path:"/output/:itemID",component:ye}),Object(p.a)(ce.a,{exact:!0,path:"/import-export",component:le})]})}),Object(p.a)("div",{css:{display:"block",padding:"1rem",textAlign:"right",color:"#fff",fontSize:"0.5rem"},children:Object(p.b)("span",{onClick:function(){var e=[["rgb(1, 255, 251)","rgb(183, 1, 255)"],["#f857a6","#ff5858"],["#2BC0E4","#EAECC6"],["#7474BF","#348AC7"],["#A9C9FF","#FFBBEC"],["#3D7EAA","#FFE47A"],["#08AEEA","#2AF598"],["#5f2c82","#49a09d"],["#00DBDE","#FC00FF"],["#FC354C","#0ABFBC"],["#f2709c","#ff9472"],["green","red"],["red","blue"],["#888","#888"]],t=u+1>e.length-1?0:u+1;d(t),i(e[t])},children:["v",de.a]})})]})}var Ie=r.p+"static/media/harvest-access.b2b2bb4e.png",_e=r.p+"static/media/harvest-token-id.0b26d5ad.png";function Ae(){var e=Object(b.useState)(O()),t=Object(l.a)(e,2),r=t[0],n=t[1],a=Object(b.useState)(!1),o=Object(l.a)(a,2),i=o[0],c=o[1],m=Object(b.useState)(""),f=Object(l.a)(m,2),h=f[0],g=f[1],v=Object(b.useState)(""),j=Object(l.a)(v,2),y=j[0],w=j[1],S=Object(b.useState)(""),k=Object(l.a)(S,2),C=k[0],T=k[1],I=Object(b.useState)(""),_=Object(l.a)(I,2),A=_[0],E=_[1],R=function(){var e=Object(d.a)(s.a.mark((function e(t){var r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),c(!0),!(y&&C&&A)){e.next=20;break}return r={HARVEST_ACCESS_TOKEN:y,HARVEST_ACCOUNT_ID:C,GOOGLE_API_KEY:A},e.prev=4,e.next=7,D(r);case 7:return a=e.sent,o=a.avatar_url,e.next=11,Z(r);case 11:x(Object(u.a)({avatar_url:o},r)),n(r),c(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),"object"===typeof e.t0?g("Can't login. Check that you allow popups in the browser."):g(e.t0.toString()),c(!1);case 20:case"end":return e.stop()}}),e,null,[[4,16]])})));return function(t){return e.apply(this,arguments)}}(),N=!!r&&(!!r.HARVEST_ACCESS_TOKEN||!!r.HARVEST_ACCOUNT_ID||!!r.GOOGLE_API_KEY),z=function(){return Object(p.b)("div",{children:["Log into ",Object(p.a)("strong",{children:"https://id.getharvest.com/developers"}),Object(p.a)("br",{}),"and create a Personal Access Tokens",Object(p.a)("br",{}),Object(p.a)("img",{src:Ie,alt:"",css:{width:"30rem !important"}}),Object(p.a)("br",{}),'Copy the "Your Token" and paste it here',Object(p.a)("br",{}),Object(p.a)("img",{src:_e,alt:"",css:{width:"30rem !important"}})]})};return Object(p.a)("main",{css:{textRendering:"optimizeLegibility",fontKerning:"auto",MozOsxFontSmoothing:"grayscale"},children:N?Object(p.a)(Te,{handleLogout:function(){x({}),n({})}}):Object(p.a)(oe,{handleLogin:R,loading:i,error:h,inputLines:[{id:"hToken",label:"Harvest access token",value:y,setValue:w,help:Object(p.a)(z,{})},{id:"hID",label:"Harvest account ID",value:C,setValue:T,help:Object(p.a)(z,{})},{id:"gAPIKey",label:"Google API key",value:A,setValue:E,help:"Ask Dom for it"}]})})}i.a.render(Object(n.jsxs)(m.a.StrictMode,{children:[Object(n.jsx)(a.a,{styles:{html:{"--bg-color1":"rgb(1, 255, 251)","--bg-color2":"rgb(183, 1, 255)","--alt-bg":"#eee","--text":"#383E48","--info":"#005fcc","--confirm":"#008800","--danger":"#ee0000","--focus":"#005fcc",background:"rgb(183, 1, 255) -webkit-radial-gradient(left bottom, var(--bg-color1), var(--bg-color2)) repeat fixed 0% 0%",height:"100%"},body:{fontFamily:'system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"',lineHeight:1.2,margin:0,padding:0,color:"var(--text)"},a:{color:"var(--text)"},"*, *:before, *:after":{boxSizing:"border-box"}}}),Object(n.jsx)(Ae,{})]}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[70,1,2]]]);
//# sourceMappingURL=main.afc6e107.chunk.js.map